{"./":{"url":"./","title":"Introduction","keywords":"","body":" å¥½å¤§çš„æ¿æ —ï¼Œ ğŸŒ° å¥½å°çš„æ¿æ —ï¼Œ(â—'â—¡'â—) æ–‡æ¡£ä¸»è¦è®°å½• numpy pandas scipy çš„å¸¸ç”¨æ–¹æ³•ã€‚ Update timeï¼š 2020-06-12 "},"Chapter1/":{"url":"Chapter1/","title":"Numpy","keywords":"","body":"Numpy ä¸»è¦å‚è€ƒï¼š NumPyå‚è€ƒ Update timeï¼š 2020-05-25 "},"Chapter1/Numpy åˆ›å»ºæ•°ç»„.html":{"url":"Chapter1/Numpy åˆ›å»ºæ•°ç»„.html","title":"Numpy åˆ›å»ºæ•°ç»„","keywords":"","body":"Numpy åˆ›å»ºæ•°ç»„ numpy.empty numpy.emptyæ–¹æ³•ç”¨æ¥åˆ›å»ºä¸€ä¸ªæŒ‡å®š å½¢çŠ¶ï¼ˆshapeï¼‰ã€æ•°æ®ç±»å‹ï¼ˆdtypeï¼‰ä¸”æœªåˆå§‹åŒ–çš„æ•°ç»„ï¼š numpy.empty(shape, dtype = float, order = 'C') hapeï¼šintæˆ–tuple ç©ºæ•°ç»„çš„å½¢çŠ¶ dtypeï¼šæ•°æ®ç±»å‹ï¼Œå¯é€‰ æ‰€éœ€çš„è¾“å‡ºæ•°æ®ç±»å‹ã€‚ orderï¼š{'C'ï¼Œ'F'}ï¼Œå¯é€‰ æ˜¯å¦åœ¨å­˜å‚¨å™¨ä¸­ä»¥è¡Œä¸»ï¼ˆCé£æ ¼ï¼‰æˆ–åˆ—ä¸»ï¼ˆFortrané£æ ¼ï¼‰é¡ºåºå­˜å‚¨å¤šç»´æ•°æ®ã€‚ è¿”å› ç»™å®šå½¢çŠ¶ï¼Œdtypeå’Œé¡ºåºçš„æœªåˆå§‹åŒ–ï¼ˆä»»æ„ï¼‰æ•°æ®çš„æ•°ç»„ã€‚å¯¹è±¡æ•°ç»„å°†åˆå§‹åŒ–ä¸ºæ— ã€‚ #åˆ›å»ºä¸‰è¡Œä¸¤åˆ—çš„æ•°ç»„ import numpy as np x = np.empty([3,2], dtype = int) print (x) # æ³¨æ„ âˆ’ æ•°ç»„å…ƒç´ ä¸ºéšæœºå€¼ï¼Œå› ä¸ºå®ƒä»¬æœªåˆå§‹åŒ–ã€‚ #[[ 6917529027641081856 5764616291768666155] # [ 6917529027641081859 -5764598754299804209] # [ 4497473538 844429428932120]] numpy.zeros åˆ›å»ºæŒ‡å®šå¤§å°çš„æ•°ç»„ï¼Œæ•°ç»„å…ƒç´ ä»¥ 0 æ¥å¡«å……ï¼š numpy.zeros(shape, dtype = float, order = 'C') shapeï¼šintæˆ–intsåºåˆ— æ–°æ•°ç»„çš„å½¢çŠ¶ï¼Œä¾‹å¦‚ï¼ˆ2ï¼Œ 3ï¼‰æˆ–2ã€‚ dtypeï¼šæ•°æ®ç±»å‹ï¼Œå¯é€‰ æ•°ç»„çš„æ‰€éœ€æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚numpy.int8ã€‚é»˜è®¤å€¼ä¸ºnumpy.float64ã€‚ orderï¼š{'C'ï¼Œ'F'}ï¼Œå¯é€‰ æ˜¯å¦åœ¨å­˜å‚¨å™¨ä¸­ä»¥Cæˆ–Fortranè¿ç»­ï¼ˆæŒ‰è¡Œæˆ–åˆ—æ–¹å¼ï¼‰å­˜å‚¨å¤šç»´æ•°æ®ã€‚ import numpy as np # é»˜è®¤ä¸ºæµ®ç‚¹æ•° x = np.zeros(5) print(x) # [0. 0. 0. 0. 0.] # è®¾ç½®ç±»å‹ä¸ºæ•´æ•° y = np.zeros((5,), dtype = np.int) print(y) # [0 0 0 0 0] # è‡ªå®šä¹‰ç±»å‹ z = np.zeros((2,2), dtype = [('x', 'i4'), ('y', 'i4')]) print(z) #[[(0, 0) (0, 0)] # [(0, 0) (0, 0)]] numpy.ones åˆ›å»ºæŒ‡å®šå½¢çŠ¶çš„æ•°ç»„ï¼Œæ•°ç»„å…ƒç´ ä»¥ 1 æ¥å¡«å……ï¼š numpy.ones(shape, dtype = None, order = 'C') shapeï¼šintæˆ–intsåºåˆ— æ–°æ•°ç»„çš„å½¢çŠ¶ï¼Œä¾‹å¦‚ï¼ˆ2ï¼Œ 3ï¼‰æˆ–2ã€‚ dtypeï¼šæ•°æ®ç±»å‹ï¼Œå¯é€‰ æ•°ç»„çš„æ‰€éœ€æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚numpy.int8ã€‚é»˜è®¤å€¼ä¸ºnumpy.float64ã€‚ orderï¼š{'C'ï¼Œ'F'}ï¼Œå¯é€‰ æ˜¯å¦åœ¨å­˜å‚¨å™¨ä¸­ä»¥Cæˆ–Fortranè¿ç»­ï¼ˆæŒ‰è¡Œæˆ–åˆ—æ–¹å¼ï¼‰å­˜å‚¨å¤šç»´æ•°æ®ã€‚ import numpy as np # é»˜è®¤ä¸ºæµ®ç‚¹æ•° x = np.ones(5) print(x) # [1. 1. 1. 1. 1.] # è‡ªå®šä¹‰ç±»å‹ x = np.ones([2,2], dtype = int) print(x) #[[1 1] # [1 1]] Numerical ranges numpy.arange() numpy.arange([start,]stop,[step,]dtype=None) åœ¨ç»™å®šé—´éš”å†…è¿”å›å‡åŒ€é—´éš”çš„å€¼ã€‚ åœ¨åŠå¼€åŒºé—´[å¼€å§‹ï¼Œ åœæ­¢ï¼‰ï¼ˆæ¢å¥è¯è¯´ï¼ŒåŒ…æ‹¬å¼€å§‹ t3 >ä½†ä¸åŒ…æ‹¬\\åœæ­¢*ï¼‰ã€‚*å¯¹äºæ•´æ•°å‚æ•°ï¼Œè¯¥å‡½æ•°ç­‰æ•ˆäºPythonå†…ç½®çš„rangeå‡½æ•°ï¼Œä½†è¿”å›ä¸€ä¸ªndarrayè€Œä¸æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚ >>> np.arange(3) array([0, 1, 2]) >>> np.arange(3.0) array([ 0., 1., 2.]) >>> np.arange(3,7) array([3, 4, 5, 6]) >>> np.arange(3,7,2) array([3, 5]) numpy.linspace() numpy.linspace(start, stop, num=50, endpoint=True, retstep=False, dtype=None) åœ¨æŒ‡å®šçš„é—´éš”å†…è¿”å›å‡åŒ€é—´éš”çš„æ•°å­—ã€‚ è¿”å›numå‡åŒ€åˆ†å¸ƒçš„æ ·æœ¬ï¼Œåœ¨ [start, stop]ã€‚ è¿™ä¸ªåŒºé—´çš„ç«¯ç‚¹å¯ä»¥ä»»æ„çš„è¢«æ’é™¤åœ¨å¤–ã€‚ å‚æ•°ï¼š start : scalar(æ ‡é‡) åºåˆ—çš„èµ·å§‹å€¼ stop : scala åºåˆ—çš„ç»“æŸç‚¹ï¼Œé™¤éendpointè¢«è®¾ç½®ä¸ºFalseï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹, the sequence consists of all but the last of num + 1 evenly spaced samples(è¯¥åºåˆ—åŒ…æ‹¬æ‰€æœ‰é™¤äº†æœ€åçš„num+1ä¸Šå‡åŒ€åˆ†å¸ƒçš„æ ·æœ¬(æ„Ÿè§‰è¿™æ ·ç¿»è¯‘æœ‰ç‚¹å‘)), ä»¥è‡´äºstopè¢«æ’é™¤.å½“endpoint is Falseçš„æ—¶å€™æ³¨æ„æ­¥é•¿çš„å¤§å°(ä¸‹é¢æœ‰ä¾‹å­). num : int, optional(å¯é€‰) ç”Ÿæˆçš„æ ·æœ¬æ•°ï¼Œé»˜è®¤æ˜¯50ã€‚å¿…é¡»æ˜¯éè´Ÿã€‚ endpoint : bool, optional å¦‚æœæ˜¯çœŸï¼Œåˆ™ä¸€å®šåŒ…æ‹¬stopï¼Œå¦‚æœä¸ºFalseï¼Œä¸€å®šä¸ä¼šæœ‰stop retstep : bool, optional å¦‚æœä¸ºçœŸï¼Œè¿”å›ï¼ˆæ ·æœ¬ï¼Œæ­¥éª¤ï¼‰ï¼Œå…¶ä¸­æ­¥é•¿æ˜¯æ ·æœ¬ä¹‹é—´çš„é—´è·ã€‚ dtype : dtype, optional è¿”å›ï¼š samplesï¼šndarray step ï¼šfloat ä»…åœ¨retstepä¸ºTrueæ—¶è¿”å› æ ·æœ¬ä¹‹é—´çš„é—´è·å¤§å°ã€‚ >>> np.linspace(2.0, 3.0, num=5) array([ 2. , 2.25, 2.5 , 2.75, 3. ]) >>> np.linspace(2.0, 3.0, num=5, endpoint=False) array([ 2. , 2.2, 2.4, 2.6, 2.8]) >>> np.linspace(2.0, 3.0, num=5, retstep=True) (array([ 2. , 2.25, 2.5 , 2.75, 3. ]), 0.25) Building matrices numpy.diag() æå–å¯¹è§’çº¿æˆ–æ„é€ å¯¹è§’æ•°ç»„ã€‚ numpy.diag(v,k=0) v æ˜¯ä¸€ä¸ª1ç»´æ•°ç»„æ—¶ï¼Œç»“æœå½¢æˆä¸€ä¸ªä»¥ä¸€ç»´æ•°ç»„ä¸ºå¯¹è§’çº¿å…ƒç´ çš„çŸ©é˜µ v æ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µæ—¶ï¼Œç»“æœè¾“å‡ºçŸ©é˜µçš„å¯¹è§’çº¿å…ƒç´  k : int, optional å¯¹è§’çº¿çš„ä½ç½®ï¼Œå¤§äºé›¶ä½äºå¯¹è§’çº¿ä¸Šé¢ï¼Œå°äºé›¶åˆ™åœ¨ä¸‹é¢ã€‚ >>> x = np.arange(9).reshape((3,3)) >>> x array([[0, 1, 2], [3, 4, 5], [6, 7, 8]]) >>> np.diag(x) array([0, 4, 8]) >>> np.diag(x, k=1) array([1, 5]) >>> np.diag(x, k=-1) array([3, 7]) >>> np.diag(np.diag(x)) array([[0, 0, 0], [0, 4, 0], [0, 0, 8]]) Update timeï¼š 2020-05-25 "},"Chapter1/Numpy æ•°ç»„éå†.html":{"url":"Chapter1/Numpy æ•°ç»„éå†.html","title":"Numpy æ•°ç»„éå†","keywords":"","body":"Numpy æ•°ç»„éå† NumPy è¿­ä»£å™¨å¯¹è±¡ numpy.nditeræä¾›äº†ä¸€ç§çµæ´»è®¿é—®ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°ç»„å…ƒç´ çš„æ–¹å¼ã€‚ è¿­ä»£å™¨æœ€åŸºæœ¬çš„ä»»åŠ¡çš„å¯ä»¥å®Œæˆå¯¹æ•°ç»„å…ƒç´ çš„è®¿é—®ã€‚ import numpy as np a = np.arange(6).reshape(2,3) print ('åŸå§‹æ•°ç»„æ˜¯ï¼š') print (a) print ('\\n') print ('è¿­ä»£è¾“å‡ºå…ƒç´ ï¼š') for x in np.nditer(a): print (x, end=\", \" ) print ('\\n') åŸå§‹æ•°ç»„æ˜¯ï¼š [[0 1 2] [3 4 5]] è¿­ä»£è¾“å‡ºå…ƒç´ ï¼š 0, 1, 2, 3, 4, 5, ä»¥ä¸Šå®ä¾‹ä¸æ˜¯ä½¿ç”¨æ ‡å‡† C æˆ–è€… Fortran é¡ºåºï¼Œé€‰æ‹©çš„é¡ºåºæ˜¯å’Œæ•°ç»„å†…å­˜å¸ƒå±€ä¸€è‡´çš„ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†æå‡è®¿é—®çš„æ•ˆç‡ï¼Œé»˜è®¤æ˜¯è¡Œåºä¼˜å…ˆï¼ˆrow-major orderï¼Œæˆ–è€…è¯´æ˜¯ C-orderï¼‰ã€‚ æ§åˆ¶éå†é¡ºåº for x in np.nditer(a, order='F'):Fortran orderï¼Œå³æ˜¯åˆ—åºä¼˜å…ˆï¼› for x in np.nditer(a.T, order='C'):C orderï¼Œå³æ˜¯è¡Œåºä¼˜å…ˆï¼› import numpy as np a = np.arange(0,60,5) a = a.reshape(3,4) print ('åŸå§‹æ•°ç»„æ˜¯ï¼š') print (a) åŸå§‹æ•°ç»„æ˜¯ï¼š [[ 0 5 10 15] [20 25 30 35] [40 45 50 55]] print ('\\n') print ('åŸå§‹æ•°ç»„çš„è½¬ç½®æ˜¯ï¼š') b = a.T print (b) åŸå§‹æ•°ç»„çš„è½¬ç½®æ˜¯ï¼š [[ 0 20 40] [ 5 25 45] [10 30 50] [15 35 55]] print ('\\n') print ('ä»¥ C é£æ ¼é¡ºåºæ’åºï¼š') c = b.copy(order='C') print (c) for x in np.nditer(c): print (x, end=\", \" ) ä»¥ C é£æ ¼é¡ºåºæ’åºï¼š [[ 0 20 40] [ 5 25 45] [10 30 50] [15 35 55]] 0, 20, 40, 5, 25, 45, 10, 30, 50, 15, 35, 55, print ('\\n') print ('ä»¥ F é£æ ¼é¡ºåºæ’åºï¼š') c = b.copy(order='F') print (c) for x in np.nditer(c): print (x, end=\", \" ) ä»¥ F é£æ ¼é¡ºåºæ’åºï¼š [[ 0 20 40] [ 5 25 45] [10 30 50] [15 35 55]] 0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, å¯ä»¥é€šè¿‡æ˜¾å¼è®¾ç½®ï¼Œæ¥å¼ºåˆ¶ nditer å¯¹è±¡ä½¿ç”¨æŸç§é¡ºåºï¼š import numpy as np a = np.arange(0,60,5) a = a.reshape(3,4) print ('åŸå§‹æ•°ç»„æ˜¯ï¼š') print (a) print ('\\n') print ('ä»¥ C é£æ ¼é¡ºåºæ’åºï¼š') for x in np.nditer(a, order = 'C'): print (x, end=\", \" ) print ('\\n') print ('ä»¥ F é£æ ¼é¡ºåºæ’åºï¼š') for x in np.nditer(a, order = 'F'): print (x, end=\", \" ) Update timeï¼š 2020-05-25 "},"Chapter1/Numpy æ•°ç»„æ“ä½œ.html":{"url":"Chapter1/Numpy æ•°ç»„æ“ä½œ.html","title":"Numpy æ•°ç»„æ“ä½œ","keywords":"","body":"Numpy æ•°ç»„æ“ä½œ è¿æ¥æ•°ç»„ np.c_å’Œ np.r_ np.r_æ˜¯æŒ‰åˆ—è¿æ¥ä¸¤ä¸ªçŸ©é˜µï¼Œå°± æ˜¯æŠŠä¸¤çŸ©é˜µä¸Šä¸‹ç›¸åŠ ï¼Œè¦æ±‚åˆ—æ•°ç›¸ç­‰ï¼Œç±»ä¼¼äºpandasä¸­çš„concat()ã€‚ np.c_æ˜¯æŒ‰è¡Œè¿æ¥ä¸¤ä¸ªçŸ©é˜µï¼Œå°±æ˜¯æŠŠä¸¤çŸ©é˜µå·¦å³ç›¸åŠ ï¼Œè¦æ±‚è¡Œæ•°ç›¸ç­‰ï¼Œç±»ä¼¼äºpandasä¸­çš„merge()ã€‚ import numpy as np a = np.array([1, 2, 3]) b = np.array([4, 5, 6]) np.c_[a,b] array([[1, 4], [2, 5], [3, 6]]) np.r_[a,b] array([1, 2, 3, 4, 5, 6]) numpy.concatenate numpy.concatenate å‡½æ•°ç”¨äºæ²¿æŒ‡å®šè½´è¿æ¥ç›¸åŒå½¢çŠ¶çš„ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š numpy.concatenate((a1, a2, ...), axis) æ•°è¯´æ˜ï¼š a1, a2, â€¦ï¼šç›¸åŒç±»å‹çš„æ•°ç»„ axisï¼šæ²¿ç€å®ƒè¿æ¥æ•°ç»„çš„è½´ï¼Œé»˜è®¤ä¸º 0 import numpy as np a = np.array([[1,2],[3,4]]) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) print ('\\n') b = np.array([[5,6],[7,8]]) print ('ç¬¬äºŒä¸ªæ•°ç»„ï¼š') print (b) print ('\\n') # ä¸¤ä¸ªæ•°ç»„çš„ç»´åº¦ç›¸åŒ print ('æ²¿è½´ 0 è¿æ¥ä¸¤ä¸ªæ•°ç»„ï¼š') print (np.concatenate((a,b))) print ('\\n') print ('æ²¿è½´ 1 è¿æ¥ä¸¤ä¸ªæ•°ç»„ï¼š') print (np.concatenate((a,b),axis = 1)) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [[1 2] [3 4]] ç¬¬äºŒä¸ªæ•°ç»„ï¼š [[5 6] [7 8]] æ²¿è½´ 0 è¿æ¥ä¸¤ä¸ªæ•°ç»„ï¼š [[1 2] [3 4] [5 6] [7 8]] æ²¿è½´ 1 è¿æ¥ä¸¤ä¸ªæ•°ç»„ï¼š [[1 2 5 6] [3 4 7 8]] numpy.stack numpy.stackå‡½æ•°ç”¨äºæ²¿æ–°è½´è¿æ¥æ•°ç»„åºåˆ—ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š numpy.stack(arrays, axis) å‚æ•°è¯´æ˜ï¼š arraysç›¸åŒå½¢çŠ¶çš„æ•°ç»„åºåˆ— axisï¼šè¿”å›æ•°ç»„ä¸­çš„è½´ï¼Œè¾“å…¥æ•°ç»„æ²¿ç€å®ƒæ¥å †å  import numpy as np a = np.array([[1,2],[3,4]]) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) print ('\\n') b = np.array([[5,6],[7,8]]) print ('ç¬¬äºŒä¸ªæ•°ç»„ï¼š') print (b) print ('\\n') print ('æ²¿è½´ 0 å †å ä¸¤ä¸ªæ•°ç»„ï¼š') print (np.stack((a,b),0)) print ('\\n') print ('æ²¿è½´ 1 å †å ä¸¤ä¸ªæ•°ç»„ï¼š') print (np.stack((a,b),1)) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [[1 2] [3 4]] ç¬¬äºŒä¸ªæ•°ç»„ï¼š [[5 6] [7 8]] æ²¿è½´ 0 å †å ä¸¤ä¸ªæ•°ç»„ï¼š [[[1 2] [3 4]] [[5 6] [7 8]]] æ²¿è½´ 1 å †å ä¸¤ä¸ªæ•°ç»„ï¼š [[[1 2] [5 6]] [[3 4] [7 8]]] numpy.hstack numpy.hstack æ˜¯ numpy.stack å‡½æ•°çš„å˜ä½“ï¼Œå®ƒé€šè¿‡æ°´å¹³å †å æ¥ç”Ÿæˆæ•°ç»„ã€‚ import numpy as np a = np.array([[1,2],[3,4]]) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) print ('\\n') b = np.array([[5,6],[7,8]]) print ('ç¬¬äºŒä¸ªæ•°ç»„ï¼š') print (b) print ('\\n') print ('æ°´å¹³å †å ï¼š') c = np.hstack((a,b)) print (c) print ('\\n') ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [[1 2] [3 4]] ç¬¬äºŒä¸ªæ•°ç»„ï¼š [[5 6] [7 8]] æ°´å¹³å †å ï¼š [[1 2 5 6] [3 4 7 8]] numpy.vstack numpy.vstackæ˜¯numpy.stackå‡½æ•°çš„å˜ä½“ï¼Œå®ƒé€šè¿‡å‚ç›´å †å æ¥ç”Ÿæˆæ•°ç»„ã€‚ import numpy as np a = np.array([[1,2],[3,4]]) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) print ('\\n') b = np.array([[5,6],[7,8]]) print ('ç¬¬äºŒä¸ªæ•°ç»„ï¼š') print (b) print ('\\n') print ('ç«–ç›´å †å ï¼š') c = np.vstack((a,b)) print (c) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [[1 2] [3 4]] ç¬¬äºŒä¸ªæ•°ç»„ï¼š [[5 6] [7 8]] ç«–ç›´å †å ï¼š [[1 2] [3 4] [5 6] [7 8]] åˆ†å‰²æ•°ç»„ numpy.split numpy.splitå‡½æ•°æ²¿ç‰¹å®šçš„è½´å°†æ•°ç»„åˆ†å‰²ä¸ºå­æ•°ç»„ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š numpy.split(ary, indices_or_sections, axis) æ•°è¯´æ˜ï¼š aryï¼šè¢«åˆ†å‰²çš„æ•°ç»„ indices_or_sectionsï¼šå¦‚æœæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå°±ç”¨è¯¥æ•°å¹³å‡åˆ‡åˆ†ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸ºæ²¿è½´åˆ‡åˆ†çš„ä½ç½®ï¼ˆå·¦å¼€å³é—­ï¼‰ axisï¼šæ²¿ç€å“ªä¸ªç»´åº¦è¿›è¡Œåˆ‡å‘ï¼Œé»˜è®¤ä¸º0ï¼Œæ¨ªå‘åˆ‡åˆ†ã€‚ä¸º1æ—¶ï¼Œçºµå‘åˆ‡åˆ† import numpy as np a = np.arange(9) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) print ('\\n') print ('å°†æ•°ç»„åˆ†ä¸ºä¸‰ä¸ªå¤§å°ç›¸ç­‰çš„å­æ•°ç»„ï¼š') b = np.split(a,3) print (b) print ('\\n') print ('å°†æ•°ç»„åœ¨ä¸€ç»´æ•°ç»„ä¸­è¡¨æ˜çš„ä½ç½®åˆ†å‰²ï¼š') b = np.split(a,[4,7]) print (b) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [0 1 2 3 4 5 6 7 8] å°†æ•°ç»„åˆ†ä¸ºä¸‰ä¸ªå¤§å°ç›¸ç­‰çš„å­æ•°ç»„ï¼š [array([0, 1, 2]), array([3, 4, 5]), array([6, 7, 8])] å°†æ•°ç»„åœ¨ä¸€ç»´æ•°ç»„ä¸­è¡¨æ˜çš„ä½ç½®åˆ†å‰²ï¼š [array([0, 1, 2, 3]), array([4, 5, 6]), array([7, 8])] numpy.hsplit numpy.hsplit å‡½æ•°ç”¨äºæ°´å¹³åˆ†å‰²æ•°ç»„ï¼Œé€šè¿‡æŒ‡å®šè¦è¿”å›çš„ç›¸åŒå½¢çŠ¶çš„æ•°ç»„æ•°é‡æ¥æ‹†åˆ†åŸæ•°ç»„ã€‚ import numpy as np harr = np.floor(10 * np.random.random((2, 6))) print ('åŸarrayï¼š') print(harr) print ('æ‹†åˆ†åï¼š') print(np.hsplit(harr, 3)) åŸarrayï¼š [[4. 7. 6. 3. 2. 6.] [6. 3. 6. 7. 9. 7.]] æ‹†åˆ†åï¼š [array([[4., 7.], [6., 3.]]), array([[6., 3.], [6., 7.]]), array([[2., 6.], [9., 7.]])] numpy.vsplit numpy.vsplitæ²¿ç€å‚ç›´è½´åˆ†å‰²ï¼Œå…¶åˆ†å‰²æ–¹å¼ä¸hsplitç”¨æ³•ç›¸åŒã€‚ import numpy as np a = np.arange(16).reshape(4,4) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) print ('\\n') print ('ç«–ç›´åˆ†å‰²ï¼š') b = np.vsplit(a,2) print (b) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [[ 0 1 2 3] [ 4 5 6 7] [ 8 9 10 11] [12 13 14 15]] ç«–ç›´åˆ†å‰²ï¼š [array([[0, 1, 2, 3], [4, 5, 6, 7]]), array([[ 8, 9, 10, 11], [12, 13, 14, 15]])] æ•°ç»„å…ƒç´ çš„æ·»åŠ  numpy.resize numpy.resize å‡½æ•°è¿”å›æŒ‡å®šå¤§å°çš„æ–°æ•°ç»„ã€‚ å¦‚æœæ–°æ•°ç»„å¤§å°å¤§äºåŸå§‹å¤§å°ï¼Œåˆ™åŒ…å«åŸå§‹æ•°ç»„ä¸­çš„å…ƒç´ çš„å‰¯æœ¬ã€‚ numpy.resize(arr, shape) å‚æ•°è¯´æ˜ï¼š arrï¼šè¦ä¿®æ”¹å¤§å°çš„æ•°ç»„ shapeï¼šè¿”å›æ•°ç»„çš„æ–°å½¢çŠ¶ import numpy as np a = np.array([[1,2,3],[4,5,6]]) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [[1 2 3] [4 5 6]] print ('\\n') print ('ç¬¬ä¸€ä¸ªæ•°ç»„çš„å½¢çŠ¶ï¼š') print (a.shape) ç¬¬ä¸€ä¸ªæ•°ç»„çš„å½¢çŠ¶ï¼š (2, 3) print ('\\n') b = np.resize(a, (3,2)) print ('ç¬¬äºŒä¸ªæ•°ç»„ï¼š') print (b) ç¬¬äºŒä¸ªæ•°ç»„ï¼š [[1 2] [3 4] [5 6]] print ('\\n') print ('ç¬¬äºŒä¸ªæ•°ç»„çš„å½¢çŠ¶ï¼š') print (b.shape) ç¬¬äºŒä¸ªæ•°ç»„çš„å½¢çŠ¶ï¼š (3, 2) print ('\\n') # è¦æ³¨æ„ a çš„ç¬¬ä¸€è¡Œåœ¨ b ä¸­é‡å¤å‡ºç°ï¼Œå› ä¸ºå°ºå¯¸å˜å¤§äº† print ('ä¿®æ”¹ç¬¬äºŒä¸ªæ•°ç»„çš„å¤§å°ï¼š') b = np.resize(a,(3,3)) print (b) ä¿®æ”¹ç¬¬äºŒä¸ªæ•°ç»„çš„å¤§å°ï¼š [[1 2 3] [4 5 6] [1 2 3]] numpy.append numpy.appendå‡½æ•°åœ¨æ•°ç»„çš„æœ«å°¾æ·»åŠ å€¼ã€‚ è¿½åŠ æ“ä½œä¼šåˆ†é…æ•´ä¸ªæ•°ç»„ï¼Œå¹¶æŠŠåŸæ¥çš„æ•°ç»„å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚ æ­¤å¤–ï¼Œè¾“å…¥æ•°ç»„çš„ç»´åº¦å¿…é¡»åŒ¹é…å¦åˆ™å°†ç”ŸæˆValueErrorã€‚ append å‡½æ•°è¿”å›çš„å§‹ç»ˆæ˜¯ä¸€ä¸ªä¸€ç»´æ•°ç»„ã€‚ numpy.append(arr, values, axis=None) å‚æ•°è¯´æ˜ï¼š arrï¼šè¾“å…¥æ•°ç»„ valuesï¼šè¦å‘arræ·»åŠ çš„å€¼ï¼Œéœ€è¦å’Œarrå½¢çŠ¶ç›¸åŒï¼ˆé™¤äº†è¦æ·»åŠ çš„è½´ï¼‰ axisï¼šé»˜è®¤ä¸º Noneã€‚å½“axisæ— å®šä¹‰æ—¶ï¼Œæ˜¯æ¨ªå‘åŠ æˆï¼Œè¿”å›æ€»æ˜¯ä¸ºä¸€ç»´æ•°ç»„ï¼å½“axisæœ‰å®šä¹‰çš„æ—¶å€™ï¼Œåˆ†åˆ«ä¸º0å’Œ1çš„æ—¶å€™ã€‚å½“axisæœ‰å®šä¹‰çš„æ—¶å€™ï¼Œåˆ†åˆ«ä¸º0å’Œ1çš„æ—¶å€™ï¼ˆåˆ—æ•°è¦ç›¸åŒï¼‰ã€‚å½“axisä¸º1æ—¶ï¼Œæ•°ç»„æ˜¯åŠ åœ¨å³è¾¹ï¼ˆè¡Œæ•°è¦ç›¸åŒï¼‰ã€‚ numpy.insert numpy.insertå‡½æ•°åœ¨ç»™å®šç´¢å¼•ä¹‹å‰ï¼Œæ²¿ç»™å®šè½´åœ¨è¾“å…¥æ•°ç»„ä¸­æ’å…¥å€¼ã€‚ å¦‚æœå€¼çš„ç±»å‹è½¬æ¢ä¸ºè¦æ’å…¥ï¼Œåˆ™å®ƒä¸è¾“å…¥æ•°ç»„ä¸åŒã€‚ æ’å…¥æ²¡æœ‰åŸåœ°çš„ï¼Œå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚ æ­¤å¤–ï¼Œå¦‚æœæœªæä¾›è½´ï¼Œåˆ™è¾“å…¥æ•°ç»„ä¼šè¢«å±•å¼€ã€‚ numpy.insert(arr, obj, values, axis) å‚æ•°è¯´æ˜ï¼š arrï¼šè¾“å…¥æ•°ç»„ objï¼šåœ¨å…¶ä¹‹å‰æ’å…¥å€¼çš„ç´¢å¼• valuesï¼šè¦æ’å…¥çš„å€¼ axisï¼šæ²¿ç€å®ƒæ’å…¥çš„è½´ï¼Œå¦‚æœæœªæä¾›ï¼Œåˆ™è¾“å…¥æ•°ç»„ä¼šè¢«å±•å¼€ import numpy as np a = np.array([[1,2],[3,4],[5,6]]) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [[1 2] [3 4] [5 6]] print ('\\n') print ('æœªä¼ é€’ Axis å‚æ•°ã€‚ åœ¨æ’å…¥ä¹‹å‰è¾“å…¥æ•°ç»„ä¼šè¢«å±•å¼€ã€‚') print (np.insert(a,3,[11,12])) æœªä¼ é€’ Axis å‚æ•°ã€‚ åœ¨æ’å…¥ä¹‹å‰è¾“å…¥æ•°ç»„ä¼šè¢«å±•å¼€ã€‚ [ 1 2 3 11 12 4 5 6] print ('\\n') print ('ä¼ é€’äº† Axis å‚æ•°ã€‚ ä¼šå¹¿æ’­å€¼æ•°ç»„æ¥é…è¾“å…¥æ•°ç»„ã€‚') print ('æ²¿è½´ 0 å¹¿æ’­ï¼š') print (np.insert(a,1,[11],axis = 0)) ä¼ é€’äº† Axis å‚æ•°ã€‚ ä¼šå¹¿æ’­å€¼æ•°ç»„æ¥é…è¾“å…¥æ•°ç»„ã€‚ æ²¿è½´ 0 å¹¿æ’­ï¼š [[ 1 2] [11 11] [ 3 4] [ 5 6]] print ('\\n') print ('æ²¿è½´ 1 å¹¿æ’­ï¼š') print (np.insert(a,1,11,axis = 1)) æ²¿è½´ 1 å¹¿æ’­ï¼š [[ 1 11 2] [ 3 11 4] [ 5 11 6]] numpy.unique numpy.uniqueå‡½æ•°ç”¨äºå»é™¤æ•°ç»„ä¸­çš„é‡å¤å…ƒç´ ã€‚ numpy.unique å‡½æ•°ç”¨äºå»é™¤æ•°ç»„ä¸­çš„é‡å¤å…ƒç´ ã€‚ numpy.unique(arr, return_index, return_inverse, return_counts) arrï¼šè¾“å…¥æ•°ç»„ï¼Œå¦‚æœä¸æ˜¯ä¸€ç»´æ•°ç»„åˆ™ä¼šå±•å¼€ return_indexï¼šå¦‚æœä¸ºtrueï¼Œè¿”å›æ–°åˆ—è¡¨å…ƒç´ åœ¨æ—§åˆ—è¡¨ä¸­çš„ä½ç½®ï¼ˆä¸‹æ ‡ï¼‰ï¼Œå¹¶ä»¥åˆ—è¡¨å½¢å¼å‚¨ return_inverseï¼šå¦‚æœä¸ºtrueï¼Œè¿”å›æ—§åˆ—è¡¨å…ƒç´ åœ¨æ–°åˆ—è¡¨ä¸­çš„ä½ç½®ï¼ˆä¸‹æ ‡ï¼‰ï¼Œå¹¶ä»¥åˆ—è¡¨å½¢å¼å‚¨ return_countsï¼šå¦‚æœä¸ºtrueï¼Œè¿”å›å»é‡æ•°ç»„ä¸­çš„å…ƒç´ åœ¨åŸæ•°ç»„ä¸­çš„å‡ºç°æ¬¡æ•° import numpy as np a = np.array([5,2,6,2,7,5,6,8,2,9]) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [5 2 6 2 7 5 6 8 2 9] print ('\\n') print ('ç¬¬ä¸€ä¸ªæ•°ç»„çš„å»é‡å€¼ï¼š') u = np.unique(a) print (u) ç¬¬ä¸€ä¸ªæ•°ç»„çš„å»é‡å€¼ï¼š [2 5 6 7 8 9] print ('\\n') print ('å»é‡æ•°ç»„çš„ç´¢å¼•æ•°ç»„ï¼š') # è¿”å›å€¼ä¸ºä¸¤ä¸ª u,indices = np.unique(a, return_index = True) print (indices) å»é‡æ•°ç»„åœ¨åŸæ•°ç»„ä¸­çš„ç´¢å¼•ï¼Œæ„æˆçš„æ•°ç»„ï¼š [1 0 2 4 7 9] print ('\\n') print ('æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ªå’ŒåŸæ•°ç»„ä¸‹æ ‡å¯¹åº”çš„æ•°å€¼ï¼š') print (a) æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ªå’ŒåŸæ•°ç»„ä¸‹æ ‡å¯¹åº”çš„æ•°å€¼ï¼š [5 2 6 2 7 5 6 8 2 9] print ('\\n') print ('å»é‡æ•°ç»„çš„ä¸‹æ ‡ï¼š') # è¿”å›å€¼ä¸ºä¸¤ä¸ª indices æ—§æ•°ç»„ä¸­çš„å…ƒç´ åœ¨å»é‡åçš„æ•°ç»„ä¸­çš„ç´¢å¼•ï¼Œæ„æˆçš„æ•°ç»„ u,indices = np.unique(a,return_inverse = True) print (u) å»é‡æ•°ç»„çš„ä¸‹æ ‡ï¼š [2 5 6 7 8 9] print ('\\n') print ('ä¸‹æ ‡ä¸ºï¼š') print (indices) ä¸‹æ ‡ä¸ºï¼š [1 0 2 0 3 1 2 4 0 5] print ('\\n') print ('ä½¿ç”¨ä¸‹æ ‡é‡æ„åŸæ•°ç»„ï¼š') print (u[indices]) ä½¿ç”¨ä¸‹æ ‡é‡æ„åŸæ•°ç»„ï¼š [5 2 6 2 7 5 6 8 2 9] print ('\\n') print ('è¿”å›å»é‡å…ƒç´ çš„é‡å¤æ•°é‡ï¼š') #uå»é‡åçš„æ•°ç»„ï¼Œindices å»é‡åçš„æ•°ç»„ä¸­çš„å…ƒç´ åœ¨åŸæ¥æ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•° u,indices = np.unique(a,return_counts = True) print (u) print (indices) è¿”å›å»é‡å…ƒç´ çš„é‡å¤æ•°é‡ï¼š [2 5 6 7 8 9] [3 2 2 1 1 1] numpy.delete numpy.delete å‡½æ•°è¿”å›ä»è¾“å…¥æ•°ç»„ä¸­åˆ é™¤æŒ‡å®šå­æ•°ç»„çš„æ–°æ•°ç»„ã€‚ ä¸ insert() å‡½æ•°çš„æƒ…å†µä¸€æ ·ï¼Œå¦‚æœæœªæä¾›è½´å‚æ•°ï¼Œåˆ™è¾“å…¥æ•°ç»„å°†å±•å¼€ã€‚ Numpy.delete(arr, obj, axis) å‚æ•°è¯´æ˜ï¼š arrï¼šè¾“å…¥æ•°ç»„ objï¼šå¯ä»¥è¢«åˆ‡ç‰‡ï¼Œæ•´æ•°æˆ–è€…æ•´æ•°æ•°ç»„ï¼Œè¡¨æ˜è¦ä»è¾“å…¥æ•°ç»„åˆ é™¤çš„å­æ•°ç»„ axisï¼šæ²¿ç€å®ƒåˆ é™¤ç»™å®šå­æ•°ç»„çš„è½´ï¼Œå¦‚æœæœªæä¾›ï¼Œåˆ™è¾“å…¥æ•°ç»„ä¼šè¢«å±•å¼€ import numpy as np a = np.arange(12).reshape(3,4) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [[ 0 1 2 3] [ 4 5 6 7] [ 8 9 10 11]] print ('\\n') print ('æœªä¼ é€’ Axis å‚æ•°ã€‚ åœ¨æ’å…¥ä¹‹å‰è¾“å…¥æ•°ç»„ä¼šè¢«å±•å¼€ã€‚') print (np.delete(a,5)) æœªä¼ é€’ Axis å‚æ•°ã€‚ åœ¨æ’å…¥ä¹‹å‰è¾“å…¥æ•°ç»„ä¼šè¢«å±•å¼€ã€‚ [ 0 1 2 3 4 6 7 8 9 10 11] print ('\\n') print ('åˆ é™¤ç¬¬äºŒåˆ—ï¼š') print (np.delete(a,1,axis = 1)) æœªä¼ é€’ Axis å‚æ•°ã€‚ åœ¨æ’å…¥ä¹‹å‰è¾“å…¥æ•°ç»„ä¼šè¢«å±•å¼€ã€‚ [ 0 1 2 3 4 6 7 8 9 10 11] print ('\\n') print ('åŒ…å«ä»æ•°ç»„ä¸­åˆ é™¤çš„æ›¿ä»£å€¼çš„åˆ‡ç‰‡ï¼š') a = np.array([1,2,3,4,5,6,7,8,9,10]) print (np.delete(a, np.s_[::2])) åŒ…å«ä»æ•°ç»„ä¸­åˆ é™¤çš„æ›¿ä»£å€¼çš„åˆ‡ç‰‡ï¼š [ 2 4 6 8 10] Update timeï¼š 2020-05-25 "},"Chapter1/axis=0 axis=1çš„ç†è§£.html":{"url":"Chapter1/axis=0 axis=1çš„ç†è§£.html","title":"axis=0 axis=1çš„ç†è§£","keywords":"","body":"axis=0 axis=1çš„ç†è§£ è½´ç”¨æ¥ä¸ºè¶…è¿‡ä¸€ç»´çš„æ•°ç»„å®šä¹‰çš„å±æ€§ï¼ŒäºŒç»´æ•°æ®æ‹¥æœ‰ä¸¤ä¸ªè½´ï¼šç¬¬ 0 è½´æ²¿ç€è¡Œçš„å‚ç›´å¾€ä¸‹ï¼Œç¬¬ 1 è½´æ²¿ç€åˆ—çš„æ–¹å‘æ°´å¹³å»¶ä¼¸ã€‚ å®˜æ–¹å¯¹äº 0 å’Œ 1 çš„è§£é‡Šæ˜¯è½´ï¼Œä¹Ÿå°±æ˜¯åæ ‡è½´ã€‚è€Œåæ ‡è½´æ˜¯æœ‰æ–¹å‘çš„ï¼Œæ‰€ä»¥åƒä¸‡ä¸è¦ç”¨è¡Œå’Œåˆ—çš„æ€ç»´å»æƒ³ axisï¼Œå› ä¸ºè¡Œå’Œåˆ—æ˜¯æ²¡æœ‰æ–¹å‘çš„ï¼Œè¿™æ ·æƒ³ä¼šåœ¨é‡åˆ°ä¸åŒçš„ä¾‹å­æ—¶æ„Ÿåˆ°å›°æƒ‘ã€‚ æ ¹æ®å®˜æ–¹çš„è¯´æ³•ï¼Œ0 è¡¨ç¤ºçºµè½´ï¼Œæ–¹å‘ä»ä¸Šåˆ°ä¸‹ï¼›1 è¡¨ç¤ºæ¨ªè½´ï¼Œæ–¹å‘ä»å·¦åˆ°å³ã€‚å½“ axis = 1 æ—¶ï¼Œæ•°ç»„çš„å˜åŒ–æ˜¯æ¨ªå‘çš„ï¼Œè€Œä½“ç°å‡ºæ¥çš„æ˜¯åˆ—çš„å¢åŠ æˆ–è€…å‡å°‘ã€‚ å…¶å® axis çš„é‡ç‚¹åœ¨äºæ–¹å‘ï¼Œè€Œä¸æ˜¯è¡Œå’Œåˆ—ã€‚å…·ä½“åˆ°å„ç§ç”¨æ³•è€Œè¨€ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å½“ axis = 1 æ—¶ï¼Œå¦‚æœæ˜¯æ±‚å¹³å‡ï¼Œé‚£ä¹ˆæ˜¯ä»å·¦åˆ°å³æ¨ªå‘æ±‚å¹³å‡ï¼›å¦‚æœæ˜¯æ‹¼æ¥ï¼Œé‚£ä¹ˆä¹Ÿæ˜¯å·¦å³æ¨ªå‘æ‹¼æ¥ï¼›å¦‚æœæ˜¯dropï¼Œé‚£ä¹ˆä¹Ÿæ˜¯æ¨ªå‘å‘ç”Ÿå˜åŒ–ï¼Œä½“ç°ä¸ºåˆ—çš„å‡å°‘ã€‚ å½“è€ƒè™‘äº†æ–¹å‘ï¼Œå³ axis=0ä¸ºçºµå‘ï¼Œaxis=1ä¸ºæ¨ªå‘ï¼Œè€Œä¸æ˜¯è¡Œå’Œåˆ—ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„ä¾‹å­å°±éƒ½ç»Ÿä¸€äº†ã€‚ Update timeï¼š 2020-05-25 "},"Chapter1/NumPy æ’åºã€æ¡ä»¶åˆ·é€‰å‡½æ•°.html":{"url":"Chapter1/NumPy æ’åºã€æ¡ä»¶åˆ·é€‰å‡½æ•°.html","title":"NumPy æ’åºã€æ¡ä»¶åˆ·é€‰å‡½æ•°","keywords":"","body":"NumPy æ’åºã€æ¡ä»¶åˆ·é€‰å‡½æ•° NumPy æä¾›äº†å¤šç§æ’åºçš„æ–¹æ³•ã€‚ è¿™äº›æ’åºå‡½æ•°å®ç°ä¸åŒçš„æ’åºç®—æ³•ï¼Œæ¯ä¸ªæ’åºç®—æ³•çš„ç‰¹å¾åœ¨äºæ‰§è¡Œé€Ÿåº¦ï¼Œæœ€åæƒ…å†µæ€§èƒ½ï¼Œæ‰€éœ€çš„å·¥ä½œç©ºé—´å’Œç®—æ³•çš„ç¨³å®šæ€§ã€‚ ä¸‹è¡¨æ˜¾ç¤ºäº†ä¸‰ç§æ’åºç®—æ³•çš„æ¯”è¾ƒã€‚ numpy.sort() numpy.sort() å‡½æ•°è¿”å›è¾“å…¥æ•°ç»„çš„æ’åºå‰¯æœ¬ã€‚å‡½æ•°æ ¼å¼å¦‚ä¸‹ï¼š å‚æ•°è¯´æ˜ï¼š a: è¦æ’åºçš„æ•°ç»„ axis: æ²¿ç€å®ƒæ’åºæ•°ç»„çš„è½´ï¼Œå¦‚æœæ²¡æœ‰æ•°ç»„ä¼šè¢«å±•å¼€ï¼Œæ²¿ç€æœ€åçš„è½´æ’åºï¼Œ axis=0 æŒ‰åˆ—æ’åºï¼Œaxis=1 æŒ‰è¡Œæ’åº kind: é»˜è®¤ä¸ºâ€™quicksortâ€™ï¼ˆå¿«é€Ÿæ’åºï¼‰ order: å¦‚æœæ•°ç»„åŒ…å«å­—æ®µï¼Œåˆ™æ˜¯è¦æ’åºçš„å­—æ®µ import numpy as np a = np.array([[3, 7], [9, 1]]) print(a) # [[3 7] # [9 1]] print('è°ƒç”¨ sort() å‡½æ•°ï¼š') print(np.sort(a)) # [[3 7] # [1 9]] print('æŒ‰åˆ—æ’åºï¼š') print(np.sort(a, axis=0)) # [[3 1] # [9 7]] # åœ¨ sort å‡½æ•°ä¸­æ’åºå­—æ®µ dt = np.dtype([('name', 'S10'), ('age', int)]) a = np.array([(\"raju\", 21), (\"anil\", 25), (\"ravi\", 17), (\"amar\", 27)], dtype=dt) print('æ•°ç»„æ˜¯ï¼š') print(a) #[(b'raju', 21) (b'anil', 25) (b'ravi', 17) (b'amar', 27)] print('æŒ‰ name æ’åºï¼š') print(np.sort(a, order='name')) #[(b'amar', 27) (b'anil', 25) (b'raju', 21) (b'ravi', 17)] sorted() sorted(iterable[, cmp[, key[, reverse]]]) sorted() å‡½æ•°å¯¹æ‰€æœ‰å¯è¿­ä»£çš„å¯¹è±¡è¿›è¡Œæ’åºæ“ä½œã€‚ sort ä¸ sorted åŒºåˆ«ï¼š sort æ˜¯åº”ç”¨åœ¨ list ä¸Šçš„æ–¹æ³•ï¼Œsorted å¯ä»¥å¯¹æ‰€æœ‰å¯è¿­ä»£çš„å¯¹è±¡è¿›è¡Œæ’åºæ“ä½œã€‚ list çš„ sort æ–¹æ³•è¿”å›çš„æ˜¯å¯¹å·²ç»å­˜åœ¨çš„åˆ—è¡¨è¿›è¡Œæ“ä½œï¼Œè€Œå†…å»ºå‡½æ•° sorted æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª æ–°çš„ listï¼Œè€Œä¸æ˜¯åœ¨åŸæ¥çš„åŸºç¡€ä¸Šè¿›è¡Œçš„æ“ä½œã€‚ # sorted()å¯ä»¥åˆ©ç”¨å‚æ•°reverse=Trueè¿›è¡Œåå‘æ’åº >>>list=[3,4,2,6,1] >>>sorted(list) [1, 2, 3, 4, 6] >>>sorted(list, reverse=True) [6, 4, 3, 2, 1] numpy.argsort() numpy.argsort() å‡½æ•°è¿”å›çš„æ˜¯æ•°ç»„å€¼ä»å°åˆ°å¤§çš„ç´¢å¼•å€¼ã€‚ import numpy as np x = np.array([3, 1, 2]) print('æ•°ç»„æ˜¯ï¼š') print(x) # [3 1 2] print('å¯¹ x è°ƒç”¨ argsort() å‡½æ•°ï¼š') y = np.argsort(x) print(y) #[1 2 0] print('ä»¥æ’åºåçš„é¡ºåºé‡æ„åŸæ•°ç»„ï¼š') print(x[y]) # [1 2 3] print('ä½¿ç”¨å¾ªç¯é‡æ„åŸæ•°ç»„ï¼š') for i in y: print(x[i], end=\" \") # 1 2 3 numpy.lexsort() numpy.lexsort() ç”¨äºå¯¹å¤šä¸ªåºåˆ—è¿›è¡Œæ’åºã€‚æŠŠå®ƒæƒ³è±¡æˆå¯¹ç”µå­è¡¨æ ¼è¿›è¡Œæ’åºï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªåºåˆ—ï¼Œæ’åºæ—¶ä¼˜å…ˆç…§é¡¾é åçš„åˆ—ã€‚ è¿™é‡Œä¸¾ä¸€ä¸ªåº”ç”¨åœºæ™¯ï¼šå°å‡åˆè€ƒè¯•ï¼Œé‡ç‚¹ç­å½•å–å­¦ç”ŸæŒ‰ç…§æ€»æˆç»©å½•å–ã€‚åœ¨æ€»æˆç»©ç›¸åŒæ—¶ï¼Œæ•°å­¦æˆç»©é«˜çš„ä¼˜å…ˆå½•å–ï¼Œåœ¨æ€»æˆç»©å’Œæ•°å­¦æˆç»©éƒ½ç›¸åŒæ—¶ï¼ŒæŒ‰ç…§è‹±è¯­æˆç»©å½•å–â€¦â€¦ è¿™é‡Œï¼Œæ€»æˆç»©æ’åœ¨ç”µå­è¡¨æ ¼çš„æœ€åä¸€åˆ—ï¼Œæ•°å­¦æˆç»©åœ¨å€’æ•°ç¬¬äºŒåˆ—ï¼Œè‹±è¯­æˆç»©åœ¨å€’æ•°ç¬¬ä¸‰åˆ—ã€‚ import numpy as np nm = ('raju', 'anil', 'ravi', 'amar') dv = ('f.y.', 's.y.', 's.y.', 'f.y.') ind = np.lexsort((dv, nm)) print('è°ƒç”¨ lexsort() å‡½æ•°ï¼š') print(ind) print('\\n') print('ä½¿ç”¨è¿™ä¸ªç´¢å¼•æ¥è·å–æ’åºåçš„æ•°æ®ï¼š') print([nm[i] + \", \" + dv[i] for i in ind]) è°ƒç”¨ lexsort() å‡½æ•°ï¼š [3 1 0 2] ä½¿ç”¨è¿™ä¸ªç´¢å¼•æ¥è·å–æ’åºåçš„æ•°æ®ï¼š ['amar, f.y.', 'anil, s.y.', 'raju, f.y.', 'ravi, s.y.'] ä¸Šé¢ä¼ å…¥ np.lexsort çš„æ˜¯ä¸€ä¸ªtupleï¼Œæ’åºæ—¶é¦–å…ˆæ’ nmï¼Œ é¡ºåºä¸ºï¼šamarã€anilã€rajuã€ravi ã€‚ ç»¼ä¸Šæ’åºç»“æœä¸º [3 1 0 2]ã€‚ numpy.partition() >>> a = np.array([3, 4, 2, 1]) >>> np.partition(a, 3) # å°†æ•°ç»„ a ä¸­æ‰€æœ‰å…ƒç´ ï¼ˆåŒ…æ‹¬é‡å¤å…ƒç´ ï¼‰ä»å°åˆ°å¤§æ’åˆ—ï¼Œ # 3 è¡¨ç¤ºçš„æ˜¯æ’åºæ•°ç»„ç´¢å¼•ä¸º 3 çš„æ•°å­—ï¼Œæ¯”è¯¥æ•°å­—å°çš„æ’åœ¨è¯¥æ•°å­—å‰é¢ï¼Œ # æ¯”è¯¥æ•°å­—å¤§çš„æ’åœ¨è¯¥æ•°å­—çš„åé¢ array([2, 1, 3, 4]) >>> >>> np.partition(a, (1, 3)) # å°äº 1 çš„åœ¨å‰é¢ï¼Œå¤§äº 3 çš„åœ¨åé¢ï¼Œ1å’Œ3ä¹‹é—´çš„åœ¨ä¸­é—´ array([1, 2, 3, 4]) numpy.nonzero() numpy.nonzero() å‡½æ•°è¿”å›è¾“å…¥æ•°ç»„ä¸­éé›¶å…ƒç´ çš„ç´¢å¼•ã€‚ import numpy as np a = np.array([[30, 40, 0], [0, 20, 10], [50, 0, 60]]) print(a) # [[30 40 0] # [ 0 20 10] # [50 0 60]] print('è°ƒç”¨ nonzero() å‡½æ•°ï¼š') print(np.nonzero(a)) m=np.nonzero(a) # (array([0, 0, 1, 1, 2, 2], dtype=int64), array([0, 1, 1, 2, 0, 2], dtype=int64)) #è¿”å›å€¼çš„å‰åä¸¤éƒ¨åˆ†æ•°ç»„ï¼Œå¯¹åº”ä½ç½®ç»„åˆï¼ˆ0ï¼Œ0ï¼‰ï¼Œï¼ˆ0ï¼Œ1ï¼‰è¡¨ç¤ºé0å…ƒç´ åœ¨åŸæ•°ç»„ä¸­çš„ä½ç½® #è¾“å‡ºé0å…ƒç´  print(a[m]) # [30 40 20 10 50 60] numpy.where() numpy.where(condition[, x, y]) è¯¥å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå¿…é€‰å‚æ•° conditionï¼Œæ³¨æ„è¯¥å‚æ•°å¿…é¡»æ˜¯ array å‹çš„ï¼Œåªä¸è¿‡å…ƒç´ æ˜¯ true æˆ–è€…æ˜¯ false . x,yæ˜¯å¯é€‰å‚æ•°ï¼šå¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œåˆ™è¿”å›x,å¦‚æœæ¡ä»¶ä¸ºfalseï¼Œåˆ™è¿”å›yï¼Œæ³¨æ„conditionã€xã€yä¸‰è€…å¿…é¡»è¦èƒ½å¤Ÿâ€œå¹¿æ’­â€åˆ°ç›¸åŒçš„å½¢çŠ¶ è¿”å›ç»“æœï¼šè¿”å›çš„æ˜¯æ•°ç»„arrayæˆ–è€…æ˜¯å…ƒç´ ä¸ºarrayçš„tupleå…ƒç»„ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªconditionï¼Œåˆ™è¿”å›åŒ…å«arrayçš„tupleï¼Œå¦‚æœæ˜¯æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œåˆ™è¿”å›ä¸€ä¸ªarrayã€‚ numpy.where() å‡½æ•°è¿”å›è¾“å…¥æ•°ç»„ä¸­æ»¡è¶³ç»™å®šæ¡ä»¶çš„å…ƒç´ çš„ç´¢å¼•ã€‚ import numpy as np x = np.arange(9.).reshape(3, 3) print ('æˆ‘ä»¬çš„æ•°ç»„æ˜¯ï¼š') print (x) print ( 'å¤§äº 3 çš„å…ƒç´ çš„ç´¢å¼•ï¼š') y = np.where(x > 3) print (y) print ('ä½¿ç”¨è¿™äº›ç´¢å¼•æ¥è·å–æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼š') print (x[y]) æˆ‘ä»¬çš„æ•°ç»„æ˜¯ï¼š [[0. 1. 2.] [3. 4. 5.] [6. 7. 8.]] å¤§äº 3 çš„å…ƒç´ çš„ç´¢å¼•ï¼š (array([1, 1, 2, 2, 2]), array([1, 2, 0, 1, 2])) ä½¿ç”¨è¿™äº›ç´¢å¼•æ¥è·å–æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼š [4. 5. 6. 7. 8.] np.piecewise() numpy.piecewise(x, condlist, funclist, *args, **kw) å‚æ•°ä¸€ x:è¡¨ç¤ºè¦è¿›è¡Œæ“ä½œçš„å¯¹è±¡ å‚æ•°äºŒï¼šcondlistï¼Œè¡¨ç¤ºè¦æ»¡è¶³çš„æ¡ä»¶åˆ—è¡¨ï¼Œå¯ä»¥æ˜¯å¤šä¸ªæ¡ä»¶æ„æˆçš„åˆ—è¡¨ å‚æ•°ä¸‰ï¼šfunclistï¼Œæ‰§è¡Œçš„æ“ä½œåˆ—è¡¨ï¼Œå‚æ•°äºŒä¸å‚æ•°ä¸‰æ˜¯å¯¹åº”çš„ï¼Œå½“å‚æ•°äºŒä¸ºtrueçš„æ—¶å€™ï¼Œåˆ™æ‰§è¡Œç›¸å¯¹åº”çš„æ“ä½œå‡½æ•°ã€‚ è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªarrayå¯¹è±¡ï¼Œå’ŒåŸå§‹æ“ä½œå¯¹è±¡xå…·æœ‰å®Œå…¨ç›¸åŒçš„ç»´åº¦å’Œå½¢çŠ¶ x = np.arange(0,10) print(x) xx=np.piecewise(x, [x = 6], [-1, 1]) print(xx) [0 1 2 3 4 5 6 7 8 9] [-1 -1 -1 -1 0 0 1 1 1 1] å³å°†å…ƒç´ ä¸­å°äº4çš„ç”¨-1æ›¿æ¢æ‰ï¼Œå¤§äºç­‰äº6çš„ç”¨1æ›¿æ¢æ‰ï¼Œå…¶ä½™çš„é»˜è®¤ä»¥0å¡«å……ã€‚å…¶å®è¿™é‡Œçš„æ›¿æ¢å’Œå¡«å……å°±æ˜¯functionï¼Œè¿™ä¸è¿‡è¿™é‡Œçš„functionè·Ÿç®€å•ç²—æš´ï¼Œéƒ½ç”¨åŒä¸€ä¸ªæ•°æ›¿æ¢äº†. ä½¿ç”¨lambdaè¡¨è¾¾å¼ x = np.arange(0,10) xxxx=np.piecewise(x, [x = 6], [lambda x:x**2, lambda x:x*100]) print(xxxx) [ 0 1 4 9 0 0 600 700 800 900] numpy.extract() numpy.extract() å‡½æ•°æ ¹æ®æŸä¸ªæ¡ä»¶ä»æ•°ç»„ä¸­æŠ½å– å…ƒç´ ï¼Œè¿”å›æ»¡æ¡ä»¶çš„å…ƒç´ ã€‚ numpy.extract(æ¡ä»¶ï¼Œæ•°ç»„)ï¼šå¦‚æœæ»¡è¶³æŸäº›æŒ‡å®šæ¡ä»¶ï¼Œåˆ™è¿”å›input_arrayçš„å…ƒç´ ã€‚ import numpy as np # (1) ä½¿ç”¨arangeå‡½æ•°åˆ›å»ºæ•°ç»„ a = np.arange(7) # (2) ç”Ÿæˆé€‰æ‹©å¶æ•°å…ƒç´ çš„æ¡ä»¶å˜é‡ condition = (a % 2) == 0 # (3) ä½¿ç”¨extractå‡½æ•°åŸºäºç”Ÿæˆçš„æ¡ä»¶ä»æ•°ç»„ä¸­æŠ½å–å…ƒç´  print \"Even numbers\", np.extract(condition, a) # (4) ä½¿ç”¨nonzeroå‡½æ•°æŠ½å–æ•°ç»„ä¸­çš„éé›¶å…ƒç´  print \"Non zero\", np.nonzero(a) Update timeï¼š 2020-05-25 "},"Chapter1/å¸¸ç”¨ç»Ÿè®¡å‡½æ•°.html":{"url":"Chapter1/å¸¸ç”¨ç»Ÿè®¡å‡½æ•°.html","title":"å¸¸ç”¨ç»Ÿè®¡å‡½æ•°","keywords":"","body":"å¸¸ç”¨ç»Ÿè®¡å‡½æ•° NumPy æä¾›äº†å¾ˆå¤šç»Ÿè®¡å‡½æ•°ï¼Œç”¨äºä»æ•°ç»„ä¸­æŸ¥æ‰¾æœ€å°å…ƒç´ ï¼Œæœ€å¤§å…ƒç´ ï¼Œç™¾åˆ†ä½æ ‡å‡†å·®å’Œæ–¹å·®ç­‰ã€‚ numpy.cumsum() numpy.cumsum(a, axis=None, dtype=None, out=None) Parameters: a : array_like Input array. axis : int, optional Axis along which the cumulative sum is computed. The default (None) is to compute the cumsum over the flattened array. dtype : dtype, optional æŒ‰ç…§æ‰€ç»™å®šçš„è½´å‚æ•°è¿”å›å…ƒç´ çš„æ¢¯å½¢ç´¯è®¡å’Œï¼Œaxis=0ï¼ŒæŒ‰ç…§è¡Œç´¯åŠ ã€‚axis=1ï¼ŒæŒ‰ç…§åˆ—ç´¯åŠ ã€‚axisä¸ç»™å®šå…·ä½“å€¼ï¼Œå°±æŠŠ numpy æ•°ç»„å½“æˆä¸€ä¸ªä¸€ç»´æ•°ç»„ã€‚ >>> a = np.array([[1,2,3], [4,5,6]]) >>> a array([[1, 2, 3], [4, 5, 6]]) >>> np.cumsum(a) array([ 1, 3, 6, 10, 15, 21]) >>> np.cumsum(a, dtype=float) # specifies type of output value(s) array([ 1., 3., 6., 10., 15., 21.]) >>> >>> np.cumsum(a,axis=0) # sum over rows for each of the 3 columns array([[1, 2, 3], [5, 7, 9]]) >>> np.cumsum(a,axis=1) # sum over columns for each of the 2 rows array([[ 1, 3, 6], [ 4, 9, 15]]) numpy.sum() numpy.sum(a, axis=None, dtype=None, out=None, keepdims=, initial=, where=) aï¼šarray_like ç±»å‹ å¾…æ±‚å’Œçš„æ•°ç»„ã€‚ axis ï¼šå¯é€‰æ‹©None æˆ–intç±»å‹ æˆ– æ•´å‹çš„tupleç±»å‹ >>> np.sum([0.5, 1.5]) 2.0 >>> np.sum([0.5, 0.7, 0.2, 1.5], dtype=np.int32) 1 >>> np.sum([[0, 1], [0, 5]]) 6 >>> np.sum([[0, 1], [0, 5]], axis=0) array([0, 6]) >>> np.sum([[0, 1], [0, 5]], axis=1) array([1, 5]) amin()å’Œ amax() numpy.amin()ç”¨äºè®¡ç®—æ•°ç»„ä¸­çš„å…ƒç´ æ²¿æŒ‡å®šè½´çš„æœ€å°å€¼ã€‚ numpy.amax()ç”¨äºè®¡ç®—æ•°ç»„ä¸­çš„å…ƒç´ æ²¿æŒ‡å®šè½´çš„æœ€å¤§å€¼ã€‚ import numpy as np a = np.array([[3, 7, 5], [8, 4, 3], [2, 4, 9]]) print(a) # [[3 7 5] # [8 4 3] # [2 4 9]] print(np.amin(a)) #2 print(np.amin(a, 1)) # è¡Œæœ€å°å€¼ # [3 3 2] print('å†æ¬¡è°ƒç”¨ amin() å‡½æ•°ï¼š') print(np.amin(a, 0)) # åˆ—æœ€å°å€¼ # [2 4 3] print('è°ƒç”¨ amax() å‡½æ•°ï¼š') print(np.amax(a)) # 9 print(np.amax(a, axis=1)) # è¡Œæœ€å¤§å€¼ # [7 8 9] print('å†æ¬¡è°ƒç”¨ amax() å‡½æ•°ï¼š') print(np.amax(a, axis=0)) # åˆ—æœ€å¤§å€¼ # [8 7 9] numpy.ptp() numpy.ptp()å‡½æ•°è®¡ç®—æ•°ç»„ä¸­å…ƒç´ æœ€å¤§å€¼ä¸æœ€å°å€¼çš„å·®ï¼ˆæœ€å¤§å€¼ - æœ€å°å€¼ï¼‰ã€‚ import numpy as np a = np.array([[3, 7, 5], [8, 4, 3], [2, 4, 9]]) print(a) # [[3 7 5] # [8 4 3] # [2 4 9]] print('è°ƒç”¨ ptp() å‡½æ•°ï¼š') print(np.ptp(a)) # 7 print('æ²¿è½´ 1 è°ƒç”¨ ptp() å‡½æ•°ï¼š') print(np.ptp(a, axis=1)) # [4 5 7] print('æ²¿è½´ 0 è°ƒç”¨ ptp() å‡½æ•°ï¼š') print(np.ptp(a, axis=0)) # [6 3 6] numpy.median() numpy.median() å‡½æ•°ç”¨äºè®¡ç®—æ•°ç»„ a ä¸­å…ƒç´ çš„ä¸­ä½æ•°ï¼ˆä¸­å€¼ï¼‰ import numpy as np a = np.array([[30, 65, 70], [80, 95, 10], [50, 90, 60]]) print(a) # [[30 65 70] # [80 95 10] # [50 90 60]] print('è°ƒç”¨ median() å‡½æ•°ï¼š') print(np.median(a)) # 65.0 print('æ²¿è½´ 0(åˆ—) è°ƒç”¨ median() å‡½æ•°ï¼š') print(np.median(a, axis=0)) # [50. 90. 60.] print('æ²¿è½´ 1ï¼ˆè¡Œï¼‰ è°ƒç”¨ median() å‡½æ•°ï¼š') print(np.median(a, axis=1)) # [65. 80. 60.] numpy.mean() numpy.mean()å‡½æ•°è¿”å›æ•°ç»„ä¸­å…ƒç´ çš„ç®—æœ¯å¹³å‡å€¼ã€‚ å¦‚æœæä¾›äº†è½´ï¼Œåˆ™æ²¿å…¶è®¡ç®—ã€‚ ç®—æœ¯å¹³å‡å€¼æ˜¯æ²¿è½´çš„å…ƒç´ çš„æ€»å’Œé™¤ä»¥å…ƒç´ çš„æ•°é‡ã€‚ import numpy as np a = np.array([[1, 2, 3], [3, 4, 5], [4, 5, 6]]) print(a) # [[1 2 3] # [3 4 5] # [4 5 6]] print('è°ƒç”¨ mean() å‡½æ•°ï¼š') print(np.mean(a)) #3.6666666666666665 print('æ²¿è½´ 0 è°ƒç”¨ mean() å‡½æ•°ï¼š') print(np.mean(a, axis=0)) #[2.66666667 3.66666667 4.66666667] print('æ²¿è½´ 1 è°ƒç”¨ mean() å‡½æ•°ï¼š') print(np.mean(a, axis=1)) #[2. 4. 5.] numpy.average() numpy.average()å‡½æ•°æ ¹æ®åœ¨å¦ä¸€ä¸ªæ•°ç»„ä¸­ç»™å‡ºçš„å„è‡ªçš„æƒé‡è®¡ç®—æ•°ç»„ä¸­å…ƒç´ çš„åŠ æƒå¹³å‡å€¼ã€‚ è¯¥å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªè½´å‚æ•°ã€‚ å¦‚æœæ²¡æœ‰æŒ‡å®šè½´ï¼Œåˆ™æ•°ç»„ä¼šè¢«å±•å¼€ã€‚ åŠ æƒå¹³å‡å€¼å³å°†å„æ•°å€¼ä¹˜ä»¥ç›¸åº”çš„æƒæ•°ï¼Œç„¶ååŠ æ€»æ±‚å’Œå¾—åˆ°æ€»ä½“å€¼ï¼Œå†é™¤ä»¥æ€»çš„å•ä½æ•°ã€‚ è€ƒè™‘æ•°ç»„[1,2,3,4]å’Œç›¸åº”çš„æƒé‡[4,3,2,1]ï¼Œé€šè¿‡å°†ç›¸åº”å…ƒç´ çš„ä¹˜ç§¯ç›¸åŠ ï¼Œå¹¶å°†å’Œé™¤ä»¥æƒé‡çš„å’Œï¼Œæ¥è®¡ç®—åŠ æƒå¹³å‡å€¼ã€‚ import numpy as np a = np.array([1, 2, 3, 4]) print(a) #[1 2 3 4] print('è°ƒç”¨ average() å‡½æ•°ï¼š') print(np.average(a)) #2.5 # ä¸æŒ‡å®šæƒé‡æ—¶ç›¸å½“äº mean å‡½æ•° wts = np.array([4, 3, 2, 1]) print('å†æ¬¡è°ƒç”¨ average() å‡½æ•°ï¼š') print(np.average(a, weights=wts)) #2.0 # å¦‚æœ returned å‚æ•°è®¾ä¸º trueï¼Œåˆ™è¿”å›æƒé‡çš„å’Œ print('æƒé‡çš„å’Œï¼š') print(np.average([1, 2, 3, 4], weights=[4, 3, 2, 1], returned=True)) #(2.0, 10.0) #ç¬¬äºŒä¸ªå‚æ•°ä¸ºæƒé‡çš„å’Œ numpy.std()æ ‡å‡†å·® æ ‡å‡†å·®æ˜¯ä¸€ç»„æ•°æ®å¹³å‡å€¼åˆ†æ•£ç¨‹åº¦çš„ä¸€ç§åº¦é‡ã€‚ æ ‡å‡†å·®æ˜¯æ–¹å·®çš„ç®—æœ¯å¹³æ–¹æ ¹ã€‚ æ ‡å‡†å·®å…¬å¼å¦‚ä¸‹ï¼š std = sqrt(mean((x - x.mean())**2)) å¦‚æœæ•°ç»„æ˜¯ [1ï¼Œ2ï¼Œ3ï¼Œ4]ï¼Œåˆ™å…¶å¹³å‡å€¼ä¸º 2.5ã€‚ å› æ­¤ï¼Œå·®çš„å¹³æ–¹æ˜¯ [2.25,0.25,0.25,2.25]ï¼Œå¹¶ä¸”å…¶å¹³å‡å€¼çš„å¹³æ–¹æ ¹é™¤ä»¥ 4ï¼Œå³ sqrt(5/4) ï¼Œç»“æœä¸º 1.1180339887498949ã€‚ import numpy as np print (np.std([1,2,3,4])) 1.1180339887498949 numpy.var()æ–¹å·® ç»Ÿè®¡ä¸­çš„æ–¹å·®ï¼ˆæ ·æœ¬æ–¹å·®ï¼‰æ˜¯æ¯ä¸ªæ ·æœ¬å€¼ä¸å…¨ä½“æ ·æœ¬å€¼çš„å¹³å‡æ•°ä¹‹å·®çš„å¹³æ–¹å€¼çš„å¹³å‡æ•°ï¼Œå³ mean((x - x.mean())** 2)ã€‚ æ¢å¥è¯è¯´ï¼Œæ ‡å‡†å·®æ˜¯æ–¹å·®çš„å¹³æ–¹æ ¹ã€‚ import numpy as np print (np.var([1,2,3,4])) 1.25 NumPy ç®—æœ¯å‡½æ•°åŒ…å«ç®€å•çš„åŠ å‡ä¹˜é™¤: add()ï¼Œsubtract()ï¼Œmultiply()å’Œ divide()ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯æ•°ç»„å¿…é¡»å…·æœ‰ç›¸åŒçš„å½¢çŠ¶æˆ–ç¬¦åˆæ•°ç»„å¹¿æ’­è§„åˆ™ã€‚ numpy.cov() ä¼°è®¡åæ–¹å·®çŸ©é˜µï¼Œç»™å®šæ•°æ®å’Œæƒé‡ã€‚ numpy.cov(m, y=None, rowvar=True, bias=False, ddof=None, fweights=None, aweights=None) å‚æ•° m :array_like åŒ…å«å¤šä¸ªå˜é‡å’Œè§‚å¯Ÿå€¼çš„1-Dæˆ–2-Dæ•°ç»„ã€‚Mçš„æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªå˜é‡ï¼ˆå³ç‰¹å¾ï¼‰ï¼Œæ¯ä¸€åˆ—éƒ½æ˜¯å¯¹æ‰€æœ‰è¿™äº›å˜é‡çš„å•ä¸€è§‚å¯Ÿï¼ˆå³æ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªæ ·æœ¬ï¼‰ y :array_like, optional å¦å¤–ä¸€ç»„å˜é‡å’Œè§‚å¯Ÿç»“æœã€‚ yå…·æœ‰ä¸mç›¸åŒçš„å½¢å¼ã€‚ rowvar : bool,optional å¦‚æœ rowvar ä¸º Trueï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œåˆ™æ¯è¡Œä»£è¡¨ä¸€ä¸ªå˜é‡ï¼Œå¹¶åœ¨åˆ—ä¸­æ˜¾ç¤ºï¼ˆå³æ¯ä¸€åˆ—ä¸ºä¸€ä¸ªæ ·æœ¬ï¼‰ã€‚ å¦åˆ™ï¼Œå…³ç³»è¢«è½¬ç½®ï¼šæ¯åˆ—ä»£è¡¨å˜é‡ï¼Œè€Œè¡ŒåŒ…å«è§‚å¯Ÿå€¼ã€‚ bias : bool,optional é»˜è®¤å½’ä¸€åŒ–ï¼ˆFalseï¼‰ä¸ºï¼ˆN-1ï¼‰ï¼Œå…¶ä¸­Nä¸ºç»™å®šè§‚æµ‹æ¬¡æ•°ï¼ˆæ— åä¼°è®¡ï¼‰ã€‚å¦‚æœbiasä¸ºTrueï¼Œåˆ™å½’ä¸€åŒ–ä¸ºN. è¿™äº›å€¼å¯ä»¥é€šè¿‡ä½¿ç”¨numpyç‰ˆæœ¬> = 1.5ä¸­çš„å…³é”®å­—ddofæ¥è¦†ç›–ã€‚ ddof : int,optional å¦‚æœä¸æ˜¯ï¼Œåç§»æ‰€éšå«çš„é»˜è®¤å€¼å°†è¢«è¦†ç›–ã€‚è¯·æ³¨æ„ï¼Œddof = 1å°†è¿”å›æ— åä¼°è®¡ï¼Œå³ä½¿æŒ‡å®šäº†æƒé‡å’Œæƒé‡ï¼Œddof = 0å°†è¿”å›ç®€å•å¹³å‡å€¼ã€‚è¯¦è§é™„æ³¨ã€‚ é»˜è®¤å€¼ä¸ºNoneã€‚ fweights :array_like, int, optional æ•´æ•°é¢‘ç‡æƒé‡ç»„æˆçš„1-Dæ•°ç»„; ä»£è¡¨æ¯ä¸ªè§‚å¯Ÿå‘é‡åº”é‡å¤çš„æ¬¡æ•°ã€‚ è€ƒè™‘ä¸¤ä¸ªå˜é‡ï¼Œå’Œï¼Œå®ƒä»¬å®Œå…¨ç›¸å…³ï¼Œä½†æ–¹å‘ç›¸åï¼š >>> x = np.array([[0, 2], [1, 1], [2, 0]]).T >>> x array([[0, 1, 2], [2, 1, 0]]) æ³¨æ„å¢åŠ è€Œå‡å°‘ã€‚åæ–¹å·®çŸ©é˜µæ¸…æ¥šåœ°è¡¨æ˜ï¼š >>> np.cov(x) array([[ 1., -1.], [-1., 1.]]) æ³¨æ„ï¼Œç¤ºå‡ºå’Œä¹‹é—´çš„ç›¸å…³æ€§çš„å…ƒç´ æ˜¯è´Ÿçš„ã€‚ æ­¤å¤–ï¼Œè¯·æ³¨æ„xå’Œyæ˜¯å¦‚ä½•ç»„åˆçš„ï¼š >>> x = [-2.1, -1, 4.3] >>> y = [3, 1.1, 0.12] >>> X = np.vstack((x,y)) >>> print(np.cov(X)) [[ 11.71 -4.286 ] [ -4.286 2.14413333]] >>> print(np.cov(x, y)) [[ 11.71 -4.286 ] [ -4.286 2.14413333]] >>> print(np.cov(x)) 11.71 åæ–¹å·®çŸ©é˜µè®¡ç®—çš„æ˜¯ä¸åŒç»´åº¦ä¹‹é—´çš„åæ–¹å·®ï¼Œè€Œä¸æ˜¯ä¸åŒæ ·æœ¬ä¹‹é—´ã€‚ multiply() import numpy as np a = np.arange(9, dtype = np.float_).reshape(3,3) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [[0. 1. 2.] [3. 4. 5.] [6. 7. 8.]] print ('ç¬¬äºŒä¸ªæ•°ç»„ï¼š') b = np.array([10,10,10]) print (b) ç¬¬äºŒä¸ªæ•°ç»„ï¼š [10 10 10] print ('ä¸¤ä¸ªæ•°ç»„ç›¸åŠ ï¼š') print (np.add(a,b)) ä¸¤ä¸ªæ•°ç»„ç›¸åŠ ï¼š [[10. 11. 12.] [13. 14. 15.] [16. 17. 18.]] print ('ä¸¤ä¸ªæ•°ç»„ç›¸å‡ï¼š') print (np.subtract(a,b)) ä¸¤ä¸ªæ•°ç»„ç›¸å‡ï¼š [[-10. -9. -8.] [ -7. -6. -5.] [ -4. -3. -2.]] print ('ä¸¤ä¸ªæ•°ç»„ç›¸ä¹˜ï¼š') print (np.multiply(a,b)) ä¸¤ä¸ªæ•°ç»„ç›¸ä¹˜ï¼š [[ 0. 10. 20.] [30. 40. 50.] [60. 70. 80.]] print ('ä¸¤ä¸ªæ•°ç»„ç›¸é™¤ï¼š') print (np.divide(a,b)) ä¸¤ä¸ªæ•°ç»„ç›¸é™¤ï¼š [[0. 0.1 0.2] [0.3 0.4 0.5] [0.6 0.7 0.8]] numpy.reciprocal() numpy.reciprocal() å‡½æ•°è¿”å›å‚æ•°é€å…ƒç´ çš„å€’æ•°ã€‚å¦‚ 1/4 å€’æ•°ä¸º 4/1ã€‚ import numpy as np a = np.array([0.25, 1.33, 1, 100]) print ('æˆ‘ä»¬çš„æ•°ç»„æ˜¯ï¼š') print (a) print ('\\n') print ('è°ƒç”¨ reciprocal å‡½æ•°ï¼š') print (np.reciprocal(a)) æˆ‘ä»¬çš„æ•°ç»„æ˜¯ï¼š [ 0.25 1.33 1. 100. ] è°ƒç”¨ reciprocal å‡½æ•°ï¼š [4. 0.7518797 1. 0.01 ] numpy.power() numpy.power()å‡½æ•°å°†ç¬¬ä¸€ä¸ªè¾“å…¥æ•°ç»„ä¸­çš„å…ƒç´ ä½œä¸ºåº•æ•°ï¼Œè®¡ç®—å®ƒä¸ç¬¬äºŒä¸ªè¾“å…¥æ•°ç»„ä¸­ç›¸åº”å…ƒç´ çš„å¹‚ã€‚ import numpy as np a = np.array([10,100,1000]) print ('æˆ‘ä»¬çš„æ•°ç»„æ˜¯ï¼›') print (a) print ('\\n') print ('è°ƒç”¨ power å‡½æ•°ï¼š') print (np.power(a,2)) print ('\\n') print ('ç¬¬äºŒä¸ªæ•°ç»„ï¼š') b = np.array([1,2,3]) print (b) print ('\\n') print ('å†æ¬¡è°ƒç”¨ power å‡½æ•°ï¼š') print (np.power(a,b)) æˆ‘ä»¬çš„æ•°ç»„æ˜¯ï¼› [ 10 100 1000] è°ƒç”¨ power å‡½æ•°ï¼š [ 100 10000 1000000] ç¬¬äºŒä¸ªæ•°ç»„ï¼š [1 2 3] å†æ¬¡è°ƒç”¨ power å‡½æ•°ï¼š [ 10 10000 1000000000] numpy.mod() numpy.mod() è®¡ç®—è¾“å…¥æ•°ç»„ä¸­ç›¸åº”å…ƒç´ çš„ç›¸é™¤åçš„ä½™æ•°ã€‚ å‡½æ•° numpy.remainder()ä¹Ÿäº§ç”Ÿç›¸åŒçš„ç»“æœã€‚ import numpy as np a = np.array([10,20,30]) b = np.array([3,5,7]) print ('ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š') print (a) print ('\\n') print ('ç¬¬äºŒä¸ªæ•°ç»„ï¼š') print (b) print ('\\n') print ('è°ƒç”¨ mod() å‡½æ•°ï¼š') print (np.mod(a,b)) a = np.array([10, 20, 30]) print(a) print(np.mod(a, 3)) #[1 2 0] print ('è°ƒç”¨ remainder() å‡½æ•°ï¼š') print (np.remainder(a,b)) ç¬¬ä¸€ä¸ªæ•°ç»„ï¼š [10 20 30] ç¬¬äºŒä¸ªæ•°ç»„ï¼š [3 5 7] è°ƒç”¨ mod() å‡½æ•°ï¼š [1 0 2] è°ƒç”¨ remainder() å‡½æ•°ï¼š [1 0 2] å‚è€ƒ ç»Ÿè®¡ Update timeï¼š 2020-05-25 "},"Chapter1/NumPy å¸¸ç”¨å‡½æ•°.html":{"url":"Chapter1/NumPy å¸¸ç”¨å‡½æ•°.html","title":"NumPy å¸¸ç”¨å‡½æ•°","keywords":"","body":"NumPy å¸¸ç”¨å‡½æ•° numpy.argpartition numpy.argpartition(a, kth, axis=-1, kind='introselect', order=None) åœ¨å¿«æ’ç®—æ³•ä¸­ï¼Œæœ‰ä¸€ä¸ªå…¸å‹ çš„æ“ä½œï¼špartitionã€‚è¿™ä¸ªæ“ä½œæŒ‡ï¼šæ ¹æ®ä¸€ä¸ªæ•°å€¼xï¼ŒæŠŠæ•°ç»„ä¸­çš„å…ƒç´ åˆ’åˆ†æˆä¸¤åŠï¼Œä½¿å¾—indexå‰é¢çš„å…ƒç´ éƒ½ä¸å¤§äºxï¼Œindexåé¢çš„å…ƒç´ éƒ½ä¸å°äºxã€‚ numpy ä¸­çš„ argpartition() å‡½æ•°å°±æ˜¯èµ·çš„è¿™ä¸ªä½œç”¨ã€‚å¯¹äºä¼ å…¥çš„æ•°ç»„aï¼Œå…ˆç”¨O(n)å¤æ‚åº¦æ±‚å‡ºç¬¬ k å¤§çš„æ•°å­—ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªç¬¬ k å¤§çš„æ•°å­—å°†æ•°ç»„ a åˆ’åˆ†æˆä¸¤åŠã€‚ (ç¬¬ k å¤§çš„æ•°å­—, å°±æ˜¯æ’åºï¼ˆä»å°åˆ°å¤§ï¼‰åçš„æ•°ç»„ï¼Œç¬¬kä¸ªä½ç½®çš„å…ƒç´ ï¼Œè‡ªå·±ç†è§£çš„) æ­¤å‡½æ•°ä¸å¯¹åŸæ•°ç»„è¿›è¡Œæ“ä½œï¼Œå®ƒåªè¿”å›åˆ†åŒºä¹‹åçš„ä¸‹æ ‡ã€‚ä¸€èˆ¬ numpy ä¸­ä»¥ arg å¼€å¤´çš„å‡½æ•°éƒ½æ˜¯è¿”å›ä¸‹æ ‡è€Œä¸æ”¹å˜åŸæ•°ç»„ã€‚ æ­¤å‡½æ•°è¿˜æœ‰å¦å¤–ä¸¤ä¸ªå‚æ•°ï¼š kindï¼šç”¨äºæŒ‡å®špartitionçš„ç®—æ³• orderï¼šè¡¨ç¤ºæ’åºçš„keyï¼Œä¹Ÿå°±æ˜¯æŒ‰å“ªäº›å­—æ®µè¿›è¡Œæ’åº å½“æˆ‘ä»¬åªå…³å¿ƒ TopK æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨np.sort()å¯¹æ•°ç»„è¿›è¡Œå…¨é‡æ’åºï¼Œnp.argpartition()å·²ç»å¤Ÿç”¨äº†ã€‚ $ import numpy as np $ a = np.array([9, 4, 4, 3, 3, 9, 0, 4, 6, 0]) $ print(np.argpartition(a, 4)) #å°†æ•°ç»„aä¸­æ‰€æœ‰å…ƒç´ ï¼ˆåŒ…æ‹¬é‡å¤å…ƒç´ ï¼‰ä»å°åˆ°å¤§æ’åˆ—ï¼Œæ¯”ç¬¬5å¤§çš„å…ƒç´ å°çš„æ”¾åœ¨å‰é¢ï¼Œå¤§çš„æ”¾åœ¨åé¢ï¼Œè¾“å‡ºæ–°æ•°ç»„ç´¢å¼• >> [6 9 4 3 7 2 1 5 8 0] $ a[np.argpartition(a, 4)] #è¾“å‡ºæ–°æ•°ç»„ç´¢å¼•å¯¹åº”çš„æ•°ç»„ >> array([0, 0, 3, 3, 4, 4, 4, 9, 6, 9]) æ³¨æ„ï¼Œæ’åºè§„åˆ™æ˜¯ä»0å¼€å§‹æ’åºï¼Œå³ï¼Œç¬¬0å¤§çš„å…ƒç´ ä¸ºâ€œ0â€ï¼Œç¬¬1å¤§çš„å…ƒç´ è¿˜ä¸ºâ€œ0â€ï¼Œç¬¬2å¤§çš„å…ƒç´ ä¸ºâ€œ3â€ >>> arr = np.array([8,7,6,5,4,3,2,1]) >>> np.argpartition(arr, 0) array([7, 1, 2, 3, 4, 5, 6, 0], dtype=int32) >>> np.argpartition(arr, 1) array([7, 6, 2, 3, 4, 5, 1, 0], dtype=int32) >>> np.argpartition(arr, 2) array([7, 6, 5, 3, 4, 2, 1, 0], dtype=int32) >>> np.argpartition(arr, 3) array([6, 7, 5, 4, 3, 1, 2, 0], dtype=int32) >>> np.argpartition(arr, 4) array([4, 7, 6, 5, 3, 1, 2, 0], dtype=int32) >>> np.argpartition(arr, 5) array([4, 7, 6, 5, 3, 2, 1, 0], dtype=int32) >>> np.argpartition(arr, 6) array([4, 7, 6, 5, 3, 2, 1, 0], dtype=int32) >>> np.argpartition(arr, 7) array([4, 7, 6, 5, 3, 2, 1, 0], dtype=int32) ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œç»™ç¬¬äºŒä¸ªå‚æ•°ä¼ äº†0ï¼Œè¯´æ˜æˆ‘éœ€è¦è¿”å›æœ€å°å€¼å¾—ç´¢å¼•indexã€‚å¾—åˆ°çš„è¿”å›å€¼æ˜¯array([7, 1, 2, 3, 4, 5, 6, 0], dtype=int32)ï¼Œåœ¨è¿™ä¸ªè¿”å›çš„arrayä¸­ï¼Œæˆ‘å…³å¿ƒçš„æ˜¯ç¬¬0ä¸ªå€¼ï¼ˆ7ï¼‰ï¼Œå®ƒæ˜¯åŸæ•°ç»„arrçš„ç´¢å¼•ï¼Œarr[7]å°±æ˜¯æˆ‘è¦æ‰¾çš„æœ€å°å€¼ã€‚è¯·æ³¨æ„è¿”å›å€¼ä¸­çš„å…¶ä»–å‡ ä¸ªç´¢å¼•å€¼ï¼Œå’ŒåŸæ•°ç»„çš„ç´¢å¼•æ¯”èµ·æ¥ï¼Œä»–ä»¬åŸºæœ¬ä¸Šæ²¡æœ‰ä»€ä¹ˆå˜åŒ–ã€‚æ¥ä¸‹æ¥çš„å‡ æ¬¡è°ƒç”¨ä¹Ÿæ˜¯è¿™ç§æƒ…å†µï¼Œå…¶å®è¿™ä¹Ÿå°±è¯´æ˜argpartitionæ²¡æœ‰å¯¹ä»–ä¸å…³å¿ƒçš„æ•°æ®åšå¤ªå¤§çš„æ”¹åŠ¨æˆ–è€…æ“ä½œã€‚ $ import numpy as np $ a = np.array([9, 4, 4, 3, 3, 9, 0, 4, 6, 0]) $ a[np.argpartition(a, -5)[-5:]] >> array([4, 4, 9, 6, 9]) numpy.clip numpy.clip(a, a_min, a_max, out=None)[source] åœ¨å¾ˆå¤šæ•°æ®å¤„ç†å’Œç®—æ³•ä¸­ï¼ˆæ¯”å¦‚å¼ºåŒ–å­¦ä¹ ä¸­çš„ PPOï¼‰ï¼Œæˆ‘ä»¬éœ€è¦ä½¿å¾—æ‰€æœ‰çš„å€¼ä¿æŒåœ¨ä¸€ä¸ªä¸Šä¸‹é™åŒºé—´å†…ã€‚Numpy å†…ç½®çš„ Clip å‡½æ•°å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚Numpy clip () å‡½æ•°ç”¨äºå¯¹æ•°ç»„ä¸­çš„å€¼è¿›è¡Œé™åˆ¶ã€‚ç»™å®šä¸€ä¸ªåŒºé—´èŒƒå›´ï¼ŒåŒºé—´èŒƒå›´å¤–çš„å€¼å°†è¢«æˆªæ–­åˆ°åŒºé—´çš„è¾¹ç•Œä¸Šã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŒ‡å®šçš„åŒºé—´æ˜¯ [-1,1]ï¼Œå°äº-1 çš„å€¼å°†å˜ä¸º-1ï¼Œè€Œå¤§äº 1 çš„å€¼å°†å˜ä¸º 1 Clipç¤ºä¾‹ï¼šé™åˆ¶æ•°ç»„ä¸­çš„æœ€å°å€¼ä¸º 2ï¼Œæœ€å¤§å€¼ä¸º 6ã€‚ array = np.array([10, 7, 4, 3, 2, 2, 5, 9, 0, 4, 6, 0]) np.clip(array,2,5) # array([5, 5, 4, 3, 2, 2, 5, 5, 2, 4, 5, 2]) array = np.array([10, -1, 4, -3, 2, 7, 5, 9, 0, 4, 6, 0]) # array([6, 2, 4, 2, 2, 2, 5, 6, 2, 4, 6, 2]) é«˜ç»´æ•°ç»„ä¹Ÿæ˜¯ä¸€æ ·çš„ x=np.array([[1,2,3,5,6,7,8,9],[1,2,3,5,6,7,8,9]]) np.clip(x,3,8) Out[90]: array([[3, 3, 3, 5, 6, 7, 8, 8], [3, 3, 3, 5, 6, 7, 8, 8]]) numpy.where() numpy.where()å‡½æ•°ï¼Œæ­¤å‡½æ•°è¿”å›æ•°ç»„ä¸­æ»¡è¶³æŸä¸ªæ¡ä»¶çš„å…ƒç´ çš„ç´¢å¼• np.where(condition, x, y) ä¸‰ç›®è¿ç®—æ»¡è¶³conditionï¼Œä¸ºxï¼›ä¸æ»¡è¶³conditionï¼Œåˆ™ä¸ºy score = np.array([[80, 88], [82, 81], [84, 75], [86, 83], [75, 81]]) # å¦‚æœæ•°å€¼å°äº80ï¼Œæ›¿æ¢ä¸º0ï¼Œå¦‚æœå¤§äºç­‰äº80ï¼Œæ›¿æ¢ä¸º90 re_score = np.where(score np.where(condition) åªæœ‰æ¡ä»¶ (condition)ï¼Œæ²¡æœ‰xå’Œyï¼Œåˆ™è¾“å‡ºæ»¡è¶³æ¡ä»¶ (å³é0) å…ƒç´ çš„åæ ‡ (ç­‰ä»·äºnumpy.nonzero)ã€‚è¿™é‡Œçš„åæ ‡ä»¥tupleçš„å½¢å¼ç»™å‡ºï¼Œé€šå¸¸åŸæ•°ç»„æœ‰å¤šå°‘ç»´ï¼Œè¾“å‡ºçš„tupleä¸­å°±åŒ…å«å‡ ä¸ªæ•°ç»„ï¼Œåˆ†åˆ«å¯¹åº”ç¬¦åˆæ¡ä»¶å…ƒç´ çš„å„ç»´åæ ‡ã€‚ //è¿™é‡Œæˆ‘ä»¬è¾“å‡ºxæ•°æ®ä¸­å¤§äº5çš„å…ƒç´ çš„ç´¢å¼• y=np.where(x>5) print(y) è¾“å‡ºç»“æœï¼š (array([1, 2, 2, 2], dtype=int64), array([2, 0, 1, 2], dtype=int64)) //ä½¿ç”¨ç´¢å¼•å–å‡ºå…ƒç´ \" print(x[y]) è¾“å‡ºç»“æœï¼š [6 7 8 9] numpy.extract() ä»æ•°ç»„ä¸­æå–ç¬¦åˆæ¡ä»¶çš„å…ƒç´  numpy.extract()å‡½æ•°ï¼Œå’Œwhereå‡½æ•°æœ‰ä¸€ç‚¹ç›¸ï¼Œä¸è¿‡extractå‡½æ•°æ˜¯è¿”å›æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯å…ƒç´ ç´¢å¼• arr = np.arange(10) arrarray([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])# Define the codition, here we take MOD 3 if zero condition = np.mod(arr, 3)==0 #conditionarray([ True, False, False, True, False, False, True, False, False,True]) np.extract(condition, arr) #array([0, 3, 6, 9]) åŒæ ·åœ°ï¼Œå¦‚æœæœ‰éœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ AND å’Œ OR ç»„åˆçš„ç›´æ¥æ¡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š np.extract(((arr > 2) & (arr numpy.setdiff1d å¦‚ä½•æ‰¾åˆ°ä»…åœ¨ A æ•°ç»„ä¸­æœ‰è€Œ B æ•°ç»„æ²¡æœ‰çš„å…ƒç´  setdiff1d(ar1, ar2, assume_unique=False) 1.åŠŸèƒ½ï¼šæ‰¾åˆ°2ä¸ªæ•°ç»„ä¸­é›†åˆå…ƒç´ çš„å·®å¼‚ã€‚ 2.è¿”å›å€¼ï¼šåœ¨ar1ä¸­ä½†ä¸åœ¨ar2ä¸­çš„'å·²æ’åº'çš„'å”¯ä¸€å€¼'ã€‚ 3.å‚æ•°ï¼š ar1ï¼šarray_like è¾“å…¥æ•°ç»„ã€‚ ar2ï¼šarray_like è¾“å…¥æ¯”è¾ƒæ•°ç»„ã€‚ assume_uniqueï¼šboolã€‚å¦‚æœä¸ºTrueï¼Œåˆ™å‡å®šè¾“å…¥æ•°ç»„æ˜¯å”¯ä¸€çš„ï¼Œå³å¯ä»¥åŠ å¿«è®¡ç®—é€Ÿåº¦ã€‚ é»˜è®¤å€¼ä¸ºFalseã€‚ è¿”å›æ•°ç»„ä¸­ä¸åœ¨å¦ä¸€ä¸ªæ•°ç»„ä¸­çš„ç‹¬æœ‰å…ƒç´ ã€‚è¿™ç­‰ä»·äºä¸¤ä¸ªæ•°ç»„å…ƒç´ é›†åˆçš„å·®é›†ã€‚ a = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9]) b = np.array([3,4,7,6,7,8,11,12,14]) c = np.setdiff1d(a,b) carray([1, 2, 5, 9]) numpy.intersect1d() æ±‚ä¸¤ä¸ªæ•°ç»„çš„äº¤é›† >>> np.intersect1d([1, 3, 4, 3], [3, 1, 2, 1]) array([1, 3]) è¦æ±‚äº¤é›†çš„æ•°ç»„å¤šäºä¸¤ä¸ª, å¯ä½¿ç”¨functools.reduce: >>> from functools import reduce >>> reduce(np.intersect1d, ([1, 3, 4, 3], [3, 1, 2, 1], [6, 3, 4, 2])) array([3]) numpy.nonzero() numpy.nonzero(a) è¿”å›æ•°ç»„ a ä¸­éé›¶å…ƒç´ çš„ç´¢å¼•å€¼æ•°ç»„ã€‚ ï¼ˆ1ï¼‰åªæœ‰ a ä¸­éé›¶å…ƒç´ æ‰ä¼šæœ‰ç´¢å¼•å€¼ï¼Œé‚£äº›é›¶å€¼å…ƒç´ æ²¡æœ‰ç´¢å¼•å€¼ï¼› ï¼ˆ2ï¼‰è¿”å›çš„ç´¢å¼•å€¼æ•°ç»„æ˜¯ä¸€ä¸ª2ç»´ tuple æ•°ç»„ï¼Œè¯¥ tuple æ•°ç»„ä¸­åŒ…å«ä¸€ç»´çš„arrayæ•°ç»„ã€‚å…¶ä¸­ï¼Œä¸€ç»´ array å‘é‡çš„ä¸ªæ•°ä¸ a çš„ç»´æ•°æ˜¯ä¸€è‡´çš„ã€‚ ï¼ˆ3ï¼‰ç´¢å¼•å€¼æ•°ç»„çš„æ¯ä¸€ä¸ªarrayå‡æ˜¯ä»ä¸€ä¸ªç»´åº¦ä¸Šæ¥æè¿°å…¶ç´¢å¼•å€¼ã€‚æ¯”å¦‚ï¼Œå¦‚æœaæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œåˆ™ç´¢å¼•å€¼æ•°ç»„æœ‰ä¸¤ä¸ª arrayï¼Œç¬¬ä¸€ä¸ª array ä»è¡Œç»´åº¦æ¥æè¿°ç´¢å¼•å€¼ï¼›ç¬¬äºŒä¸ª array ä»åˆ—ç»´åº¦æ¥æè¿°ç´¢å¼•å€¼ã€‚ ï¼ˆ4ï¼‰ è¯¥np.transpose(np.nonzero(x)) å‡½æ•°èƒ½å¤Ÿæè¿°å‡ºæ¯ä¸€ä¸ªéé›¶å…ƒç´ åœ¨ä¸åŒç»´åº¦çš„ç´¢å¼•å€¼ã€‚ ï¼ˆ5ï¼‰é€šè¿‡ a[nonzero(a)]å¾—åˆ°æ‰€æœ‰aä¸­çš„éé›¶å€¼ nz = np.nonzero([1,2,0,0,4,0])â€‹ nz #(array([0, 1, 4], dtype=int64),) nz[0] #array([0, 1, 4], dtype=int64) nz[0] #array([0, 1, 4], dtype=int64) numpy.pad() np.padï¼ˆarrayï¼Œpad_widthï¼Œmodeï¼Œ**kwarsï¼‰ è§£é‡Šï¼š ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¾…å¡«å……æ•°ç»„ ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¡«å……çš„å½¢çŠ¶ï¼Œï¼ˆ2ï¼Œ3ï¼‰è¡¨ç¤ºå‰é¢ä¸¤ä¸ªï¼Œåé¢ä¸‰ä¸ª ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å¡«å……çš„æ–¹æ³• å¡«å……æ–¹æ³•ï¼š constantè¿ç»­ä¸€æ ·çš„å€¼å¡«å……ï¼Œæœ‰å…³äºå…¶å¡«å……å€¼çš„å‚æ•°ã€‚ constant_values=ï¼ˆx, yï¼‰æ—¶å‰é¢ç”¨xå¡«å……ï¼Œåé¢ç”¨yå¡«å……ã€‚ç¼ºå‚æ•°æ˜¯ä¸º0000ã€‚ã€‚ã€‚ edgeç”¨è¾¹ç¼˜å€¼å¡«å…… linear_rampè¾¹ç¼˜é€’å‡çš„å¡«å……æ–¹å¼ maximum, mean, median, minimumåˆ†åˆ«ç”¨æœ€å¤§å€¼ã€å‡å€¼ã€ä¸­ä½æ•°å’Œæœ€å°å€¼å¡«å…… reflect, symmetricéƒ½æ˜¯å¯¹ç§°å¡«å……ã€‚å‰ä¸€ä¸ªæ˜¯å…³äºè¾¹ç¼˜å¯¹ç§°ï¼Œåä¸€ä¸ªæ˜¯å…³äºè¾¹ç¼˜å¤–çš„ç©ºæ°”å¯¹ç§°â•®(â•¯â–½â•°)â•­ wrapç”¨åŸæ•°ç»„åé¢çš„å€¼å¡«å……å‰é¢ï¼Œå‰é¢çš„å€¼å¡«å……åé¢ ä¹Ÿå¯ä»¥æœ‰å…¶ä»–è‡ªå®šä¹‰çš„å¡«å……æ–¹æ³• numpy.percentileï¼ˆï¼‰ åˆ†ä½æ•°å‡½æ•° åœ¨ python ä¸­è®¡ç®—ä¸€ä¸ªå¤šç»´æ•°ç»„çš„ä»»æ„ç™¾åˆ†æ¯”åˆ†ä½æ•°ï¼Œæ­¤å¤„çš„ç™¾åˆ†ä½æ˜¯ä»å°åˆ°å¤§æ’åˆ—ï¼Œåªéœ€ç”¨np.percentileå³å¯â€¦â€¦ numpy.percentile(a, q, axis=None, out=None, overwrite_input=False, interpolation='linear', keepdims=False) a : npæ•°ç»„ q : float in range of [0,100] (or sequence of floats) Percentile to computeã€‚ è¦è®¡ç®—çš„qåˆ†ä½æ•°ã€‚ axis : é‚£ä¸ªè½´ä¸Šè¿ç®—ã€‚ keepdims :boolæ˜¯å¦ä¿æŒç»´åº¦ä¸å˜ã€‚ import numpy as np a = np.array([1,2,3,4,5]) p = np.percentile(a, 50) # æ±‚ä¸­ä½æ•° # 3 >>> a = np.array([[10, 7, 4], [3, 2, 1]]) >>> a array([[10, 7, 4], [ 3, 2, 1]]) >>> np.percentile(a, 50) #50%çš„åˆ†ä½æ•°ï¼Œå°±æ˜¯aé‡Œæ’åºä¹‹åçš„ä¸­ä½æ•° 3.5 >>> np.percentile(a, 50, axis=0) #axisä¸º0ï¼Œåœ¨çºµåˆ—ä¸Šæ±‚ array([[ 6.5, 4.5, 2.5]]) >>> np.percentile(a, 50, axis=1) #axisä¸º1ï¼Œåœ¨æ¨ªè¡Œä¸Šæ±‚ array([ 7., 2.]) >>> np.percentile(a, 50, axis=1, keepdims=True) #keepdims=Trueä¿æŒç»´åº¦ä¸å˜ array([[ 7.], [ 2.]]) numpy.nanpercentile å¿½ç•¥ç©ºå€¼çš„ç™¾åˆ†ä½æ•° numpy.count_nonzero() numpy.count_nonzero(a) è®¡ç®—æ•°ç»„aä¸­éé›¶å€¼çš„æ•°é‡ã€‚ >>> np.count_nonzero(np.eye(4)) 4 >>> np.count_nonzero([[0,1,7,0,0],[3,0,0,2,19]]) 5 numpy.nonzero() è¿”å›éé›¶å…ƒç´ çš„ç´¢å¼•ã€‚ è¿”å›æ•°ç»„çš„å…ƒç»„ï¼Œæ¯ä¸ªç»´åº¦aä¸€ä¸ªï¼ŒåŒ…å«è¯¥ç»´åº¦ä¸­éé›¶å…ƒç´ çš„ç´¢å¼•ã€‚aä¸­çš„å€¼æ€»æ˜¯ä»¥è¡Œä¸»ï¼ŒCé£æ ¼é¡ºåºæµ‹è¯•å’Œè¿”å›ã€‚ç›¸åº”çš„éé›¶å€¼å¯ä»¥ç”¨ä¸‹å¼è·å¾—ï¼š >>> x array([[ 1., 0., 0.], [ 0., 1., 0.], [ 0., 0., 1.]]) >>> np.nonzero(x) (array([0, 1, 2]), array([0, 1, 2])) >>> x[np.nonzero(x)] array([ 1., 1., 1.]) >>> np.transpose(np.nonzero(x)) array([[0, 0], [1, 1], [2, 2]]) nonzeroçš„å¸¸è§ç”¨æ³•æ˜¯æ‰¾åˆ°æ•°ç»„çš„ç´¢å¼•ï¼Œå…¶ä¸­æ¡ä»¶ä¸ºTrueã€‚ >>> a = np.array([[1,2,3],[4,5,6],[7,8,9]]) >>> a > 3 array([[False, False, False], [ True, True, True], [ True, True, True]], dtype=bool) >>> np.nonzero(a > 3) (array([1, 1, 1, 2, 2, 2]), array([0, 1, 2, 0, 1, 2])) å‚è€ƒï¼š Sorting, searching, and counting Update timeï¼š 2020-05-25 "},"Chapter1/NumPy åæ–¹å·®covä¸ç›¸å…³ç³»æ•°corrcoefçš„ä½¿ç”¨.html":{"url":"Chapter1/NumPy åæ–¹å·®covä¸ç›¸å…³ç³»æ•°corrcoefçš„ä½¿ç”¨.html","title":"NumPy åæ–¹å·®covä¸ç›¸å…³ç³»æ•°corrcoefçš„ä½¿ç”¨","keywords":"","body":"NumPy åæ–¹å·®covä¸ç›¸å…³ç³»æ•°corrcoefçš„ä½¿ç”¨ åæ–¹å·® å¦‚æœä¸¤ä¸ªå˜é‡çš„å˜åŒ–è¶‹åŠ¿ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå…¶ä¸­ä¸€ä¸ªå¤§äºè‡ªèº«çš„æœŸæœ›å€¼æ—¶å¦å¤–ä¸€ä¸ªä¹Ÿå¤§äºè‡ªèº«çš„æœŸæœ›å€¼ï¼Œé‚£ä¹ˆä¸¤ä¸ªå˜é‡ä¹‹é—´çš„åæ–¹å·®å°±æ˜¯æ­£å€¼ï¼›å¦‚æœä¸¤ä¸ªå˜é‡çš„å˜åŒ–è¶‹åŠ¿ç›¸åï¼Œå³å…¶ä¸­ä¸€ä¸ªå˜é‡å¤§äºè‡ªèº«çš„æœŸæœ›å€¼æ—¶å¦å¤–ä¸€ä¸ªå´å°äºè‡ªèº«çš„æœŸæœ›å€¼ï¼Œé‚£ä¹ˆä¸¤ä¸ªå˜é‡ä¹‹é—´çš„åæ–¹å·®å°±æ˜¯è´Ÿå€¼ã€‚ å¯ä»¥é€šä¿—çš„ç†è§£ä¸ºï¼šä¸¤ä¸ªå˜é‡åœ¨å˜åŒ–è¿‡ç¨‹ä¸­æ˜¯åŒæ–¹å‘å˜åŒ–ï¼Ÿè¿˜æ˜¯åæ–¹å‘å˜åŒ–ï¼ŸåŒå‘æˆ–åå‘ç¨‹åº¦å¦‚ä½•ï¼Ÿ ä½ å˜å¤§ï¼ŒåŒæ—¶æˆ‘ä¹Ÿå˜å¤§ï¼Œè¯´æ˜ä¸¤ä¸ªå˜é‡æ˜¯åŒå‘å˜åŒ–çš„ï¼Œè¿™æ—¶åæ–¹å·®å°±æ˜¯æ­£çš„; ä½ å˜å¤§ï¼ŒåŒæ—¶æˆ‘å˜å°ï¼Œè¯´æ˜ä¸¤ä¸ªå˜é‡æ˜¯åå‘å˜åŒ–çš„ï¼Œè¿™æ—¶åæ–¹å·®å°±æ˜¯è´Ÿçš„; ä»æ•°å€¼æ¥çœ‹ï¼Œåæ–¹å·®çš„æ•°å€¼è¶Šå¤§ï¼Œä¸¤ä¸ªå˜é‡åŒå‘ç¨‹åº¦ä¹Ÿå°±è¶Šå¤§ã€‚åä¹‹äº¦ç„¶ã€‚ import numpy as np a = np.array([1,2,3]) b = np.array([4,3,4]) x = np.vstack((a,b)) >>> np.cov(a, b) array([[ 1. , 0. ], [ 0. , 0.33333333]]) >>> np.cov(a, b, bias=True) array([[ 0.66666667, 0. ], [ 0. , 0.22222222]]) >>> np.cov(x) array([[ 1. , 0. ], [ 0. , 0.33333333]]) bais å‚æ•°çš„æ„ä¹‰ï¼Œé»˜è®¤ä¸ºFalseï¼Œé‚£ä¹ˆè®¡ç®—å‡å€¼çš„æ—¶å€™é™¤ä»¥ n - 1ï¼Œå¦‚æœè®¾ä¸ºTrueï¼Œé‚£ä¹ˆè®¡ç®—å‡å€¼çš„æ—¶å€™é™¤ä»¥nï¼Œå…¶ä¸­nä¸ºéšæœºå˜é‡çš„ç»´åº¦æ•° numpy çš„ cov å‡½æ•°ä½¿ç”¨çš„ä¸‰ç‚¹ï¼š å˜é‡çŸ©é˜µçš„ä¸€è¡Œè¡¨ç¤ºä¸€ä¸ªéšæœºå˜é‡ï¼› baiså‚æ•°æ§åˆ¶è®¡ç®—æ—¶é™¤ä»¥n-1è¿˜æ˜¯n, Trueè¡¨ç¤ºé™¤ä»¥nï¼ŒFalseè¡¨ç¤ºé™¤ä»¥n-1ï¼› è¾“å‡ºç»“æœæ˜¯ä¸€ä¸ªåæ–¹å·®çŸ©é˜µ, results[i][j]è¡¨ç¤ºç¬¬iä¸ªéšæœºå˜é‡ä¸ç¬¬jä¸ªéšæœºå˜é‡çš„åæ–¹å·®. ç›¸å…³ç³»æ•° ç›¸å…³ç³»æ•°æ˜¯ç”¨ä»¥åæ˜ å˜é‡ä¹‹é—´ç›¸å…³å…³ç³»å¯†åˆ‡ç¨‹åº¦çš„ç»Ÿè®¡æŒ‡æ ‡ã€‚ç›¸å…³ç³»æ•°ä¹Ÿå¯ä»¥çœ‹æˆåæ–¹å·®ï¼šä¸€ç§å‰”é™¤äº†ä¸¤ä¸ªå˜é‡é‡çº²å½±å“ã€æ ‡å‡†åŒ–åçš„ç‰¹æ®Šåæ–¹å·®,å®ƒæ¶ˆé™¤äº†ä¸¤ä¸ªå˜é‡å˜åŒ–å¹…åº¦çš„å½±å“ï¼Œè€Œåªæ˜¯å•çº¯ååº”ä¸¤ä¸ªå˜é‡æ¯å•ä½å˜åŒ–æ—¶çš„ç›¸ä¼¼ç¨‹åº¦ã€‚ import numpy as np a = np.array([1,2,3]) b = np.array([2,5,8]) x = np.vstack((a,b)) np.corrcoef(a, b) np.corrcoef(x) >>> np.corrcoef(a, b) array([[ 1., 1.], [ 1., 1.]]) >>> np.corrcoef(x) array([[ 1., 1.], [ 1., 1.]]) numpy ä¸­å‡½æ•° corrcoef çš„ç”¨æ³•ä¸å‡½æ•° cov çš„ç”¨æ³•ç›¸ä¼¼ï¼Œåªæ˜¯corrcoefä¸­baiså‚æ•°ä¸èµ·ä½œç”¨ã€‚ numpyçš„corrcoef å‡½æ•°ä½¿ç”¨çš„ä¸¤ç‚¹ï¼š å˜é‡çŸ©é˜µçš„ä¸€è¡Œè¡¨ç¤ºä¸€ä¸ªéšæœºå˜é‡ï¼› è¾“å‡ºç»“æœæ˜¯ä¸€ä¸ªç›¸å…³ç³»æ•°çŸ©é˜µ, results[i][j]è¡¨ç¤ºç¬¬iä¸ªéšæœºå˜é‡ä¸ç¬¬jä¸ªéšæœºå˜é‡çš„ç›¸å…³ç³»æ•°. å‚è€ƒ åæ–¹å·®ä¸ç›¸å…³ç³»æ•° numpyä¸­covä¸corrcoefçš„ä½¿ç”¨ Update timeï¼š 2020-05-25 "},"Chapter1/numpy.set_printoptions.html":{"url":"Chapter1/numpy.set_printoptions.html","title":"numpy.set_printoptions()","keywords":"","body":"numpy.set_printoptions() set_printoptions() è®¾ç½®è¾“å‡ºæ ·å¼ numpy.set_printoptions(precision=None, threshold=None, edgeitems=None, linewidth=None, suppress=None, nanstr=None, infstr=None, formatter=None )[source] precision: int, optionalï¼Œfloatè¾“å‡ºçš„ç²¾åº¦ï¼Œå³å°æ•°ç‚¹åç»´æ•°ï¼Œé»˜è®¤8ï¼ˆ Number of digits of precision for floating point output (default 8)ï¼‰ threshold : int, optionalï¼Œå½“æ•°ç»„æ•°ç›®è¿‡å¤§æ—¶ï¼Œè®¾ç½®æ˜¾ç¤ºå‡ ä¸ªæ•°å­—ï¼Œå…¶ä½™ç”¨çœç•¥å·ï¼ˆTotal number of array elements which trigger summarization rather than full repr (default 1000).ï¼‰ edgeitems: int, optionalï¼Œè¾¹ç¼˜æ•°ç›®ï¼ˆNumber of array items in summary at beginning and end of each dimension (default 3)ï¼‰. linewidth : int, optionalï¼ŒThe number of characters per line for the purpose of inserting line breaks (default 75). suppress : bool, optionalï¼Œæ˜¯å¦å‹ç¼©ç”±ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºçš„æµ®ç‚¹æ•°ï¼ˆWhether or not suppress printing of small floating point values using scientific notation (default False).ï¼‰ nanstr: str, optionalï¼ŒString representation of floating point not-a-number (default nan). infstr : str, optionalï¼ŒString representation of floating point infinity (default inf). æµ®ç‚¹ç²¾åº¦å¯è®¾ç½®ï¼š >>> np.set_printoptions(precision=4) >>> print(np.array([1.123456789])) [ 1.1235] é•¿æ•°ç»„å¯æ¦‚æ‹¬ä¸ºï¼š >>> np.set_printoptions(threshold=5) >>> print(np.arange(10)) [0 1 2 ..., 7 8 9] np.set_printoptions(threshold=np.nan) è®¾ç½®æ‰“å°æ—¶æ˜¾ç¤ºæ–¹å¼, threshold=np.nan æ„æ€æ˜¯è¾“å‡ºæ•°ç»„çš„æ—¶å€™å®Œå…¨è¾“å‡ºï¼Œä¸éœ€è¦çœç•¥å·å°†ä¸­é—´æ•°æ®çœç•¥ å‚è€ƒï¼š http://doc.codingdict.com/NumPy_v111/reference/generated/numpy.set_printoptions.html#numpy.set_printoptions Update timeï¼š 2020-05-25 "},"Chapter1/numpy.datetime64æ—¥æœŸå‡½æ•°.html":{"url":"Chapter1/numpy.datetime64æ—¥æœŸå‡½æ•°.html","title":"numpy.datetime64()æ—¥æœŸå‡½æ•°","keywords":"","body":"numpy.datetime64()æ—¥æœŸå‡½æ•° Basic Datetimes åˆ›å»ºæ•°æ®æ—¶é—´çš„æœ€åŸºæœ¬çš„æ–¹æ³•æ˜¯ä½¿ç”¨ISO 8601æ—¥æœŸæˆ–æ—¥æœŸæ—¶é—´æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚å†…éƒ¨å­˜å‚¨å•å…ƒæ˜¯ä»å­—ç¬¦ä¸²çš„å½¢å¼è‡ªåŠ¨é€‰æ‹©çš„ï¼Œå¯ä»¥æ˜¯date unitæˆ–time unitã€‚ æ—¥æœŸå•ä½æ˜¯å¹´ï¼ˆâ€˜Yâ€™ï¼‰ï¼Œæœˆï¼ˆâ€˜Mâ€™ï¼‰ï¼Œæ˜ŸæœŸï¼ˆâ€˜Wâ€™ï¼‰å’Œæ—¥ï¼ˆâ€˜Dâ€™ï¼‰ï¼Œè€Œæ—¶é—´å•ä½æ˜¯å°æ—¶ï¼ˆhï¼‰ï¼Œç§’ï¼ˆâ€˜sâ€™ï¼‰ï¼Œæ¯«ç§’ï¼ˆâ€˜msâ€™ï¼‰å’Œä¸€äº›é™„åŠ çš„åŸºäºç§’å‰ç¼€çš„å•ä½ã€‚ ç®€å•çš„ISOæ—¥æœŸ >>> np.datetime64('2005-02-25') numpy.datetime64('2005-02-25') str(np.datetime64('2005-02-25')) #'2005-02-25' ä½¿ç”¨æœˆä»½ä¸ºå•ä½ >>> np.datetime64('2005-02') numpy.datetime64('2005-02') ä»…æŒ‡å®šæœˆä»½ï¼Œä½†å¼ºåˆ¶ä½¿ç”¨â€œå¤©â€å•ä½ï¼š >>> np.datetime64('2005-02', 'D') numpy.datetime64('2005-02-01') ä»å­—ç¬¦ä¸²åˆ›å»ºæ•°æ®é›†çš„æ•°ç»„æ—¶ï¼Œä»ç„¶å¯ä»¥ä½¿ç”¨å¸¦æœ‰é€šç”¨å•ä½çš„æ—¥æœŸæ—¶é—´ç±»å‹ä»è¾“å…¥ä¸­è‡ªåŠ¨é€‰æ‹©å•ä½ã€‚ >>> np.array(['2007-07-13', '2006-01-13', '2010-08-13'], dtype='datetime64') array(['2007-07-13', '2006-01-13', '2010-08-13'], dtype='datetime64[D]') ç”Ÿæˆæ—¥æœŸèŒƒå›´ datetimeç±»å‹é€‚ç”¨äºè®¸å¤šå¸¸è§çš„NumPyå‡½æ•°ï¼Œä¾‹å¦‚arangeå¯ç”¨äºç”Ÿæˆæ—¥æœŸèŒƒå›´ã€‚ æ‰€æœ‰æ—¥æœŸä¸€ä¸ªæœˆï¼š æŒ‡å®šæ ¼å¼dtype=datetime64[D] å¤© Z = np.arange('2016-07', '2016-08', dtype='datetime64[D]') ''' array(['2016-07-01', '2016-07-02', '2016-07-03', '2016-07-04', '2016-07-05', '2016-07-06', '2016-07-07', '2016-07-08', '2016-07-09', '2016-07-10', '2016-07-11', '2016-07-12', '2016-07-13', '2016-07-14', '2016-07-15', '2016-07-16', '2016-07-17', '2016-07-18', '2016-07-19', '2016-07-20', '2016-07-21', '2016-07-22', '2016-07-23', '2016-07-24', '2016-07-25', '2016-07-26', '2016-07-27', '2016-07-28', '2016-07-29', '2016-07-30', '2016-07-31'], dtype='datetime64[D]') ''' æ—¥æœŸå’Œæ—¶é—´çš„å¢é‡ç®—æ³• timedelta64 NumPy å…è®¸å‡å»ä¸¤ä¸ªæ—¥æœŸæ—¶é—´å€¼ï¼Œä¸€ä¸ªäº§ç”Ÿå…·æœ‰æ—¶é—´å•ä½çš„æ•°å­—çš„æ“ä½œã€‚ç”±äº NumPy åœ¨å…¶æ ¸å¿ƒä¸­æ²¡æœ‰ç‰©ç†é‡ç³»ç»Ÿï¼Œå› æ­¤åˆ›å»ºäº†timedelta64æ•°æ®ç±»å‹ä»¥è¡¥å……datetime64ã€‚ Datetimes å’ŒTimedeltas ä¸€èµ·å·¥ä½œï¼Œä¸ºç®€å•çš„æ—¥æœŸæ—¶é—´è®¡ç®—æä¾›æ–¹æ³•ã€‚ >>> np.datetime64('2009-01-01') - np.datetime64('2008-01-01') #numpy.timedelta64(366,'D') str(np.datetime64('2009-01-01') - np.datetime64('2008-01-01')) '366 days' str(np.datetime64('2009-01-01') - np.datetime64('2008-01-01')).split(\" \")[0] #'366' np.busday_count() è¦æŸ¥æ‰¾datetime64æ—¥æœŸçš„æŒ‡å®šèŒƒå›´å†…æœ‰å¤šå°‘æœ‰æ•ˆå¤©æ•°ï¼Œè¯·ä½¿ç”¨busday_countï¼š >>> np.busday_count(np.datetime64('2011-07-11'), np.datetime64('2011-07-18')) 5 >>> np.busday_count(np.datetime64('2011-07-18'), np.datetime64('2011-07-11')) -5 å¦‚æœä½ æœ‰ä¸€ä¸ªdatetime64 dayå€¼çš„æ•°ç»„ï¼Œå¹¶ä¸”ä½ æƒ³è¦ä¸€ä¸ªæœ‰å¤šå°‘æ˜¯æœ‰æ•ˆæ—¥æœŸçš„è®¡æ•°ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š >>> a = np.arange(np.datetime64('2011-07-11'), np.datetime64('2011-07-18')) >>> np.count_nonzero(np.is_busday(a)) 5 å‚è€ƒï¼š Datetimes and Timedeltas Update timeï¼š 2020-05-25 "},"Chapter1/numpy.splitå‡½æ•°.html":{"url":"Chapter1/numpy.splitå‡½æ•°.html","title":"numpy.split()å‡½æ•°","keywords":"","body":"numpy.split()å‡½æ•° np.split(ary, indices_or_sections, axis=0) å‡½æ•°åŠŸèƒ½ï¼š æŠŠä¸€ä¸ªæ•°ç»„ä»å·¦åˆ°å³æŒ‰é¡ºåºåˆ‡åˆ† å‚æ•°ï¼š aryï¼šè¦åˆ‡åˆ†çš„æ•°ç»„ indices_or_sectionsï¼šå¦‚æœæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå°±ç”¨è¯¥æ•°å¹³å‡åˆ‡åˆ†ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸ºæ²¿è½´åˆ‡åˆ†çš„ä½ç½® axisï¼šæ²¿ç€å“ªä¸ªç»´åº¦è¿›è¡Œåˆ‡å‘ï¼Œé»˜è®¤ä¸º0ï¼Œæ¨ªå‘åˆ‡åˆ† ä¸€ç»´æ•°ç»„ x = np.array([0,1,2,3,4,5,6,7,8]) print (np.split(x,3)) # [array([0, 1, 2]), array([3, 4, 5]), array([6, 7, 8])] print (np.split(x,[3,5,6,9])) # [array([0, 1, 2]), array([3, 4]), array([5]), array([6, 7, 8]), # array([], dtype=int32)] print(np.split(x,[3,5,6,8])) # [array([0, 1, 2]), array([3, 4]), array([5]), array([6, 7]), array([8])] å½“ indices_or_sections ä¸ºæ•°ç»„æ—¶ï¼Œä¸º[) çš„æƒ…å†µï¼š å¾ˆæ˜æ˜¾ï¼Œå› ä¸ºä¸€ç»´æ•°ç»„åªæœ‰ä¸€ä¸ªç»´åº¦ï¼Œæ‰€ä»¥åˆ‡åˆ†åªä¼šåœ¨è¿™ä¸€ä¸ªç»´åº¦è¿›è¡Œã€‚ç¬¬ä¸€è¡Œè¾“å‡ºå¯¹åº”indices_or_sectionså‚æ•°ä¸ºä¸€ä¸ªæ•´æ•°ï¼Œå°†æ•°ç»„å¹³å‡åˆ†æˆäº†ä¸‰ä»½ï¼Œç¬¬äºŒè¡Œè¾“å‡ºå¯¹åº”indices_or_sectionså‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œæ­¤æ—¶æ¯ä¸€æ¬¡åˆ‡åˆ†éƒ½ä¼šå°†è¦åˆ‡åˆ†æ•°ç»„çš„å‰nï¼ˆn=3,5ï¼Œ6,9ï¼‰ä¸ªå…ƒç´ åˆ‡åˆ†å‡ºæ¥ï¼Œç¬¬ä¸€æ¬¡n=3ï¼Œè¿›è¡Œæ•°ç»„åˆ‡åˆ†å¾—åˆ°array([0, 1, 2])ï¼Œç¬¬äºŒæ¬¡n=5ï¼Œè¿›è¡Œæ•°ç»„åˆ‡åˆ†å¾—åˆ°array([3, 4])ï¼Œæ­¤æ—¶æ•°ç»„å‰5ä¸ªå…ƒç´ å·²ç»åˆ‡åˆ†å®Œæ¯•ï¼Œåç»­åŒç†ï¼Œæœ€åä¸€æ¬¡n=9ï¼Œåˆ‡åˆ†å®Œæ¯•åæ•°ç»„æ‰€æœ‰å…ƒç´ å·²ç»è¢«åˆ‡åˆ†ï¼Œæ‰€ä»¥æœ€åä¸€ä¸ªarrayä¸ºarray([], dtype=int32)ï¼Œå¯¹æ¯”ç¬¬ä¸‰è¡Œè¾“å‡ºå¯ä»¥çœ‹å‡ºåŒºåˆ«ã€‚ äºŒç»´æ•°ç»„ import numpy as np a = np.array([[1,2,3], [1,2,5], [4,6,7]]) print (np.split(a, [2, 3],axis = 0)) [array([[1, 2, 3], [1, 2, 5]]), array([[4, 6, 7]]), array([], shape=(0, 3), dtype=int32)] print (np.split(a, [1, 2],axis = 1)) [array([[1], [1], [4]]), array([[2], [2], [6]]), array([[3], [5], [7]])] Update timeï¼š 2020-05-25 "},"Chapter1/Numpy np.count_nonzero.html":{"url":"Chapter1/Numpy np.count_nonzero.html","title":"Numpy np.count_nonzero","keywords":"","body":"Numpy np.count_nonzero numpy.count_nonzero(a) è®¡ç®—æ•°ç»„aä¸­éé›¶å€¼çš„æ•°é‡ã€‚ å‚æ•°ï¼š aï¼šarray_likeè¦ä¸ºå…¶è®¡æ•°éé›¶çš„æ•°ç»„ã€‚ è¿”å›ï¼š countï¼šintæˆ–æ•°ç»„intæ•°ç»„ä¸­çš„éé›¶å€¼æ•°ã€‚ >>> np.count_nonzero(np.eye(4)) 4 >>> np.count_nonzero([[0,1,7,0,0],[3,0,0,2,19]]) 5 Update timeï¼š 2020-05-25 "},"Chapter1/Numpy np.zeros_likeå‡½æ•°.html":{"url":"Chapter1/Numpy np.zeros_likeå‡½æ•°.html","title":"Numpy np.zeros_like()å‡½æ•°","keywords":"","body":"Numpy np.zeros_like()å‡½æ•° numpy.zeros_like(a, dtype = None, order ='K', subok = True ) è¿”å›ä¸æŒ‡å®šæ•°ç»„å…·æœ‰ç›¸åŒå½¢çŠ¶å’Œæ•°æ®ç±»å‹çš„æ•°ç»„ï¼Œå¹¶ä¸”æ•°ç»„ä¸­çš„å€¼éƒ½ä¸º0ã€‚ å‚æ•° a ï¼š array_like ç”¨ `a`çš„å½¢çŠ¶å’Œæ•°æ®ç±»å‹ï¼Œæ¥å®šä¹‰è¿”å›æ•°ç»„çš„å±æ€§ dtypeï¼š æ•°æ®ç±»å‹ï¼Œå¯é€‰ è¦†ç›–ç»“æœçš„æ•°æ®ç±»å‹ã€‚ order é¡ºåº ï¼š {'C'ï¼Œ'F'ï¼Œ'A'æˆ–'K'}ï¼Œå¯é€‰ è¦†ç›–ç»“æœçš„å†…å­˜å¸ƒå±€ã€‚'C'è¡¨ç¤ºCé¡ºåºï¼Œ'F'è¡¨ç¤ºFé¡ºåºï¼Œ'A'è¡¨ç¤ºå¦‚æœaæ˜¯Fortranè¿ç»­ï¼Œåˆ™è¡¨ç¤º'F'ï¼Œå¦åˆ™'C'ã€‚â€œKâ€è¡¨ç¤ºåŒ¹é…çš„å¸ƒå±€ä¸€ä¸ªå°½å¯èƒ½æ¥è¿‘ã€‚ subokï¼š boolï¼Œå¯é€‰ã€‚ å€¼ä¸ºTrueæ˜¯ä½¿ç”¨açš„å†…éƒ¨æ•°æ®ç±»å‹ï¼Œå€¼ä¸ºFalseæ˜¯ä½¿ç”¨aæ•°ç»„çš„æ•°æ®ç±»å‹ï¼Œé»˜è®¤ä¸ºTrue Update timeï¼š 2020-05-25 "},"Chapter1/Numpy ä¸Šä¸‰è§’çŸ©é˜µtriuå’Œä¸‹ä¸‰è§’çŸ©é˜µtril.html":{"url":"Chapter1/Numpy ä¸Šä¸‰è§’çŸ©é˜µtriuå’Œä¸‹ä¸‰è§’çŸ©é˜µtril.html","title":"Numpy ä¸Šä¸‰è§’çŸ©é˜µtriuå’Œä¸‹ä¸‰è§’çŸ©é˜µtril","keywords":"","body":"Numpy ä¸Šä¸‰è§’çŸ©é˜µtriuå’Œä¸‹ä¸‰è§’çŸ©é˜µtril numpy.tril ä¸‹ä¸‰è§’çŸ©é˜µ >>> np.tril([[1,2,3],[4,5,6],[7,8,9],[10,11,12]], -1) array([[ 0, 0, 0], [ 4, 0, 0], [ 7, 8, 0], [10, 11, 12]]) numpy.triu >>> np.triu([[1,2,3],[4,5,6],[7,8,9],[10,11,12]], -1) array([[ 1, 2, 3], [ 4, 5, 6], [ 0, 8, 9], [ 0, 0, 12]]) numpy.triu_indices numpy.triu_indices(n, k=0, m=None) å‚æ•°ï¼š n : è¿”å›çš„ç´¢å¼•å°†æœ‰æ•ˆçš„æ•°ç»„çš„å¤§å°ã€‚ k : int å¯é€‰ï¼Œ å¯¹è§’çº¿åç§» m : int å¯é€‰ è¿”å›çš„æ•°ç»„å°†æœ‰æ•ˆçš„æ•°ç»„çš„åˆ—ç»´åº¦ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œmç­‰äºnã€‚ è¿”å› indsï¼šå…ƒç»„ï¼Œå½¢çŠ¶ï¼ˆ2ï¼‰çš„æ•°ç»„ï¼Œå½¢çŠ¶ï¼ˆnï¼‰ ä¸‰è§’å½¢çš„ç´¢å¼•ã€‚è¿”å›çš„å…ƒç»„åŒ…å«ä¸¤ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„çš„ç´¢å¼•æ²¿ç€æ•°ç»„çš„ä¸€ä¸ªç»´åº¦ã€‚å¯ç”¨äºåˆ‡å‰²å½¢çŠ¶çš„é˜µåˆ—ï¼ˆnï¼Œnï¼‰ã€‚ In [29]: iu1 = np.triu_indices(3) In [30]: iu2 = np.triu_indices(4) In [31]: iu3 = np.triu_indices(4, 2) In [32]: a = np.arange(16).reshape(4, 4) In [33]: a Out[33]: array([[ 0, 1, 2, 3], [ 4, 5, 6, 7], [ 8, 9, 10, 11], [12, 13, 14, 15]]) In [34]: a[iu1] Out[34]: array([ 0, 1, 2, 5, 6, 10]) In [35]: a[iu2] Out[35]: array([ 0, 1, 2, 3, 5, 6, 7, 10, 11, 15]) In [36]: a[iu1]=-1 In [37]: a Out[37]: array([[-1, -1, -1, 3], [ 4, -1, -1, 7], [ 8, 9, -1, 11], [12, 13, 14, 15]]) In [38]: a[iu2] = -10 In [39]: a Out[39]: array([[-10, -10, -10, -10], [ 4, -10, -10, -10], [ 8, 9, -10, -10], [ 12, 13, 14, -10]]) In [40]: a = np.arange(16).reshape(4, 4) In [41]: a Out[41]: array([[ 0, 1, 2, 3], [ 4, 5, 6, 7], [ 8, 9, 10, 11], [12, 13, 14, 15]]) In [42]: a[iu3] Out[42]: array([2, 3, 7]) In [43]: a[iu3] = 100 In [44]: a Out[44]: array([[ 0, 1, 100, 100], [ 4, 5, 6, 100], [ 8, 9, 10, 11], [ 12, 13, 14, 15]]) numpy.tril_indices åŒç† numpy.triu_indices_from è¿”å›ä¸Šä¸‰è§’çŸ©é˜µçš„ç´¢å¼• data = np.random.randn(5,5) mask = np.zeros_like(data) mask array([[0., 0., 0., 0., 0.], [0., 0., 0., 0., 0.], [0., 0., 0., 0., 0.], [0., 0., 0., 0., 0.], [0., 0., 0., 0., 0.]]) np.triu_indices_from(mask) (array([0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 3, 3, 4], dtype=int64), array([0, 1, 2, 3, 4, 1, 2, 3, 4, 2, 3, 4, 3, 4, 4], dtype=int64)) numpy.tril_indices_from åŒç† å‚è€ƒï¼š å®˜æ–¹æ–‡æ¡£ å®˜æ–¹æ–‡æ¡£(ä¸­) Update timeï¼š 2020-05-25 "},"Chapter1/NumPy çŸ©é˜µåº“Matrix.html":{"url":"Chapter1/NumPy çŸ©é˜µåº“Matrix.html","title":"NumPy çŸ©é˜µåº“(Matrix)","keywords":"","body":"NumPy çŸ©é˜µåº“(Matrix) NumPy ä¸­åŒ…å«äº†ä¸€ä¸ªçŸ©é˜µåº“ numpy.matlibï¼Œè¯¥æ¨¡å—ä¸­çš„å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œè€Œä¸æ˜¯ ndarray å¯¹è±¡ã€‚ ä¸€ä¸ªm*n çš„çŸ©é˜µæ˜¯ä¸€ä¸ªç”±è¡Œï¼ˆmrowï¼‰åˆ—nï¼ˆcolumnï¼‰å…ƒç´ æ’åˆ—æˆçš„çŸ©å½¢é˜µåˆ—ã€‚ çŸ©é˜µé‡Œçš„å…ƒç´ å¯ä»¥æ˜¯æ•°å­—ã€ç¬¦å·æˆ–æ•°å­¦å¼ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç”± 6 ä¸ªæ•°å­—å…ƒç´ æ„æˆçš„ 2 è¡Œ 3 åˆ—çš„çŸ©é˜µï¼š matlib.empty() matlib.empty() å‡½æ•°è¿”å›ä¸€ä¸ªæ–°çš„çŸ©é˜µï¼Œè¯­æ³•æ ¼å¼ä¸ºï¼š numpy.matlib.empty(shape, dtype, order) è¿”å›ç»™å®šå½¢çŠ¶å’Œç±»å‹çš„æ–°çŸ©é˜µï¼Œè€Œä¸åˆå§‹åŒ–æ¡ç›®ã€‚ å‚æ•°è¯´æ˜ï¼š shape: å®šä¹‰æ–°çŸ©é˜µå½¢çŠ¶çš„æ•´æ•°æˆ–æ•´æ•°å…ƒç»„ Dtype: å¯é€‰ï¼Œæ•°æ®ç±»å‹ order: Cï¼ˆè¡Œåºä¼˜å…ˆï¼‰ æˆ–è€… Fï¼ˆåˆ—åºä¼˜å…ˆï¼‰ >>> import numpy.matlib >>> np.matlib.empty((2, 2)) # filled with random data matrix([[ 6.76425276e-320, 9.79033856e-307], [ 7.39337286e-309, 3.22135945e-309]]) #random >>> np.matlib.empty((2, 2), dtype=int) matrix([[ 6600475, 0], [ 6586976, 22740995]]) #random numpy.matlib.zeros() numpy.matlib.zeros() å‡½æ•°åˆ›å»ºä¸€ä¸ªä»¥ 0 å¡«å……çš„çŸ©é˜µã€‚ shapeï¼šintæˆ–intsåºåˆ—çŸ©é˜µçš„å½¢çŠ¶ dtypeï¼šæ•°æ®ç±»å‹ï¼Œå¯é€‰çŸ©é˜µçš„æ‰€éœ€æ•°æ®ç±»å‹ï¼Œé»˜è®¤ä¸ºfloatã€‚ orderï¼š{'C'ï¼Œ'F'}ï¼Œå¯é€‰æ˜¯å¦ä»¥Cæˆ–Fortranè¿ç»­é¡ºåºå­˜å‚¨ç»“æœï¼Œé»˜è®¤å€¼ä¸ºâ€œCâ€ã€‚ å¦‚æœshapeå…·æœ‰é•¿åº¦ä¸€å³(N,)æˆ–è€…æ˜¯æ ‡é‡Nï¼Œåˆ™outå½¢çŠ¶çŸ©é˜µ(1,N)ã€‚ >>> import numpy.matlib >>> np.matlib.zeros((2, 3)) matrix([[ 0., 0., 0.], [ 0., 0., 0.]]) >>> np.matlib.zeros(2) matrix([[ 0., 0.]]) numpy.matlib.ones() çŸ©é˜µçš„ä¸€ã€‚ è¿”å›ç»™å®šå½¢çŠ¶å’Œç±»å‹çš„çŸ©é˜µï¼Œç”¨ä¸€ä¸ªå¡«å……ã€‚ shapeï¼š{sequence of intsï¼Œint} çŸ©é˜µçš„å½¢çŠ¶ dtypeï¼šæ•°æ®ç±»å‹ï¼Œå¯é€‰ çŸ©é˜µçš„æ‰€éœ€æ•°æ®ç±»å‹ï¼Œé»˜è®¤ä¸ºnp.float64ã€‚ orderï¼š{'C'ï¼Œ'F'}ï¼Œå¯é€‰æ˜¯å¦ä»¥Cæˆ–Fortranè¿ç»­é¡ºåºå­˜å‚¨çŸ©é˜µï¼Œé»˜è®¤å€¼ä¸ºâ€œCâ€ã€‚ >>> np.matlib.ones((2,3)) matrix([[ 1., 1., 1.], [ 1., 1., 1.]]) >>> np.matlib.ones(2) matrix([[ 1., 1.]]) numpy.matlib.eye() numpy.matlib.eye() å‡½æ•°è¿”å›ä¸€ä¸ªçŸ©é˜µï¼Œå¯¹è§’çº¿å…ƒç´ ä¸º 1ï¼Œå…¶ä»–ä½ç½®ä¸ºé›¶ã€‚ numpy.matlib.eye(n, M,k, dtype) å‚æ•°è¯´æ˜ï¼š n: è¿”å›çŸ©é˜µçš„è¡Œæ•° M: è¿”å›çŸ©é˜µçš„åˆ—æ•°ï¼Œé»˜è®¤ä¸º n k: å¯¹è§’çº¿çš„ç´¢å¼• , 0è¡¨ç¤ºä¸»å¯¹è§’çº¿ï¼Œæ­£å€¼è¡¨ç¤ºä¸Šå¯¹è§’çº¿ï¼Œè´Ÿå€¼è¡¨ç¤ºä¸‹å¯¹è§’çº¿ã€‚ dtype: æ•°æ®ç±»å‹ >>> import numpy.matlib >>> np.matlib.eye(3, k=1, dtype=float) matrix([[ 0., 1., 0.], [ 0., 0., 1.], [ 0., 0., 0.]]) numpy.eye ç­‰æ•ˆæ•°ç»„åŠŸèƒ½ã€‚ numpy.matlib.identity() numpy.matlib.identity(n,dtype=None)å‡½æ•°è¿”å›ç»™å®šå¤§å°çš„å•ä½çŸ©é˜µã€‚ å•ä½çŸ©é˜µæ˜¯ä¸ªæ–¹é˜µï¼Œä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’çš„å¯¹è§’çº¿ï¼ˆç§°ä¸ºä¸»å¯¹è§’çº¿ï¼‰ä¸Šçš„å…ƒç´ å‡ä¸º 1ï¼Œé™¤æ­¤ä»¥å¤–å…¨éƒ½ä¸º 0ã€‚ nï¼šint è¿”å›çš„å•ä½çŸ©é˜µçš„å¤§å°ã€‚ dtypeï¼šæ•°æ®ç±»å‹ï¼Œå¯é€‰ è¾“å‡ºçš„æ•°æ®ç±»å‹ã€‚é»˜è®¤ä¸ºfloatã€‚ >>> import numpy.matlib >>> np.matlib.identity(3, dtype=int) matrix([[1, 0, 0], [0, 1, 0], [0, 0, 1]]) numpy.identity ç­‰æ•ˆæ•°ç»„åŠŸèƒ½ã€‚ numpy.matlib.rand() numpy.matlib.rand(*args)å‡½æ•°åˆ›å»ºä¸€ä¸ªç»™å®šå¤§å°çš„çŸ©é˜µï¼Œæ•°æ®æ˜¯éšæœºå¡«å……çš„ã€‚ è¿”å›å…·æœ‰ç»™å®šå½¢çŠ¶çš„éšæœºå€¼çŸ©é˜µã€‚ åˆ›å»ºç»™å®šå½¢çŠ¶çš„çŸ©é˜µï¼Œå¹¶é€šè¿‡[0ï¼Œ 1ï¼‰çš„å‡åŒ€åˆ†å¸ƒçš„éšæœºæ ·æœ¬ä¼ æ’­å®ƒã€‚ * argsï¼šå‚æ•° è¾“å‡ºå½¢çŠ¶ã€‚å¦‚æœç»™å®šä¸ºNä¸ªæ•´æ•°ï¼Œæ¯ä¸ªæ•´æ•°æŒ‡å®šä¸€ä¸ªç»´åº¦çš„å¤§å°ã€‚å¦‚æœç»™å‡ºä¸€ä¸ªå…ƒç»„ï¼Œè¿™ä¸ªå…ƒç»„ç»™å‡ºå®Œæ•´çš„å½¢çŠ¶ã€‚ >>> import numpy.matlib >>> np.matlib.rand(2, 3) matrix([[ 0.68340382, 0.67926887, 0.83271405], [ 0.00793551, 0.20468222, 0.95253525]]) #random >>> np.matlib.rand((2, 3)) matrix([[ 0.84682055, 0.73626594, 0.11308016], [ 0.85429008, 0.3294825 , 0.89139555]]) #random å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å…ƒç»„ï¼Œåˆ™å¿½ç•¥å…¶ä»–å‚æ•°ï¼š >>> np.matlib.rand((2, 3), 4) matrix([[ 0.46898646, 0.15163588, 0.95188261], [ 0.59208621, 0.09561818, 0.00583606]]) #random nump.mat() å°†è¾“å…¥è§£é‡Šä¸ºçŸ©é˜µã€‚ numpy.mat(data, dtype=None) dataï¼šarray_like è¾“å…¥æ•°æ®ã€‚ dtypeï¼šæ•°æ®ç±»å‹ è¾“å‡ºçŸ©é˜µçš„æ•°æ®ç±»å‹ã€‚ >>> from numpy import * >>> a1=array([1,2,3]) >>> a1 array([1, 2, 3]) >>> a1=mat(a1) >>> a1 matrix([[1, 2, 3]]) >>> shape(a1) (1, 3) >>> b=matrix([1,2,3]) >>> shape(b) (1, 3) åˆ›å»ºå¸¸è§çš„çŸ©é˜µ >>>data1=mat(zeros((3,3))) #åˆ›å»ºä¸€ä¸ª3*3çš„é›¶çŸ©é˜µï¼ŒçŸ©é˜µè¿™é‡Œzeroså‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªtupleç±»å‹(3,3) >>> data1 matrix([[ 0., 0., 0.], [ 0., 0., 0.], [ 0., 0., 0.]]) >>>data2=mat(ones((2,4))) #åˆ›å»ºä¸€ä¸ª2*4çš„1çŸ©é˜µï¼Œé»˜è®¤æ˜¯æµ®ç‚¹å‹çš„æ•°æ®ï¼Œå¦‚æœéœ€è¦æ—¶intç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨dtype=int >>> data2 matrix([[ 1., 1., 1., 1.], [ 1., 1., 1., 1.]]) >>>data3=mat(random.rand(2,2)) #è¿™é‡Œçš„randomæ¨¡å—ä½¿ç”¨çš„æ˜¯numpyä¸­çš„randomæ¨¡å—ï¼Œrandom.rand(2,2)åˆ›å»ºçš„æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œéœ€è¦å°†å…¶è½¬æ¢æˆ#matrix >>> data3 matrix([[ 0.57341802, 0.51016034], [ 0.56438599, 0.70515605]]) >>>data4=mat(random.randint(10,size=(3,3))) #ç”Ÿæˆä¸€ä¸ª3*3çš„0-10ä¹‹é—´çš„éšæœºæ•´æ•°çŸ©é˜µï¼Œå¦‚æœéœ€è¦æŒ‡å®šä¸‹ç•Œåˆ™å¯ä»¥å¤šåŠ ä¸€ä¸ªå‚æ•° >>> data4 matrix([[9, 5, 6], [3, 0, 4], [6, 0, 7]]) >>>data5=mat(random.randint(2,8,size=(2,5))) #äº§ç”Ÿä¸€ä¸ª2-8ä¹‹é—´çš„éšæœºæ•´æ•°çŸ©é˜µ >>> data5 matrix([[5, 4, 6, 3, 7], [5, 3, 3, 4, 6]]) >>>data6=mat(eye(2,2,dtype=int)) #äº§ç”Ÿä¸€ä¸ª2*2çš„å¯¹è§’çŸ©é˜µ >>> data6 matrix([[1, 0], [0, 1]]) a1=[1,2,3] a2=mat(diag(a1)) #ç”Ÿæˆä¸€ä¸ªå¯¹è§’çº¿ä¸º1ã€2ã€3çš„å¯¹è§’çŸ©é˜µ >>> a2 matrix([[1, 0, 0], [0, 2, 0], [0, 0, 3]]) çŸ©é˜µè¿ç®— çŸ©é˜µç›¸ä¹˜ a1=mat([1,2]); a2=mat([[1],[2]]); a3=a1*a2; #1*2çš„çŸ©é˜µä¹˜ä»¥2*1çš„çŸ©é˜µï¼Œå¾—åˆ°1*1çš„çŸ©é˜µ çŸ©é˜µç‚¹ä¹˜(çŸ©é˜µå¯¹åº”å…ƒç´ ç›¸ä¹˜) çŸ©é˜µå¯¹åº”å…ƒç´ ç›¸ä¹˜ a1=mat([3,1]) a2=mat([2,2]) a3=multiply(a1,a2) # matrix([[6, 2]]) çŸ©é˜µæ±‚é€†ï¼Œè½¬ç½® çŸ©é˜µæ±‚é€† >>>a1=mat(eye(2,2)*0.5) >>> a1 matrix([[ 0.5, 0. ], [ 0. , 0.5]]) >>>a2=a1.I #æ±‚çŸ©é˜µmatrix([[0.5,0],[0,0.5]])çš„é€†çŸ©é˜µ >>> a2 matrix([[ 2., 0.], [ 0., 2.]]) çŸ©é˜µè½¬ç½® >>> a1=mat([[1,1],[0,0]]) >>> a1 matrix([[1, 1], [0, 0]]) >>> a2=a1.T >>> a2 matrix([[1, 0], [1, 0]]) çŸ©é˜µçš„åˆ†éš”å’Œåˆå¹¶ çŸ©é˜µçš„åˆ†éš”ï¼ŒåŒåˆ—è¡¨å’Œæ•°ç»„çš„åˆ†éš”ä¸€è‡´ã€‚ >>>a=mat(ones((3,3))) >>> a matrix([[ 1., 1., 1.], [ 1., 1., 1.], [ 1., 1., 1.]]) >>>b=a[1:,1:] #åˆ†å‰²å‡ºç¬¬äºŒè¡Œä»¥åçš„è¡Œå’Œç¬¬äºŒåˆ—ä»¥åçš„åˆ—çš„æ‰€æœ‰å…ƒç´  >>> b matrix([[ 1., 1.], [ 1., 1.]]) çŸ©é˜µçš„åˆå¹¶ >>>a=mat(ones((2,2))) >>> a matrix([[ 1., 1.], [ 1., 1.]]) >>>b=mat(eye(2)) >>> b matrix([[ 1., 0.], [ 0., 1.]]) >>>c=vstack((a,b)) #æŒ‰åˆ—åˆå¹¶ï¼Œå³å¢åŠ è¡Œæ•° >>> c matrix([[ 1., 1.], [ 1., 1.], [ 1., 0.], [ 0., 1.]]) >>>d=hstack((a,b)) #æŒ‰è¡Œåˆå¹¶ï¼Œå³è¡Œæ•°ä¸å˜ï¼Œæ‰©å±•åˆ—æ•° >>> d matrix([[ 1., 1., 1., 0.], [ 1., 1., 0., 1.]]) æ‰©å±•çŸ©é˜µå‡½æ•°tile() tile(inX, (i,j)) ;iæ˜¯æ‰©å±•ä¸ªæ•°ï¼Œjæ˜¯æ‰©å±•é•¿åº¦ >>>x=mat([0,0,0]) >>> x matrix([[0, 0, 0]]) >>> tile(x,(3,1)) #å³å°†xæ‰©å±•3ä¸ªï¼Œj=1,è¡¨ç¤ºå…¶åˆ—æ•°ä¸å˜ matrix([[0, 0, 0], [0, 0, 0], [0, 0, 0]]) >>> tile(x,(2,2)) #xæ‰©å±•2æ¬¡ï¼Œj=2,æ¨ªå‘æ‰©å±• matrix([[0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]]) Update timeï¼š 2020-05-25 "},"Chapter1/NumPy çº¿æ€§ä»£æ•°ä¸­çš„è¿ç®—.html":{"url":"Chapter1/NumPy çº¿æ€§ä»£æ•°ä¸­çš„è¿ç®—.html","title":"NumPy çº¿æ€§ä»£æ•°ä¸­çš„è¿ç®—","keywords":"","body":"NumPy çº¿æ€§ä»£æ•°ä¸­çš„è¿ç®— NumPy æä¾›äº†çº¿æ€§ä»£æ•°å‡½æ•°åº“ linalgï¼Œè¯¥åº“åŒ…å«äº†çº¿æ€§ä»£ æ•°æ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½ ã€‚ çŸ©é˜µå’Œå‘é‡ç§¯ numpy.dot() numpy.dot()å¯¹äºä¸¤ä¸ªä¸€ç»´çš„æ•°ç»„ï¼Œè®¡ç®—çš„æ˜¯è¿™ä¸¤ä¸ªæ•°ç»„å¯¹åº”ä¸‹æ ‡å…ƒç´ çš„ä¹˜ç§¯å’Œ(æ•°å­¦ä¸Šç§°ä¹‹ä¸ºå†…ç§¯)ï¼›å¯¹äºäºŒç»´æ•°ç»„ï¼Œè®¡ç®—çš„æ˜¯ä¸¤ä¸ªæ•°ç»„çš„çŸ©é˜µä¹˜ç§¯ï¼›å¯¹äºå¤šç»´æ•°ç»„ï¼Œå®ƒçš„é€šç”¨è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼Œå³ç»“æœæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ï¼šæ•°ç»„açš„æœ€åä¸€ç»´ä¸Šçš„æ‰€æœ‰å…ƒç´ ä¸æ•°ç»„bçš„å€’æ•°ç¬¬äºŒä½ä¸Šçš„æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯å’Œï¼š numpy.dot(a, b, out=None) å‚æ•°è¯´æ˜ï¼š a : ndarray æ•°ç»„ b : ndarray æ•°ç»„ out : ndarray, å¯é€‰ï¼Œç”¨æ¥ä¿å­˜dot()çš„è®¡ç®—ç»“æœ import numpy.matlib import numpy as np a = np.array([[1,2],[3,4]]) b = np.array([[11,12],[13,14]]) print(np.dot(a,b)) [[37 40] [85 92]] [[1*11+2*13, 1*12+2*14],[3*11+4*13, 3*12+4*14]] numpy.vdot() numpy.vdot() å‡½æ•°æ˜¯ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯ã€‚ å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¤æ•°ï¼Œé‚£ä¹ˆå®ƒçš„å…±è½­å¤æ•°ä¼šç”¨äºè®¡ç®—ã€‚ å¦‚æœå‚æ•°æ˜¯å¤šç»´æ•°ç»„ï¼Œå®ƒä¼šè¢«å±•å¼€ã€‚ è¯·æ³¨æ„ï¼Œvdotå¤„ç†å¤šç»´æ•°ç»„çš„æ–¹å¼ä¸dotä¸åŒï¼šä¸æ˜¯æ‰§è¡ŒçŸ©é˜µä¹˜ç§¯ï¼Œè€Œæ˜¯å…ˆå°†è¾“å…¥å‚æ•°å¹³é“ºåˆ°1-Då‘é‡ã€‚å› æ­¤ï¼Œå®ƒåº”è¯¥åªç”¨äºå‘é‡ã€‚ >>> a = np.array([1+2j,3+4j]) >>> b = np.array([5+6j,7+8j]) >>> np.vdot(a, b) (70-8j) >>> np.vdot(b, a) (70+8j) numpy.inner() ä¸¤ä¸ªæ•°ç»„çš„å†…ç§¯ã€‚ ç”¨äº1-Dæ•°ç»„ï¼ˆæ²¡æœ‰å¤å…±è½­ï¼‰çš„å‘é‡çš„æ™®é€šå†…ç§¯ï¼Œåœ¨è¾ƒé«˜ç»´åº¦ä¸Šæ˜¯æœ€åè½´ä¸Šçš„å’Œç§¯ã€‚ import numpy as np print (np.inner(np.array([1,2,3]),np.array([0,1,0]))) # ç­‰ä»·äº 1*0+2*1+3*0 å¤šç»´æ•°ç»„å®ä¾‹ import numpy as np a = np.array([[1,2], [3,4]]) print ('æ•°ç»„ aï¼š') print (a) æ•°ç»„ aï¼š [[1 2] [3 4]] b = np.array([[11, 12], [13, 14]]) print ('æ•°ç»„ bï¼š') print (b) æ•°ç»„ bï¼š [[11 12] [13 14]] print ('å†…ç§¯ï¼š') print (np.inner(a,b)) å†…ç§¯ï¼š [[35 41] [81 95]] å†…ç§¯è®¡ç®—å¼ä¸ºï¼š 1*11+2*12, 1*13+2*14 3*11+4*12, 3*13+4*14 çŸ©é˜µç‰¹å¾å€¼ numpy.linalg.eig numpy.linalg.eig(a) è®¡ç®—æ­£æ–¹å½¢æ•°ç»„çš„ç‰¹å¾å€¼å’Œå³ç‰¹å¾å‘é‡ã€‚ å‚æ•°ï¼š aï¼šï¼ˆ...ï¼ŒMï¼ŒMï¼‰æ•°ç»„ å°†è®¡ç®—ç‰¹å¾å€¼å’Œå³ç‰¹å¾å‘é‡çš„çŸ©é˜µ è¿”å›ï¼š wï¼šï¼ˆ...ï¼ŒMï¼‰æ•°ç»„ ç‰¹å¾å€¼ï¼Œæ¯ä¸ªæ ¹æ®å…¶å¤šé‡æ€§é‡å¤ã€‚ç‰¹å¾å€¼ä¸å¿…æ˜¯æœ‰åºçš„ã€‚ç»“æœæ•°ç»„å°†æ˜¯å¤æ‚ç±»å‹ï¼Œé™¤éè™šéƒ¨ä¸ºé›¶ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†è¢«è½¬æ¢ä¸ºå®æ•°ç±»å‹ã€‚å½“aæ˜¯å®æ•°æ—¶ï¼Œå¾—åˆ°çš„ç‰¹å¾å€¼å°†æ˜¯å®æ•°ï¼ˆ0è™šæ•°éƒ¨åˆ†ï¼‰æˆ–å‡ºç°åœ¨å…±è½­å¯¹ vï¼šï¼ˆ...ï¼ŒMï¼ŒMï¼‰æ•°ç»„ å½’ä¸€åŒ–ï¼ˆå•ä½â€œé•¿åº¦â€ï¼‰ç‰¹å¾å‘é‡ï¼Œä½¿å¾—åˆ—v[:,i]æ˜¯å¯¹åº”äºç‰¹å¾å€¼w[i] å½“æˆ‘ä»¬æƒ³è¦æ±‚è§£ä¸€ä¸ªéæ–¹é˜µçš„å¥‡å¼‚å€¼ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŠŠè¿™ä¸ªçŸ©é˜µè½¬æ¢ä¸ºæ–¹é˜µã€‚ >>> from numpy import * >>> import numpy as np >>> A = mat([[4,5,6],[1,2,3]]) >>> U = A*A.T >>> lamda,hU=linalg.eig(U) >>> sigma=sqrt(lamda) >>> print sigma [9.508032 0.77286964] åœ¨å¼€å¤´å…ˆè¿›è¡ŒçŸ©é˜µçš„ä¹˜æ³•ï¼ŒæŠŠçŸ©é˜µå’ŒçŸ©é˜µçš„è½¬ç½®ç›¸ä¹˜ï¼Œå¾—åˆ°ä¸€ä¸ªæ–¹é˜µï¼Œç„¶åè¿™ä¸ªæ–¹é˜µä½œä¸ºå‚æ•°ï¼Œå¯ä»¥å¾—åˆ°ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ã€‚ å…¶ä¸­è¿”å›çš„ç¬¬ä¸€ä¸ªå€¼wè¿›è¡Œå¼€æ ¹å·å°±æ˜¯dataè¿™ä¸ªçŸ©é˜µçš„å¥‡å¼‚å€¼ã€‚ å¯ä»¥ç”¨svdå‡½æ•°æ¥éªŒè¯ä¸€ä¸‹ã€‚ >>> Q,S,VT=linalg.svd(A) >>> print S [9.508032 0.77286964] å‚è€ƒï¼š numpy.linalg,eig(a)å‡½æ•° numpy.linalg.solve() numpy.linalg.solve(a,b)å‡½æ•°ç»™å‡ºäº†çŸ©é˜µå½¢å¼çš„çº¿æ€§æ–¹ç¨‹çš„è§£ã€‚ è®¡ç®—è‰¯å¥½ç¡®å®šçš„ï¼Œå³æ»¡ç§©çº¿æ€§çŸ©é˜µæ–¹ç¨‹ax = bçš„â€œç²¾ç¡®â€è§£ï¼Œxã€‚ aï¼šï¼ˆ...ï¼ŒMï¼ŒMï¼‰array_like ç³»æ•°çŸ©é˜µã€‚ bï¼š{ï¼ˆ...ï¼ŒMï¼Œï¼‰ï¼Œï¼ˆ...ï¼ŒMï¼ŒKï¼‰}ï¼Œarray_like çºµåæ ‡æˆ–â€œå› å˜é‡â€å€¼ã€‚ è¿”å›ï¼š xï¼š{ï¼ˆ...ï¼ŒMï¼Œï¼‰ï¼Œï¼ˆ...ï¼ŒMï¼ŒKï¼‰} ndarray a x = bã€‚è¿”å›å½¢çŠ¶ä¸bç›¸åŒã€‚ æ±‚è§£æ–¹ç¨‹ 3 * x0 + x1 = 9å’Œ x0 + 2 x1 = 8 >>> a = np.array([[3,1], [1,2]]) >>> b = np.array([9,8]) >>> x = np.linalg.solve(a, b) >>> x array([ 2., 3.]) numpy.linalg.inv() numpy.linalg.inv(a) å‡½æ•°è®¡ç®—çŸ©é˜µçš„ä¹˜æ³•é€†çŸ©é˜µã€‚ é€†çŸ©é˜µï¼ˆinverse matrixï¼‰ï¼šè®¾Aæ˜¯æ•°åŸŸä¸Šçš„ä¸€ä¸ªné˜¶çŸ©é˜µï¼Œè‹¥åœ¨ç›¸åŒæ•°åŸŸä¸Šå­˜åœ¨å¦ä¸€ä¸ªné˜¶çŸ©é˜µBï¼Œä½¿å¾—ï¼š AB=BA=E ï¼Œåˆ™æˆ‘ä»¬ç§°Bæ˜¯Açš„é€†çŸ©é˜µï¼Œè€ŒAåˆ™è¢«ç§°ä¸ºå¯é€†çŸ©é˜µã€‚æ³¨ï¼šEä¸ºå•ä½çŸ©é˜µã€‚ import numpy as np a = np.array([[1,1,1],[0,2,5],[2,5,-1]]) print ('æ•°ç»„ aï¼š') print (a) æ•°ç»„ aï¼š [[ 1 1 1] [ 0 2 5] [ 2 5 -1]] ainv = np.linalg.inv(a) print ('a çš„é€†ï¼š') print (ainv) a çš„é€†ï¼š [[ 1.28571429 -0.28571429 -0.14285714] [-0.47619048 0.14285714 0.23809524] [ 0.19047619 0.14285714 -0.0952381 ]] print ('çŸ©é˜µ bï¼š') b = np.array([[6],[-4],[27]]) print (b) çŸ©é˜µ bï¼š [[ 6] [-4] [27]] print ('è®¡ç®—ï¼šA^(-1)Bï¼š') x = np.linalg.solve(a,b) print (x) è®¡ç®—ï¼šA^(-1)Bï¼š [[ 5.] [ 3.] [-2.]] # è¿™å°±æ˜¯çº¿æ€§æ–¹å‘ x = 5, y = 3, z = -2 çš„è§£ çŸ©é˜µåˆ†è§£ numpy.linalg.svdå‡½æ•° å¥‡å¼‚å€¼åˆ†è§£ å‡½æ•°ï¼šnp.linalg.svd(a,full_matrices=1,compute_uv=1) å‚æ•°ï¼š a æ˜¯ä¸€ä¸ªå½¢å¦‚(M,N)çŸ©é˜µ full_matrices çš„å–å€¼æ˜¯ä¸º0æˆ–è€…1ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œè¿™æ—¶uçš„å¤§å°ä¸º(M,M)ï¼Œvçš„å¤§å°ä¸º(N,N) ã€‚å¦åˆ™uçš„å¤§å°ä¸º(M,K)ï¼Œvçš„å¤§å°ä¸º(K,N) ï¼ŒK=min(M,N)ã€‚ compute_uv çš„å–å€¼æ˜¯ä¸º0æˆ–è€…1ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œè¡¨ç¤ºè®¡ç®—u,s,vã€‚ä¸º0çš„æ—¶å€™åªè®¡ç®—sã€‚ è¿”å› æ€»å…±æœ‰ä¸‰ä¸ªè¿”å›å€¼u,s,v uå¤§å°ä¸º(M,M)ï¼Œså¤§å°ä¸º(M,N)ï¼Œvå¤§å°ä¸º(N,N)ã€‚ A = usv å…¶ä¸­sæ˜¯å¯¹çŸ©é˜µaçš„å¥‡å¼‚å€¼åˆ†è§£ã€‚sé™¤äº†å¯¹è§’å…ƒç´ ä¸ä¸º0ï¼Œå…¶ä»–å…ƒç´ éƒ½ä¸º0ï¼Œå¹¶ä¸”å¯¹è§’å…ƒç´ ä»å¤§åˆ°å°æ’åˆ—ã€‚sä¸­æœ‰nä¸ªå¥‡å¼‚å€¼ï¼Œä¸€èˆ¬æ’åœ¨åé¢çš„æ¯”è¾ƒæ¥è¿‘0ï¼Œæ‰€ä»¥ä»…ä¿ç•™æ¯”è¾ƒå¤§çš„rä¸ªå¥‡å¼‚å€¼ã€‚ >>> from numpy import * >>> data = mat([[1,2,3],[4,5,6]]) >>> U,sigma,VT = np.linalg.svd(data) >>> print U [[-0.3863177 -0.92236578] [-0.92236578 0.3863177 ]] >>> print sigma [9.508032 0.77286964] >>> print VT [[-0.42866713 -0.56630692 -0.7039467 ] [ 0.80596391 0.11238241 -0.58119908] [ 0.40824829 -0.81649658 0.40824829]] æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š python ä¸­çš„ svd åˆ†è§£å¾—åˆ°çš„ VT å°±æ˜¯ V çš„è½¬ç½®ï¼Œè¿™ä¸€ç‚¹ä¸matlabä¸­ä¸ä¸€æ ·ï¼Œmatlabä¸­svdåå¾—åˆ°çš„æ˜¯Vï¼Œå¦‚æœè¦è¿˜åŸçš„è¯è¿˜éœ€è¦å°†Vè½¬ç½®ä¸€æ¬¡ï¼Œè€ŒPythonä¸­ä¸éœ€è¦ã€‚ Python ä¸­ svd åå¾—åˆ°çš„sigmaæ˜¯ä¸€ä¸ªè¡Œå‘é‡ï¼ŒPythonä¸­ä¸ºäº†èŠ‚çœç©ºé—´åªä¿ç•™äº†Açš„å¥‡å¼‚å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†å®ƒè¿˜åŸä¸ºå¥‡å¼‚å€¼çŸ©é˜µã€‚åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯”å¦‚ä¸€ä¸ª5*5å¤§å°çš„çŸ©é˜µçš„å¥‡å¼‚å€¼åªæœ‰ä¸¤ä¸ªï¼Œä½†æ˜¯ä»–çš„å¥‡å¼‚å€¼çŸ©é˜µåº”è¯¥æ˜¯5*5çš„ï¼Œæ‰€ä»¥åé¢çš„æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è¡¥é›¶ï¼Œå¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨diagå°†sigmaå¯¹è§’åŒ–ã€‚ å…³äºå¥‡å¼‚å€¼çš„è§£é‡Šï¼š numpy.linalg.det() numpy.linalg.det() å‡½æ•°è®¡ç®—è¾“å…¥çŸ©é˜µçš„è¡Œåˆ—å¼ã€‚ è¡Œåˆ—å¼åœ¨çº¿æ€§ä»£æ•°ä¸­æ˜¯éå¸¸æœ‰ç”¨çš„å€¼ã€‚ å®ƒä»æ–¹é˜µçš„å¯¹è§’å…ƒç´ è®¡ç®—ã€‚ å¯¹äº 2Ã—2 çŸ©é˜µï¼Œå®ƒæ˜¯å·¦ä¸Šå’Œå³ä¸‹å…ƒç´ çš„ä¹˜ç§¯ä¸å…¶ä»–ä¸¤ä¸ªçš„ä¹˜ç§¯çš„å·®ã€‚ æ¢å¥è¯è¯´ï¼Œå¯¹äºçŸ©é˜µ[[aï¼Œb]ï¼Œ[cï¼Œd]]ï¼Œè¡Œåˆ—å¼è®¡ç®—ä¸º ad-bcã€‚ è¾ƒå¤§çš„æ–¹é˜µè¢«è®¤ä¸ºæ˜¯ 2Ã—2 çŸ©é˜µçš„ç»„åˆã€‚ import numpy as np a = np.array([[1,2], [3,4]]) print (np.linalg.det(a)) -2.0 import numpy as np b = np.array([[6,1,1], [4, -2, 5], [2,8,7]]) print (b) print (np.linalg.det(b)) print (6*(-2*7 - 5*8) - 1*(4*7 - 5*2) + 1*(4*8 - -2*2)) [[ 6 1 1] [ 4 -2 5] [ 2 8 7]] -306.0 -306 Update timeï¼š 2020-05-25 "},"Chapter1/NumPy é™ç»´å’Œå¢ç»´.html":{"url":"Chapter1/NumPy é™ç»´å’Œå¢ç»´.html","title":"NumPy é™ç»´å’Œå¢ç»´","keywords":"","body":"NumPy é™ç»´å’Œå¢ç»´ np.newaxis newaxis è¡¨ç¤ºå¢åŠ ä¸€ä¸ªæ–°çš„å æ ‡è½´ import numpy as np a = np.array([1,2,3]) print (a.shape,'\\n',a) ç»“æœä¸ºï¼š (3,) [1 2 3] a = np.array([1,2,3])[:,np.newaxis] print (a.shape,'\\n',a) (3, 1) [[1] [2] [3]] å’Œç¬¬ä¸€ä¸ªç¨‹åºç›¸æ¯”ï¼Œaçš„shapeä¸ºï¼ˆ3ï¼Œï¼‰ç°åœ¨ä¸ºï¼ˆ3ï¼Œ1ï¼‰å˜ä¸ºäºŒç»´æ•°ç»„äº† a = np.array([1,2,3])[np.newaxis,:] print (a.shape,'\\n',a) è¾“å‡ºç»“æœä¸ºï¼š (1, 3) [[1 2 3]] è¿™ä¸ªå’Œç¬¬äºŒä¸ªç›¸æ¯”ï¼Œå¥½åƒå’Œä»–æ˜¯åçš„ï¼Œç›¸å½“äºè½¬ç½®äº†ï¼Œè¿™æ˜¯å› ä¸ºå’Œ[np.newaxis,:] è¿™ä¸ªåœ°æ–¹np.newaxis æ”¾çš„ä½ç½®æœ‰å…³ï¼Œç¬¬äºŒä¸ªç¨‹åºæ”¾åœ¨[:,]çš„åé¢ï¼Œç›¸å½“äºåœ¨åŸæ¥çš„åé¢å¢åŠ ä¸€ä¸ªç»´åº¦ï¼Œæ‰€ä»¥å˜ä¸º(3,1)ï¼Œè€Œç¬¬ä¸‰ä¸ªåˆ™æ”¾åœ¨å‰é¢ï¼Œåˆ™ä¸º(1,3)ã€‚æ”¾åœ¨å‰é¢æ˜¯å…ˆé€—å·ï¼Œå†å†’å·ï¼Œè€Œæ”¾åœ¨åé¢æ˜¯å…ˆå†’å·åœ¨é€—å·ï¼Œä¸è¦å¼„é”™äº†ï¼ŒåŒæ—¶è®°å¾—æ˜¯ä¸­æ‹¬å·æ‰©èµ·æ¥ï¼Œä¸æ˜¯å°æ‹¬å·ã€‚ ravel()ã€flatten()ã€squeeze() numpyä¸­çš„ravel()ã€flatten()ã€squeeze()éƒ½æœ‰å°†å¤šç»´æ•°ç»„è½¬æ¢ä¸ºä¸€ç»´æ•°ç»„çš„åŠŸèƒ½ï¼ŒåŒºåˆ«ï¼š ravel()ï¼šå¦‚æœæ²¡æœ‰å¿…è¦ï¼Œä¸ä¼šäº§ç”Ÿæºæ•°æ®çš„å‰¯æœ¬ flatten()ï¼šè¿”å›æºæ•°æ®çš„å‰¯æœ¬ squeeze()ï¼šåªèƒ½å¯¹ç»´æ•°ä¸º1çš„ç»´åº¦é™ç»´ numpy.ravel(a, order='C') numpy.ravel() vs numpy.flatten() é¦–å…ˆå£°æ˜ä¸¤è€…æ‰€è¦å®ç°çš„åŠŸèƒ½æ˜¯ä¸€è‡´çš„ï¼ˆå°†å¤šç»´æ•°ç»„é™ä½ä¸€ç»´ï¼‰ï¼Œä¸¤è€…çš„åŒºåˆ«åœ¨äºè¿”å›æ‹·è´ï¼ˆcopyï¼‰è¿˜æ˜¯è¿”å›è§†å›¾ï¼ˆviewï¼‰. numpy.flatten() è¿”å›ä¸€ä»½æ‹·è´ï¼Œå¯¹æ‹·è´æ‰€åšçš„ä¿®æ”¹ä¸ä¼šå½±å“ï¼ˆreflectsï¼‰åŸå§‹çŸ©é˜µï¼Œè€Œnumpy.ravel() è¿”å›çš„æ˜¯è§†å›¾ï¼ˆviewï¼Œä¹Ÿé¢‡æœ‰å‡ åˆ†C/C++å¼•ç”¨referenceçš„æ„å‘³ï¼‰ï¼Œä¼šå½±å“ï¼ˆreflectsï¼‰åŸå§‹çŸ©é˜µã€‚ Update timeï¼š 2020-05-25 "},"Chapter1/Numpyä¸­reshapeå‡½æ•°.html":{"url":"Chapter1/Numpyä¸­reshapeå‡½æ•°.html","title":"Numpyä¸­reshapeå‡½æ•°","keywords":"","body":"Numpyä¸­reshapeå‡½æ•° ä¸€èˆ¬ç”¨æ³•ï¼šnumpy.arange(n).reshape(a, b); ä¾æ¬¡ç”Ÿæˆnä¸ªè‡ªç„¶æ•°ï¼Œå¹¶ä¸”ä»¥aè¡Œbåˆ—çš„æ•°ç»„å½¢å¼æ˜¾ç¤º: In [1]: np.arange(16).reshape(2,8) #ç”Ÿæˆ16ä¸ªè‡ªç„¶æ•°ï¼Œä»¥2è¡Œ8åˆ—çš„å½¢å¼æ˜¾ç¤º Out[1]: array([[ 0, 1, 2, 3, 4, 5, 6, 7], [ 8, 9, 10, 11, 12, 13, 14, 15]]) ç‰¹æ®Šç”¨æ³•: mat (or array).reshape(c, -1); å¿…é¡»æ˜¯çŸ©é˜µæ ¼å¼æˆ–è€…æ•°ç»„æ ¼å¼ï¼Œæ‰èƒ½ä½¿ç”¨.reshape(c, -1)å‡½æ•°ï¼Œ è¡¨ç¤ºå°†æ­¤çŸ©é˜µæˆ–è€…æ•°ç»„é‡ç»„ï¼Œä»¥ cè¡Œdåˆ—çš„å½¢å¼è¡¨ç¤ºï¼ˆ-1çš„ä½œç”¨å°±åœ¨æ­¤ï¼Œè‡ªåŠ¨è®¡ç®—dï¼šd=æ•°ç»„æˆ–è€…çŸ©é˜µé‡Œé¢æ‰€æœ‰çš„å…ƒç´ ä¸ªæ•°/c, då¿…é¡»æ˜¯æ•´æ•°ï¼Œä¸ç„¶æŠ¥é”™ï¼‰ï¼ˆreshape(-1, e) å³åˆ—æ•°å›ºå®šï¼Œè¡Œæ•°éœ€è¦è®¡ç®—ï¼‰ï¼š In [2]: arr=np.arange(16).reshape(2,8) out[2]: In [3]: arr out[3]: array([[ 0, 1, 2, 3, 4, 5, 6, 7], [ 8, 9, 10, 11, 12, 13, 14, 15]]) In [4]: arr.reshape(4,-1) #å°†arrå˜æˆ4è¡Œçš„æ ¼å¼ï¼Œåˆ—æ•°è‡ªåŠ¨è®¡ç®—çš„(c=4, d=16/4=4) out[4]: array([[ 0, 1, 2, 3], [ 4, 5, 6, 7], [ 8, 9, 10, 11], [12, 13, 14, 15]]) In [5]: arr.reshape(8,-1) #å°†arrå˜æˆ8è¡Œçš„æ ¼å¼ï¼Œåˆ—æ•°è‡ªåŠ¨è®¡ç®—çš„(c=8, d=16/8=2) out[5]: array([[ 0, 1], [ 2, 3], [ 4, 5], [ 6, 7], [ 8, 9], [10, 11], [12, 13], [14, 15]]) In [6]: arr.reshape(10,-1) #å°†arrå˜æˆ10è¡Œçš„æ ¼å¼ï¼Œåˆ—æ•°è‡ªåŠ¨è®¡ç®—çš„(c=10, d=16/10=1.6 != Int) out[6]: ValueError: cannot reshape array of size 16 into shape (10,newaxis) Update timeï¼š 2020-05-25 "},"Chapter1/Numpy squeezeå‡½æ•°.html":{"url":"Chapter1/Numpy squeezeå‡½æ•°.html","title":"Numpy squeeze()å‡½æ•°","keywords":"","body":"Numpy squeeze()å‡½æ•° è¯­æ³•ï¼šnumpy.squeeze(a,axis = None) 1ï¼‰a è¡¨ç¤ºè¾“å…¥çš„æ•°ç»„ï¼› 2ï¼‰axis ç”¨äºæŒ‡å®šéœ€è¦åˆ é™¤çš„ç»´åº¦ï¼Œä½†æ˜¯æŒ‡å®šçš„ç»´åº¦å¿…é¡»ä¸ºå•ç»´åº¦ï¼Œå¦åˆ™å°†ä¼šæŠ¥é”™ï¼› 3ï¼‰axisçš„å–å€¼å¯ä¸ºNone æˆ– int æˆ– tuple of ints, å¯é€‰ã€‚è‹¥axisä¸ºç©ºï¼Œåˆ™åˆ é™¤æ‰€æœ‰å•ç»´åº¦çš„æ¡ç›®ï¼› 4ï¼‰è¿”å›å€¼ï¼š æ•°ç»„ 5) ä¸ä¼šä¿®æ”¹åŸæ•°ç»„ï¼› ä½œç”¨ï¼šä»æ•°ç»„çš„å½¢çŠ¶ä¸­åˆ é™¤å•ç»´åº¦æ¡ç›®ï¼Œå³æŠŠshapeä¸­ä¸º1çš„ç»´åº¦å»æ‰ åœºæ™¯ï¼šåœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­ï¼Œé€šå¸¸ç®—æ³•çš„ç»“æœæ˜¯å¯ä»¥è¡¨ç¤ºå‘é‡çš„æ•°ç»„ï¼ˆå³åŒ…å«ä¸¤å¯¹æˆ–ä»¥ä¸Šçš„æ–¹æ‹¬å·å½¢å¼[[]]ï¼‰ï¼Œå¦‚æœç›´æ¥åˆ©ç”¨è¿™ä¸ªæ•°ç»„è¿›è¡Œç”»å›¾å¯èƒ½æ˜¾ç¤ºç•Œé¢ä¸ºç©ºï¼ˆè§åé¢çš„ç¤ºä¾‹ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨squeezeï¼ˆï¼‰å‡½æ•°å°†è¡¨ç¤ºå‘é‡çš„æ•°ç»„è½¬æ¢ä¸ºç§©ä¸º1çš„æ•°ç»„ï¼Œè¿™æ ·åˆ©ç”¨matplotlibåº“å‡½æ•°ç”»å›¾æ—¶ï¼Œå°±å¯ä»¥æ­£å¸¸çš„æ˜¾ç¤ºç»“æœäº†ã€‚ ç¤ºä¾‹ In [16]: import numpy as np In [17]: a = np.arange(10).reshape(1,10) In [18]: a Out[18]: array([[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]]) In [19]: a.shape Out[19]: (1, 10) In [20]: b = np.squeeze(a)^M ...: b Out[20]: array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]) In [21]: b.shape Out[21]: (10,) In [22]: c = np.arange(10).reshape(2,5)^M ...: c Out[22]: array([[0, 1, 2, 3, 4], [5, 6, 7, 8, 9]]) In [23]: np.squeeze(c) Out[23]: array([[0, 1, 2, 3, 4], [5, 6, 7, 8, 9]]) In [24]: d = np.arange(10).reshape(1,2,5)^M ...: d Out[24]: array([[[0, 1, 2, 3, 4], [5, 6, 7, 8, 9]]]) In [25]: d.shape Out[25]: (1, 2, 5) In [26]: np.squeeze(d) Out[26]: array([[0, 1, 2, 3, 4], [5, 6, 7, 8, 9]]) In [27]: np.squeeze(d).shape Out[27]: (2, 5) np.squeeze()å‡½æ•°å¯ä»¥åˆ é™¤æ•°ç»„å½¢çŠ¶ä¸­çš„å•ç»´åº¦æ¡ç›®ï¼Œå³æŠŠshapeä¸­ä¸º1çš„ç»´åº¦å»æ‰ï¼Œä½†æ˜¯å¯¹éå•ç»´çš„ç»´åº¦ä¸èµ·ä½œç”¨ã€‚ matplotlibç”»å›¾ç¤ºä¾‹ å‚è€ƒ squeeze()å‡½æ•° Update timeï¼š 2020-05-25 "},"Chapter1/Numpy randoméšæœºå‡½æ•°.html":{"url":"Chapter1/Numpy randoméšæœºå‡½æ•°.html","title":"Numpy randomå‡½æ•°","keywords":"","body":"Numpy randomå‡½æ•° numpy.random.RandomState() numpy.random.RandomState() æ˜¯ä¸€ä¸ªä¼ªéšæœºæ•°ç”Ÿæˆå™¨ã€‚ ä¼ªéšæœºæ•°æ˜¯ç”¨ç¡®å®šæ€§çš„ç®—æ³•è®¡ç®—å‡ºæ¥çš„ä¼¼æ¥è‡ª[0,1]å‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°åºåˆ—ã€‚å¹¶ä¸çœŸæ­£çš„éšæœºï¼Œä½†å…·æœ‰ç±»ä¼¼äºéšæœºæ•°çš„ç»Ÿè®¡ç‰¹ å¾ï¼Œå¦‚å‡åŒ€æ€§ã€ç‹¬ç«‹æ€§ç­‰ã€‚ import numpy as np rng = np.random.RandomState(0) rng.rand(4) # Out[377]: array([0.5488135 , 0.71518937, 0.60276338, 0.54488318]) rng = np.random.RandomState(0) rng.rand(4) # Out[379]: array([0.5488135 , 0.71518937, 0.60276338, 0.54488318]) 0ä¸ºéšæœºç§å­ï¼Œåªè¦éšæœºç§å­seedç›¸åŒï¼Œäº§ç”Ÿçš„éšæœºæ•°åºåˆ—å°±ç›¸åŒ å› ä¸ºæ˜¯ä¼ªéšæœºæ•°ï¼Œæ‰€ä»¥å¿…é¡»åœ¨ rng è¿™ä¸ªå˜é‡ä¸‹ä½¿ç”¨ï¼Œå¦‚æœä¸è¿™æ ·åšï¼Œé‚£ä¹ˆå°±å¾—ä¸åˆ°ç›¸åŒçš„éšæœºæ•°ç»„äº†,å³ä¾¿ä½ å†æ¬¡è¾“å…¥äº†numpy.random.RandomState()ï¼š prng = np.random.RandomState(123456789) # å®šä¹‰å±€éƒ¨ç§å­ prng.rand(2, 4) prng.chisquare(1, size=(2, 2)) # å¡æ–¹åˆ†å¸ƒ prng.standard_t(1, size=(2, 3)) # t åˆ†å¸ƒ prng.poisson(5, size=10) # æ³Šæ¾åˆ†å¸ƒ numpy.random.seed() ç”Ÿæˆéšæœºæ•°çš„ç§å­ï¼Œä½¿å¾—æ¯æ¬¡ç”Ÿæˆéšæœºæ•°ç›¸åŒ np.random.seed() çš„ä½œç”¨ï¼šä½¿å¾—éšæœºæ•°æ®å¯é¢„æµ‹ã€‚ å½“æˆ‘ä»¬è®¾ç½®ç›¸åŒçš„seedï¼Œæ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°ç›¸åŒã€‚å¦‚æœä¸è®¾ç½®seedï¼Œåˆ™æ¯æ¬¡ä¼šç”Ÿæˆä¸åŒçš„ éšæœºæ•°seed( ) ç”¨äºæŒ‡å®šéšæœºæ•°ç”Ÿæˆæ—¶æ‰€ç”¨ç®—æ³•å¼€å§‹çš„æ•´æ•°å€¼ï¼Œå¦‚æœä½¿ç”¨ç›¸åŒçš„seed( )å€¼ï¼Œ åˆ™æ¯æ¬¡ç”Ÿæˆçš„éšå³æ•°éƒ½ç›¸åŒï¼Œå¦‚æœä¸è®¾ç½®è¿™ä¸ªå€¼ï¼Œåˆ™ç³»ç»Ÿæ ¹æ®æ—¶é—´æ¥è‡ªå·±é€‰æ‹©è¿™ä¸ªå€¼ï¼Œ æ­¤æ—¶æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°å› æ—¶é—´å·®å¼‚è€Œä¸åŒã€‚ In [26]: np.random.seed(0) ...: np.random.rand(5) ...: Out[26]: array([ 0.5488135 , 0.71518937, 0.60276338, 0.54488318, 0.4236548 ]) #ä¸åŒçš„éšæœºæ•°ç§å­ä¸‹çš„randç”Ÿæˆçš„éšæœºæ•°ç»„çš„å€¼ä¸ç­‰ In [27]: np.random.seed(1000) ...: np.random.rand(5) ...: Out[27]: array([ 0.65358959, 0.11500694, 0.95028286, 0.4821914 , 0.87247454]) #ç»§ç»­è¾“å…¥éšæœºç§å­ä¸º1000ä¸‹ç”Ÿæˆçš„éšæœºæ•°ç»„ In [29]: np.random.seed(1000) ...: np.random.rand(5) ...: Out[29]: array([ 0.65358959, 0.11500694, 0.95028286, 0.4821914 , 0.87247454]) from numpy import * num=0 while(num random.seed(something) åªèƒ½æ˜¯ä¸€æ¬¡æœ‰æ•ˆã€‚ numpy.random.rand() numpy.random.rand(d0,d1...dn)\\ rand å‡½æ•°æ ¹æ®ç»™å®šç»´åº¦ç”ŸæˆåŠå¼€åŒºé—´ [0,1)ä¹‹é—´çš„æ•°æ®ï¼ŒåŒ…å«0ï¼Œä¸åŒ…å«1 dn è¡¨ç¤ºæ¯ä¸ªç»´åº¦ è¿”å›å€¼ä¸ºæŒ‡å®šçº¬åº¦çš„ numpy.ndarray >>> np.random.rand(3, 3) # shape: 3*3 array([[0.94340617, 0.96183216, 0.88510322], [0.44543261, 0.74930098, 0.73372814], [0.29233667, 0.3940114 , 0.7167332 ]]) from numpy import random x = random.rand(2, 3) print(x) [[ 0.1169922 0.08614147 0.17997144] [ 0.5694889 0.43067372 0.62135592]] x, y = random.rand(2, 3) print(x) print(y) [ 0.60527337 0.78765269 0.71884661] [ 0.67420571 0.946359 0.7632273 ] numpy.random.randint() randint(low[, high, size, dtype]) ä»åŒºé—´[low,highï¼‰è¿”å›éšæœºæ•´å½¢ å‚æ•°ï¼šlowä¸ºæœ€å°å€¼ï¼Œhighä¸ºæœ€å¤§å€¼ï¼Œsizeä¸ºæ•°ç»„ç»´åº¦å¤§å°ï¼Œdtypeä¸ºæ•°æ®ç±»å‹ï¼Œé»˜è®¤çš„- æ•°æ®ç±»å‹æ˜¯np.int highæ²¡æœ‰å¡«å†™æ—¶ï¼Œé»˜è®¤ç”Ÿæˆéšæœºæ•°çš„èŒƒå›´æ˜¯[0ï¼Œlow) raw_user_item_mat = np.random.randint(0, 10, size=(3,4)) #æŒ‡å®šç”Ÿæˆéšæœºæ•°èŒƒå›´å’Œç”Ÿæˆçš„å¤šç»´æ•°ç»„å¤§å° print(raw_user_item_mat) [[2 1 3 6] [8 9 1 6] [7 0 1 8]] >>> np.random.randint(1, size = 10) # è¿”å›[0, 1)ä¹‹é—´çš„æ•´æ•°ï¼Œæ‰€ä»¥åªæœ‰0 array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0]) >>> np.random.randint(1, 5) # è¿”å›[1, 5)ä¹‹é—´éšæœºçš„ä¸€ä¸ªæ•°å­— 2 np.random.randn() numpy.random.randn(d0,d1,â€¦,dn) randn å‡½æ•°è¿”å›ä¸€ä¸ªæˆ–ä¸€ç»„æ ·æœ¬ï¼Œå…·æœ‰æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚ dn è¡¨ç¤ºæ¯ä¸ªç»´åº¦ è¿”å›å€¼ä¸ºæŒ‡å®šç»´åº¦çš„ numpy.ndarray æ•°ç»„å…ƒç´ æ¥ç¬¦åˆæ ‡å‡†æ­£æ€åˆ†å¸ƒN(0,1) >>> np.random.randn() # å½“æ²¡æœ‰è¾“å…¥å‚æ•°æ—¶ï¼Œä»…è¿”å›ä¸€ä¸ªå€¼ -0.7377941002942127 >>> np.random.randn(3, 3) array([[-0.20565666, 1.23580939, -0.27814622], [ 0.53923344, -2.7092927 , 1.27514363], [ 0.38570597, -1.90564739, -0.10438987]]) >>> np.random.randn(3, 3, 3) array([[[ 0.64235451, -1.64327647, -1.27366899], [ 0.69706885, 0.75246699, 2.16235763], [ 1.01141338, -0.19188666, 0.07684428]], [[ 1.34367043, -0.76837057, 0.27803575], [ 0.97007349, 0.41297538, -1.65008923], [-3.78282033, 0.67567421, -0.0753552 ]], [[-0.86540385, 0.14603592, 0.29318291], [-0.8167798 , -0.25492782, -0.58758 ], [ 0.02612474, 0.17882535, -0.95483945]]]) æ ‡å‡†æ­£æ€åˆ†å¸ƒâ€”-standard normal distributionï¼›æ ‡å‡†æ­£æ€åˆ†å¸ƒåˆç§°ä¸ºuåˆ†å¸ƒï¼Œæ˜¯ä»¥0ä¸ºå‡å€¼ã€ä»¥1ä¸ºæ ‡å‡†å·®çš„æ­£æ€åˆ†å¸ƒï¼Œè®°ä¸ºNï¼ˆ0ï¼Œ1ï¼‰ã€‚ numpy.random.choice() numpy.random.choice(a, size=None, replace=True, p=None) ä»ç»™å®šçš„ä¸€ä½æ•°ç»„ä¸­ç”Ÿæˆä¸€ä¸ªéšæœºæ ·æœ¬ aè¦æ±‚è¾“å…¥ä¸€ç»´æ•°ç»„ç±»ä¼¼æ•°æ®æˆ–è€…æ˜¯ä¸€ä¸ªintï¼›sizeæ˜¯ç”Ÿæˆçš„æ•°ç»„çº¬åº¦ï¼Œè¦æ±‚æ•°å­—æˆ–å…ƒç»„ï¼›replaceä¸ºå¸ƒå°”å‹ï¼Œå†³å®šæ ·æœ¬æ˜¯å¦æœ‰æ›¿æ¢ï¼›pä¸ºæ ·æœ¬å‡ºç°æ¦‚ç‡,pä¸­æ¦‚ç‡å’Œå¿…é¡»ä¸º1ã€‚ #aä¸ºæ•´æ•°æ—¶ï¼Œå¯¹åº”çš„ä¸€ç»´æ•°ç»„æ˜¯np.arange(a) #ç¬¬ä¸€ä¸ªå‚æ•°å€¼5å¯¹åº”çš„a,å³ä¼ å…¥çš„æ•°æ®ç»„ #ç¬¬äºŒä¸ªå‚æ•°3å°±æ˜¯æ•°ç»„çš„sizeï¼Œä¼ å…¥å•å€¼æ—¶ï¼Œæ•°æ®ç»´åº¦æ˜¯ä¸€ç»´çš„ #æ­¤å¤„å°†ç”Ÿæˆä¸€ä¸ªä¸€ç»´æ•°æ®åŒ…å«3ä¸ªå°äº5çš„æ•´æ•°çš„æ•°ç»„ In [18]: np.random.choice(5,3) Out[18]: array([2, 0, 3]) #ç»™æ•°ç»„ä¸­æ¯ä¸ªæ•°æ®å‡ºç°çš„æ¦‚ç‡èµ‹å€¼ In [19]: np.random.choice(5, 3, p=[0.1, 0, 0.3, 0.6, 0]) Out[19]: array([3, 3, 0], dtype=int64) #repalceå‚æ•°ä¸ºæ˜¯å¦å¯ä»¥é‡å¤ï¼Œå½“è®¾ç½®ä¸ºFALSEæ—¶ï¼Œä¸èƒ½å‡ºç°é‡å¤çš„æ•°æ® In [21]: np.random.choice(5, 4, replace=False) Out[21]: array([3, 2, 1, 4]) In [22]: np.random.choice(5, 5, replace=False) Out[22]: array([4, 0, 3, 1, 2]) In [23]: np.random.choice(5, 3, replace=False, p=[0.1, 0, 0.3, 0.6, 0]) Out[23]: array([3, 0, 2]) #ä¹Ÿå¯ä»¥ä¼ å…¥éæ•°å­—ã€å­—ç¬¦ä¸²çš„æ•°ç»„ In [24]: demo_list = ['lenovo', 'sansumg','moto','xiaomi', 'iphone'] In [25]: np.random.choice(demo_list,size=(3,3)) Out[25]: array([['lenovo', 'sansumg', 'sansumg'], ['sansumg', 'iphone', 'iphone'], ['lenovo', 'lenovo', 'xiaomi']], dtype=' æ‰“ä¹±éšæœºæ’åˆ— np.random.shuffle(x) åœ¨åŸæ•°ç»„ä¸Šè¿›è¡Œï¼Œæ”¹å˜è‡ªèº«åºåˆ—ï¼Œæ— è¿”å›å€¼ã€‚ import numpy as np arr = np.arange(10) print(arr) np.random.shuffle(arr) print(arr) [0 1 2 3 4 5 6 7 8 9] [5 6 9 7 3 2 8 4 1 0] å¯¹å¤šç»´æ•°ç»„è¿›è¡Œæ‰“ä¹±æ’åˆ—æ—¶ï¼Œé»˜è®¤æ˜¯åˆ—ç»´åº¦ã€‚ arr=np.arange(12).reshape(3,4) print(arr) print('******') np.random.shuffle(arr) print(arr) [[ 0 1 2 3] [ 4 5 6 7] [ 8 9 10 11]] ****** [[ 8 9 10 11] [ 0 1 2 3] [ 4 5 6 7]] np.random.permutation(x) å¯ç›´æ¥ç”Ÿæˆä¸€ä¸ªéšæœºæ’åˆ—çš„æ•°ç»„ ar=np.random.permutation(10) print(ar) #[9 6 5 8 4 1 7 2 3 0] ä¸€ç»´æ•°ç»„ ar=np.random.permutation([1, 4, 9, 12, 15]) print(ar) #[15 9 12 4 1] å¤šç»´æ•°ç»„ arr=np.arange(9).reshape(3,3) print(arr) print('***********') arr2=np.random.permutation(arr) print(arr2) [[0 1 2] [3 4 5] [6 7 8]] *********** [[3 4 5] [6 7 8] [0 1 2]] ç‰¹å®šåˆ†å¸ƒ numpy.random èƒ½äº§ç”Ÿç‰¹å®šåˆ†å¸ƒçš„éšæœºæ•°ï¼Œå¦‚normalåˆ†å¸ƒã€uniformåˆ†å¸ƒã€poissonåˆ†å¸ƒç­‰ è¿™äº›å‡½æ•°ä¸­å‰é¢å‡ ä¸ªå‚æ•°æ˜¯åˆ†å¸ƒå‡½æ•°çš„å‚æ•°ï¼Œæœ€åä¸€ä¸ªå‚æ•°æ˜¯shape å¦‚æ­£æ€åˆ†å¸ƒnormalå°±æ˜¯å‡å€¼å’Œæ–¹å·®ï¼Œuniform å°±æ˜¯ä¸Šä¸‹ç•Œï¼Œæ³Šæ¾åˆ†å¸ƒå°±æ˜¯Î» np.random.uniform np.random.uniform(low=0.0, high=1.0, size=None) ä½œç”¨ï¼šå¯ä»¥ç”Ÿæˆ [low,high) ä¸­çš„éšæœºæ•°ï¼Œå¯ä»¥æ˜¯å•ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ç»´æ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šç»´æ•°ç»„ å‚æ•°ä»‹ç»ï¼š low : float å‹ï¼Œæˆ–è€…æ˜¯æ•°ç»„ç±»å‹çš„ï¼Œé»˜è®¤ä¸º 0 high: float å‹ï¼Œæˆ–è€…æ˜¯æ•°ç»„ç±»å‹çš„ï¼Œé»˜è®¤ä¸º 1 size: int å‹ï¼Œæˆ–å…ƒç»„ï¼Œé»˜è®¤ä¸ºç©º In[1]: import numpy as np In[2]: np.random.uniform() # é»˜è®¤ä¸º0åˆ°1 Out[2]: 0.827455693512018 In[3]: np.random.uniform(1,5) Out[3]: 2.93533586182789 In[4]: np.random.uniform(1,5,4) #ç”Ÿæˆä¸€ç»´æ•°ç»„ Out[4]: array([ 3.18487512, 1.40233721, 3.17543152, 4.06933042]) In[5]: np.random.uniform(1,5,(4,3)) #ç”Ÿæˆ4x3çš„æ•°ç»„ Out[5]: array([[ 2.33083328, 1.592934 , 2.38072 ], [ 1.07485686, 4.93224857, 1.42584919], [ 3.2667912 , 4.57868281, 1.53218578], [ 4.17965117, 3.63912616, 2.83516143]]) In[6]: np.random.uniform([1,5],[5,10]) Out[6]: array([ 2.74315143, 9.4701426 ]) numpy.random.normal ä»æ­£æ€ï¼ˆé«˜æ–¯ï¼‰åˆ†å¸ƒç»˜åˆ¶éšæœºæ ·æœ¬ã€‚ numpy.random.normal(loc=0.0, scale=1.0, size=None) locï¼šfloatæ­¤æ¦‚ç‡åˆ†å¸ƒçš„å‡å€¼ï¼ˆå¯¹åº”ç€æ•´ä¸ªåˆ†å¸ƒçš„ä¸­å¿ƒcentreï¼‰ scaleï¼šfloatæ­¤æ¦‚ç‡åˆ†å¸ƒçš„æ ‡å‡†å·®ï¼ˆå¯¹åº”äºåˆ†å¸ƒçš„å®½åº¦ï¼Œscaleè¶Šå¤§è¶ŠçŸ®èƒ–ï¼Œscaleè¶Šå°ï¼Œè¶Šç˜¦é«˜ï¼‰ sizeï¼šint or tuple of intsè¾“å‡ºçš„shapeï¼Œé»˜è®¤ä¸ºNoneï¼Œåªè¾“å‡ºä¸€ä¸ªå€¼ å‚è€ƒ éšæœºæŠ½æ · ä»np.random.normal()åˆ°æ­£æ€åˆ†å¸ƒçš„æ‹Ÿ Update timeï¼š 2020-06-11 "},"Chapter1/Numpy å­—ç¬¦ä¸²æ“ä½œ.html":{"url":"Chapter1/Numpy å­—ç¬¦ä¸²æ“ä½œ.html","title":"Numpy å­—ç¬¦ä¸²æ“ä½œ","keywords":"","body":"Numpy å­—ç¬¦ä¸²æ“ä½œ å‚è€ƒï¼š å­—ç¬¦ä¸²æ“ä½œ Update timeï¼š 2020-05-25 "},"Chapter1/Numpy mgridå’Œmeshgridçš„åŒºåˆ«å’Œä½¿ç”¨.html":{"url":"Chapter1/Numpy mgridå’Œmeshgridçš„åŒºåˆ«å’Œä½¿ç”¨.html","title":"Numpy mgrid()å’Œmeshgrid()çš„åŒºåˆ«å’Œä½¿ç”¨","keywords":"","body":"Numpy mgrid()å’Œmeshgrid()çš„åŒºåˆ«å’Œä½¿ç”¨ mgrid ç”¨æ³•ï¼šè¿”å›å¤šç»´ç»“æ„ï¼Œå¸¸è§çš„å¦‚2Då›¾å½¢ï¼Œ3Då›¾å½¢ã€‚å¯¹æ¯”np.meshgridï¼Œåœ¨å¤„ç†å¤§æ•°æ®æ—¶é€Ÿåº¦æ›´å¿«ï¼Œä¸”èƒ½å¤„ç†å¤šç»´ï¼ˆnp.meshgridåªèƒ½å¤„ç†2ç»´ï¼‰ ret = np.mgrid[ ç¬¬1ç»´ï¼Œç¬¬2ç»´ ï¼Œç¬¬3ç»´ ï¼Œ â€¦] è¿”å›å¤šå€¼ï¼Œä»¥å¤šä¸ªçŸ©é˜µçš„å½¢å¼è¿”å›ï¼Œç¬¬1è¿”å›å€¼ä¸ºç¬¬1ç»´æ•°æ®åœ¨æœ€ç»ˆç»“æ„ä¸­çš„åˆ†å¸ƒï¼Œç¬¬2è¿”å›å€¼ä¸ºç¬¬2ç»´æ•°æ®åœ¨æœ€ç»ˆç»“æ„ä¸­çš„åˆ†å¸ƒï¼Œä»¥æ­¤ç±»æ¨ã€‚ï¼ˆåˆ†å¸ƒä»¥çŸ©é˜µå½¢å¼å‘ˆç°ï¼‰ ä¾‹å¦‚ np.mgrid[X , Y] æ ·æœ¬ï¼ˆiï¼Œjï¼‰çš„åæ ‡ä¸º ï¼ˆX[iï¼Œj] ,Y[iï¼Œj]ï¼‰,Xä»£è¡¨ç¬¬1ç»´ï¼ŒYä»£è¡¨ç¬¬2ç»´ï¼Œåœ¨æ­¤ä¾‹ä¸­åˆ†åˆ«ä¸ºæ¨ªçºµåæ ‡ã€‚ mgrid[[1:3:3j, 4:5:2j]] 3jï¼š3ä¸ªç‚¹ æ­¥é•¿ä¸ºå¤æ•°è¡¨ç¤ºç‚¹æ•°ï¼Œå·¦é—­å³é—­ æ­¥é•¿ä¸ºå®æ•°è¡¨ç¤ºé—´éš”ï¼Œå·¦é—­å³å¼€ ä¾‹å¦‚1Dç»“æ„ï¼ˆarrayï¼‰ï¼Œå¦‚ä¸‹ï¼š In [2]: import numpy as np In [3]: pp=np.mgrid[-5:5:5j] In [4]: pp Out[4]: array([-5. , -2.5, 0. , 2.5, 5. ]) ä¾‹å¦‚2Dç»“æ„ (2DçŸ©é˜µ)ï¼Œå¦‚ä¸‹ï¼š >>> pp = np.mgrid[-1:1:2j,-2:2:3j] >>> x , y = pp >>> x array([[-1., -1., -1.], [ 1., 1., 1.]]) >>> y array([[-2., 0., 2.], [-2., 0., 2.]]) ä¾‹å¦‚3Dç»“æ„ (3Dç«‹æ–¹ä½“)ï¼Œå¦‚ä¸‹ï¼š >>> pp = np.mgrid[-1:1:2j,-2:2:3j,-3:3:5j] >>> print pp [[[[-1. -1. -1. -1. -1. ] [-1. -1. -1. -1. -1. ] [-1. -1. -1. -1. -1. ]] [[ 1. 1. 1. 1. 1. ] [ 1. 1. 1. 1. 1. ] [ 1. 1. 1. 1. 1. ]]] [[[-2. -2. -2. -2. -2. ] [ 0. 0. 0. 0. 0. ] [ 2. 2. 2. 2. 2. ]] [[-2. -2. -2. -2. -2. ] [ 0. 0. 0. 0. 0. ] [ 2. 2. 2. 2. 2. ]]] [[[-3. -1.5 0. 1.5 3. ] [-3. -1.5 0. 1.5 3. ] [-3. -1.5 0. 1.5 3. ]] [[-3. -1.5 0. 1.5 3. ] [-3. -1.5 0. 1.5 3. ] [-3. -1.5 0. 1.5 3. ]]]] meshgrid meshgridå‡½æ•°é€šå¸¸ä½¿ç”¨åœ¨æ•°æ®çš„çŸ¢é‡åŒ–ä¸Šã€‚ å®ƒé€‚ç”¨äºç”Ÿæˆç½‘æ ¼å‹æ•°æ®ï¼Œå¯ä»¥æ¥å—ä¸¤ä¸ªä¸€ç»´æ•°ç»„ç”Ÿæˆä¸¤ä¸ªäºŒç»´çŸ©é˜µï¼Œå¯¹åº”ä¸¤ä¸ªæ•°ç»„ä¸­æ‰€æœ‰çš„ (x,y) å¯¹ã€‚ In [4]: import numpy as np In [5]: xnums = np.arange(4) In [6]: ynums = np.arange(5) In [7]: xnums Out[7]: array([0, 1, 2, 3]) In [8]: ynums Out[8]: array([0, 1, 2, 3, 4]) In [9]: data_list = np.meshgrid(xnums, ynums) In [10]: data_list Out[10]: [array([[0, 1, 2, 3], [0, 1, 2, 3], [0, 1, 2, 3], [0, 1, 2, 3], [0, 1, 2, 3]]), array([[0, 0, 0, 0], [1, 1, 1, 1], [2, 2, 2, 2], [3, 3, 3, 3], [4, 4, 4, 4]])] In [11]: x, y = data_list In [12]: x.shape Out[12]: (5, 4) In [13]: y.shape Out[13]: (5, 4) In [14]: x Out[14]: array([[0, 1, 2, 3], [0, 1, 2, 3], [0, 1, 2, 3], [0, 1, 2, 3], [0, 1, 2, 3]]) In [15]: y Out[15]: array([[0, 0, 0, 0], [1, 1, 1, 1], [2, 2, 2, 2], [3, 3, 3, 3], [4, 4, 4, 4]]) meshgridçš„ä½œç”¨æ˜¯ï¼š æ ¹æ®ä¼ å…¥çš„ä¸¤ä¸ªä¸€ç»´æ•°ç»„å‚æ•°ç”Ÿæˆä¸¤ä¸ªæ•°ç»„å…ƒç´ çš„åˆ—è¡¨ã€‚ å¦‚æœ ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ xarrayï¼Œç»´åº¦æ˜¯ xdimesionï¼Œ ç¬¬äºŒä¸ªå‚æ•°æ˜¯ yarrayï¼Œç»´åº¦æ˜¯y dimesionã€‚ é‚£ä¹ˆç”Ÿæˆçš„ç¬¬ä¸€ä¸ªäºŒç»´æ•°ç»„æ˜¯ä»¥xarrayä¸ºè¡Œï¼Œå…± ydimesion è¡Œçš„å‘é‡ï¼› è€Œç¬¬äºŒä¸ªäºŒç»´æ•°ç»„æ˜¯ä»¥ yarray çš„è½¬ç½®ä¸ºåˆ—ï¼Œå…± xdimesion åˆ—çš„å‘é‡ã€‚ meshgrid å’Œ mgrid çš„åŒºåˆ« å‚è€ƒ Pythonçš„ numpyä¸­ meshgrid å’Œ mgrid çš„åŒºåˆ«å’Œä½¿ç”¨ Update timeï¼š 2020-05-25 "},"Chapter1/Numpy æ•°ç»„å¡«å……np.padå‡½æ•°.html":{"url":"Chapter1/Numpy æ•°ç»„å¡«å……np.padå‡½æ•°.html","title":"Numpy æ•°ç»„å¡«å……np.pad()å‡½æ•°","keywords":"","body":"Numpy æ•°ç»„å¡«å……np.pad()å‡½æ•° np.pad()å‡½æ•° pad(array, pad_width, mode, **kwargs) è¿”å›å€¼ï¼šæ•°ç»„ å‚æ•° arrayâ€”â€”è¡¨ç¤ºéœ€è¦å¡«å……çš„æ•°ç»„ï¼› pad_widthâ€”â€”è¡¨ç¤ºæ¯ä¸ªè½´ï¼ˆaxisï¼‰è¾¹ç¼˜éœ€è¦å¡«å……çš„æ•°å€¼æ•°ç›®ã€‚ å‚æ•°è¾“å…¥æ–¹å¼ä¸ºï¼šï¼ˆ(before_1, after_1), â€¦ (before_N, after_N)ï¼‰ï¼Œå…¶ä¸­(before_1, after_1)è¡¨ç¤ºç¬¬1è½´ä¸¤è¾¹ç¼˜åˆ†åˆ«å¡«å……before_1ä¸ªå’Œafter_1ä¸ªæ•°å€¼ã€‚å–å€¼ä¸ºï¼š{sequence, array_like, int} modeâ€”â€”è¡¨ç¤ºå¡«å……çš„æ–¹å¼ï¼ˆå–å€¼ï¼šstrå­—ç¬¦ä¸²æˆ–ç”¨æˆ·æä¾›çš„å‡½æ•°ï¼‰,æ€»å…±æœ‰11ç§å¡«å……æ¨¡å¼ï¼› â€˜constantâ€™â€”â€”è¡¨ç¤ºè¿ç»­å¡«å……ç›¸åŒçš„å€¼ï¼Œæ¯ä¸ªè½´å¯ä»¥åˆ†åˆ«æŒ‡å®šå¡«å……å€¼ï¼Œconstant_values=ï¼ˆx, yï¼‰æ—¶å‰é¢ç”¨xå¡«å……ï¼Œåé¢ç”¨yå¡«å……ï¼Œç¼ºçœå€¼å¡«å……0 â€˜edgeâ€™â€”â€”è¡¨ç¤ºç”¨è¾¹ç¼˜å€¼å¡«å…… â€˜linear_rampâ€™â€”â€”è¡¨ç¤ºç”¨è¾¹ç¼˜é€’å‡çš„æ–¹å¼å¡«å…… â€˜maximumâ€™â€”â€”è¡¨ç¤ºæœ€å¤§å€¼å¡«å…… â€˜meanâ€™â€”â€”è¡¨ç¤ºå‡å€¼å¡«å…… â€˜medianâ€™â€”â€”è¡¨ç¤ºä¸­ä½æ•°å¡«å…… â€˜minimumâ€™â€”â€”è¡¨ç¤ºæœ€å°å€¼å¡«å…… â€˜reflectâ€™â€”â€”è¡¨ç¤ºå¯¹ç§°å¡«å…… â€˜symmetricâ€™â€”â€”è¡¨ç¤ºå¯¹ç§°å¡«å…… â€˜wrapâ€™â€”â€”è¡¨ç¤ºç”¨åŸæ•°ç»„åé¢çš„å€¼å¡«å……å‰é¢ï¼Œå‰é¢çš„å€¼å¡«å……åé¢ å¸¸æ•°å¡«å……æ¨¡å¼constant A = np.arange(95,99).reshape(2,2) #åŸå§‹è¾“å…¥æ•°ç»„ A array([[95, 96], [97, 98]]) ç”¨ä¾‹1 åœ¨æ•°ç»„ A çš„è¾¹ç¼˜å¡«å…… constant_values æŒ‡å®šçš„æ•°å€¼ ï¼ˆ3,2ï¼‰è¡¨ç¤ºåœ¨Açš„ç¬¬[0]è½´å¡«å……ï¼ˆäºŒç»´æ•°ç»„ä¸­ï¼Œ0è½´è¡¨ç¤ºè¡Œï¼‰ï¼Œå³åœ¨0è½´å‰é¢å¡«å……3ä¸ªå®½åº¦çš„0ï¼Œæ¯”å¦‚æ•°ç»„Aä¸­çš„95,96ä¸¤ä¸ªå…ƒç´ å‰é¢å„å¡«å……äº†3ä¸ª0ï¼›åœ¨åé¢å¡«å……2ä¸ª0ï¼Œæ¯”å¦‚æ•°ç»„Aä¸­çš„97,98ä¸¤ä¸ªå…ƒç´ åé¢å„å¡«å……äº†2ä¸ª0 ï¼ˆ2,3ï¼‰è¡¨ç¤ºåœ¨Açš„ç¬¬[1]è½´å¡«å……ï¼ˆäºŒç»´æ•°ç»„ä¸­ï¼Œ1è½´è¡¨ç¤ºåˆ—ï¼‰ï¼Œå³åœ¨1è½´å‰é¢å¡«å……2ä¸ªå®½åº¦çš„0ï¼Œåé¢å¡«å……3ä¸ªå®½åº¦çš„0 np.pad(A,((3,2),(2,3)),'constant',constant_values = (0,0)) #constant_valuesè¡¨ç¤ºå¡«å……å€¼ï¼Œä¸”(beforeï¼Œafter)çš„å¡«å……å€¼ç­‰äºï¼ˆ0,0ï¼‰ array([[ 0, 0, 0, 0, 0, 0, 0], [ 0, 0, 0, 0, 0, 0, 0], [ 0, 0, 0, 0, 0, 0, 0], [ 0, 0, 95, 96, 0, 0, 0], [ 0, 0, 97, 98, 0, 0, 0], [ 0, 0, 0, 0, 0, 0, 0], [ 0, 0, 0, 0, 0, 0, 0]]) #å¡«å……æ—¶ï¼Œä»å‰é¢è½´ï¼Œå¾€åé¢è½´ä¾æ¬¡å¡«å…… np.pad(A,((3,2),(2,3)),'constant',constant_values = (-2,2)) #å¡«å……å€¼ï¼Œå‰é¢å¡«å……æ”¹ä¸º-2ï¼Œåé¢å¡«å……æ”¹ä¸º2 array([[-2, -2, -2, -2, 2, 2, 2], [-2, -2, -2, -2, 2, 2, 2], [-2, -2, -2, -2, 2, 2, 2], [-2, -2, 95, 96, 2, 2, 2], [-2, -2, 97, 98, 2, 2, 2], [-2, -2, 2, 2, 2, 2, 2], [-2, -2, 2, 2, 2, 2, 2]]) np.pad(A,((3,2),(2,3)),'constant',constant_values = ((0,0),(1,2))) #0è½´å’Œ1è½´åˆ†åˆ«å¡«å……ä¸åŒçš„å€¼ï¼Œå…ˆå¡«å……0è½´ï¼Œåå¡«å……1è½´ï¼Œå­˜åœ¨1è½´å¡«å……è¦†ç›–0è½´å¡«å……çš„æƒ…å½¢ array([[ 1, 1, 0, 0, 2, 2, 2], [ 1, 1, 0, 0, 2, 2, 2], [ 1, 1, 0, 0, 2, 2, 2], [ 1, 1, 95, 96, 2, 2, 2], [ 1, 1, 97, 98, 2, 2, 2], [ 1, 1, 0, 0, 2, 2, 2], [ 1, 1, 0, 0, 2, 2, 2]]) np.pad(A,((3,2),(2,3)),'constant') #,constant_values ç¼ºçœï¼Œåˆ™é»˜è®¤å¡«å……å‡ä¸º0 array([[ 0, 0, 0, 0, 0, 0, 0], [ 0, 0, 0, 0, 0, 0, 0], [ 0, 0, 0, 0, 0, 0, 0], [ 0, 0, 95, 96, 0, 0, 0], [ 0, 0, 97, 98, 0, 0, 0], [ 0, 0, 0, 0, 0, 0, 0], [ 0, 0, 0, 0, 0, 0, 0]]) è¾¹ç¼˜å€¼å¡«å……æ¨¡å¼â€”â€”â€™edgeâ€™ B = np.arange(1,5).reshape(2,2) #åŸå§‹è¾“å…¥æ•°ç»„ B array([[1, 2], [3, 4]]) np.pad(B,((1,2),(2,1)),'edge') #æ³¨æ„å…ˆå¡«å……0è½´ï¼Œåé¢å¡«å……1è½´ï¼Œä¾æ¬¡å¡«å…… array([[1, 1, 1, 2, 2], [1, 1, 1, 2, 2], [3, 3, 3, 4, 4], [3, 3, 3, 4, 4], [3, 3, 3, 4, 4]]) è¾¹ç¼˜æœ€å¤§å€¼å¡«å……æ¨¡å¼â€”â€”â€™maximumâ€™ B = np.arange(1,5).reshape(2,2) #åŸå§‹è¾“å…¥æ•°ç»„ B array([[1, 2], [3, 4]]) np.pad(B,((1,2),(2,1)),'maximum') #maximumå¡«å……æ¨¡å¼è¿˜æœ‰å…¶ä»–æ§åˆ¶å‚æ•°ï¼Œæ¯”å¦‚stat_lengthï¼Œè¯¦ç»†è§numpyåº“ array([[4, 4, 3, 4, 4], [2, 2, 1, 2, 2], [4, 4, 3, 4, 4], [4, 4, 3, 4, 4], [4, 4, 3, 4, 4]]) C = np.arange(0,9).reshape(3,3) #åŸå§‹è¾“å…¥æ•°ç»„ C array([[0, 1, 2], [3, 4, 5], [6, 7, 8]]) np.pad(C,((3,2),(2,1)),'maximum') array([[8, 8, 6, 7, 8, 8], [8, 8, 6, 7, 8, 8], [8, 8, 6, 7, 8, 8], [2, 2, 0, 1, 2, 2], [5, 5, 3, 4, 5, 5], [8, 8, 6, 7, 8, 8], [8, 8, 6, 7, 8, 8], [8, 8, 6, 7, 8, 8]]) å‚è€ƒ Numpyå­¦ä¹ â€”â€”æ•°ç»„å¡«å……np.pad()å‡½æ•°çš„åº”ç”¨ Update timeï¼š 2020-05-25 "},"Chapter2/":{"url":"Chapter2/","title":"Pandas","keywords":"","body":"Pandas Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ•°æ®ç»“æ„Series,DataFrame.html":{"url":"Chapter2/Pandas æ•°æ®ç»“æ„Series,DataFrame.html","title":"Pandas æ•°æ®ç»“æ„Series,DataFrame","keywords":"","body":"Pandas æ•°æ®ç»“æ„Series,DataFrame pandas æ˜¯åŸºäº numpy æ„å»ºçš„ï¼Œä¸ºæ—¶é—´åºåˆ—åˆ†ææä¾›äº†å¾ˆå¥½çš„æ”¯æŒã€‚pandasä¸­æœ‰ä¸¤ä¸ªä¸»è¦çš„æ•°æ®ç»“æ„ï¼Œä¸€ä¸ªæ˜¯Seriesï¼Œå¦ä¸€ä¸ªæ˜¯DataFrameã€‚ Series Series ç±»ä¼¼äºä¸€ç»´æ•°ç»„ä¸å­—å…¸(map)æ•°æ®ç»“æ„çš„ç»“åˆã€‚å®ƒç”±ä¸€ç»„æ•°æ®å’Œä¸€ç»„ä¸æ•°æ®ç›¸å¯¹åº”çš„æ•°æ®æ ‡ç­¾ï¼ˆç´¢å¼•indexï¼‰ç»„æˆã€‚è¿™ç»„æ•°æ®å’Œç´¢å¼•æ ‡ç­¾çš„åŸºç¡€éƒ½æ˜¯ä¸€ä¸ªä¸€ç»´ndarrayæ•°ç»„ã€‚å¯å°†indexç´¢å¼•ç†è§£ä¸ºè¡Œç´¢å¼•ã€‚ Series çš„è¡¨ç°å½¢å¼ä¸ºï¼šç´¢å¼•åœ¨å·¦ï¼Œæ•°æ®åœ¨å³ã€‚ pd.Series(data, index=index) data æ”¯æŒä»¥ä¸‹æ•°æ®ç±»å‹ï¼š Python å­—å…¸ å¤šç»´æ•°ç»„ æ ‡é‡å€¼ï¼ˆå¦‚ï¼Œ5ï¼‰ index æ˜¯è½´æ ‡ç­¾åˆ—è¡¨ã€‚ä¸åŒæ•°æ®å¯åˆ†ä¸ºä»¥ä¸‹å‡ ç§æƒ…å†µï¼š å¤šç»´æ•°ç»„ data æ˜¯å¤šç»´æ•°ç»„æ—¶ï¼Œindex é•¿åº¦å¿…é¡»ä¸ data é•¿åº¦ä¸€è‡´ã€‚æ²¡æœ‰æŒ‡å®š index å‚æ•°æ—¶ï¼Œåˆ›å»ºæ•°å€¼å‹ç´¢å¼•ï¼Œå³ [0, ..., len(data) - 1]ã€‚ In [3]: s = pd.Series(np.random.randn(5), index=['a', 'b', 'c', 'd', 'e']) In [4]: s Out[4]: a 0.469112 b -0.282863 c -1.509059 d -1.135632 e 1.212112 dtype: float64 In [5]: s.index Out[5]: Index(['a', 'b', 'c', 'd', 'e'], dtype='object') In [6]: pd.Series(np.random.randn(5)) Out[6]: 0 -0.173215 1 0.119209 2 -1.044236 3 -0.861849 4 -2.104569 dtype: float64 å­—å…¸ Series å¯ä»¥ç”¨å­—å…¸å®ä¾‹åŒ–ï¼š In [7]: d = {'b': 1, 'a': 0, 'c': 2} In [8]: pd.Series(d) Out[8]: b 1 a 0 c 2 dtype: int64 data ä¸ºå­—å…¸ï¼Œä¸”æœªè®¾ç½® index å‚æ•°æ—¶ï¼Œå¦‚æœ Python ç‰ˆæœ¬ >= 3.6 ä¸” Pandas ç‰ˆæœ¬ >= 0.23ï¼ŒSeries æŒ‰å­—å…¸çš„æ’å…¥é¡ºåºæ’åºç´¢å¼•ã€‚ Python index å‚æ•°æ—¶ï¼ŒSeries æŒ‰å­—æ¯é¡ºåºæ’åºå­—å…¸çš„é”®ï¼ˆkeyï¼‰åˆ—è¡¨ã€‚ Pandas ç”¨ NaNï¼ˆNot a Numberï¼‰è¡¨ç¤ºç¼ºå¤±æ•°æ®ã€‚ æ ‡é‡å€¼ data æ˜¯æ ‡é‡å€¼æ—¶ï¼Œå¿…é¡»æä¾›ç´¢å¼•ã€‚Series æŒ‰ç´¢å¼•é•¿åº¦é‡å¤è¯¥æ ‡é‡å€¼ã€‚ In [12]: pd.Series(5., index=['a', 'b', 'c', 'd', 'e']) Out[12]: a 5.0 b 5.0 c 5.0 d 5.0 e 5.0 dtype: float64 Series ç±»ä¼¼å¤šç»´æ•°ç»„ Series æ“ä½œä¸ ndarray ç±»ä¼¼ï¼Œæ”¯æŒå¤§å¤šæ•° NumPy å‡½æ•°ï¼Œè¿˜æ”¯æŒç´¢å¼•åˆ‡ç‰‡ In [13]: s[0] Out[13]: 0.4691122999071863 In [14]: s[:3] Out[14]: a 0.469112 b -0.282863 c -1.509059 dtype: float64 In [15]: s[s > s.median()] Out[15]: a 0.469112 e 1.212112 dtype: float64 In [16]: s[[4, 3, 1]] Out[16]: e 1.212112 d -1.135632 b -0.282863 dtype: float64 In [17]: np.exp(s) Out[17]: a 1.598575 b 0.753623 c 0.221118 d 0.321219 e 3.360575 dtype: float64 è·å–ç´¢å¼•å’Œæ•°æ®ï¼šser_obj.index, ser_obj.values é¢„è§ˆæ•°æ®ï¼šser_obj.head(n), ser_obj.tail(n) ä½¿ç”¨ä¸€ç»´æ•°ç»„ç”Ÿæˆ Series DataFrame DataFrame æ˜¯ç”±å¤šç§ç±»å‹çš„åˆ—æ„æˆçš„äºŒç»´æ ‡ç­¾æ•°æ®ç»“æ„ï¼Œç±»ä¼¼äº Excel ã€SQL è¡¨ï¼Œæˆ– Series å¯¹è±¡æ„æˆçš„å­—å…¸ã€‚DataFrame æ˜¯æœ€å¸¸ç”¨çš„ Pandas å¯¹è±¡ï¼Œä¸ Series ä¸€æ ·ï¼ŒDataFrame æ”¯æŒå¤šç§ç±»å‹çš„è¾“å…¥æ•°æ®ï¼š ä¸€ç»´ ndarrayã€åˆ—è¡¨ã€å­—å…¸ã€Series å­—å…¸ äºŒç»´ numpy.ndarray ç»“æ„å¤šç»´æ•°ç»„æˆ–è®°å½•å¤šç»´æ•°ç»„ Series DataFrame é™¤äº†æ•°æ®ï¼Œè¿˜å¯ä»¥æœ‰é€‰æ‹©åœ°ä¼ é€’ indexï¼ˆè¡Œæ ‡ç­¾ï¼‰å’Œ columnsï¼ˆåˆ—æ ‡ç­¾ï¼‰å‚æ•°ã€‚ä¼ é€’äº†ç´¢å¼•æˆ–åˆ—ï¼Œå°±å¯ä»¥ç¡®ä¿ç”Ÿæˆçš„ DataFrame é‡ŒåŒ…å«ç´¢å¼•æˆ–åˆ—ã€‚Series å­—å…¸åŠ ä¸ŠæŒ‡å®šç´¢å¼•æ—¶ï¼Œä¼šä¸¢å¼ƒä¸ä¼ é€’çš„ç´¢å¼•ä¸åŒ¹é…çš„æ‰€æœ‰æ•°æ®ã€‚ Python > = 3.6ï¼Œä¸” Pandas > = 0.23ï¼Œæ•°æ®æ˜¯å­—å…¸ï¼Œä¸”æœªæŒ‡å®š columns å‚æ•°æ—¶ï¼ŒDataFrame çš„åˆ—æŒ‰å­—å…¸çš„æ’å…¥é¡ºåºæ’åº. ç”¨ Series å­—å…¸æˆ–å­—å…¸ç”Ÿæˆ DataFrame ç”Ÿæˆçš„ç´¢å¼•æ˜¯æ¯ä¸ª Series ç´¢å¼•çš„å¹¶é›†ã€‚å…ˆæŠŠåµŒå¥—å­—å…¸è½¬æ¢ä¸º Seriesã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šåˆ—ï¼ŒDataFrame çš„åˆ—å°±æ˜¯å­—å…¸é”®çš„æœ‰åºåˆ—è¡¨ã€‚ In [37]: d = {'one': pd.Series([1., 2., 3.], index=['a', 'b', 'c']), ....: 'two': pd.Series([1., 2., 3., 4.], index=['a', 'b', 'c', 'd'])} ....: In [38]: df = pd.DataFrame(d) In [39]: df Out[39]: one two a 1.0 1.0 b 2.0 2.0 c 3.0 3.0 d NaN 4.0 In [40]: pd.DataFrame(d, index=['d', 'b', 'a']) Out[40]: one two d NaN 4.0 b 2.0 2.0 a 1.0 1.0 In [41]: pd.DataFrame(d, index=['d', 'b', 'a'], columns=['two', 'three']) Out[41]: two three d 4.0 NaN b 2.0 NaN a 1.0 NaN index å’Œ columns å±æ€§åˆ†åˆ«ç”¨äºè®¿é—®è¡Œã€åˆ—æ ‡ç­¾. In [42]: df.index Out[42]: Index(['a', 'b', 'c', 'd'], dtype='object') In [43]: df.columns Out[43]: Index(['one', 'two'], dtype='object') ç”¨å¤šç»´æ•°ç»„å­—å…¸ã€åˆ—è¡¨å­—å…¸ç”Ÿæˆ DataFrame å¤šç»´æ•°ç»„çš„é•¿åº¦å¿…é¡»ç›¸åŒã€‚å¦‚æœä¼ é€’äº†ç´¢å¼•å‚æ•°ï¼Œindex çš„é•¿åº¦å¿…é¡»ä¸æ•°ç»„ä¸€è‡´ã€‚å¦‚æœæ²¡æœ‰ä¼ é€’ç´¢å¼•å‚æ•°ï¼Œç”Ÿæˆçš„ç»“æœæ˜¯ range(n)ï¼Œn ä¸ºæ•°ç»„é•¿åº¦ã€‚ In [44]: d = {'one': [1., 2., 3., 4.], ....: 'two': [4., 3., 2., 1.]} ....: In [45]: pd.DataFrame(d) Out[45]: one two 0 1.0 4.0 1 2.0 3.0 2 3.0 2.0 3 4.0 1.0 In [46]: pd.DataFrame(d, index=['a', 'b', 'c', 'd']) Out[46]: one two a 1.0 4.0 b 2.0 3.0 c 3.0 2.0 d 4.0 1.0 ç”¨ç»“æ„å¤šç»´æ•°ç»„æˆ–è®°å½•å¤šç»´æ•°ç»„ç”Ÿæˆ DataFrame In [47]: data = np.zeros((2, ), dtype=[('A', 'i4'), ('B', 'f4'), ('C', 'a10')]) In [48]: data[:] = [(1, 2., 'Hello'), (2, 3., \"World\")] In [49]: pd.DataFrame(data) Out[49]: A B C 0 1 2.0 b'Hello' 1 2 3.0 b'World' In [50]: pd.DataFrame(data, index=['first', 'second']) Out[50]: A B C first 1 2.0 b'Hello' second 2 3.0 b'World' In [51]: pd.DataFrame(data, columns=['C', 'A', 'B']) Out[51]: C A B 0 b'Hello' 1 2.0 1 b'World' 2 3.0 ç”¨åˆ—è¡¨å­—å…¸ç”Ÿæˆ DataFrame In [52]: data2 = [{'a': 1, 'b': 2}, {'a': 5, 'b': 10, 'c': 20}] In [53]: pd.DataFrame(data2) Out[53]: a b c 0 1 2 NaN 1 5 10 20.0 In [54]: pd.DataFrame(data2, index=['first', 'second']) Out[54]: a b c first 1 2 NaN second 5 10 20.0 In [55]: pd.DataFrame(data2, columns=['a', 'b']) Out[55]: a b 0 1 2 1 5 10 å¤‡é€‰æ„å»ºå™¨ DataFrame.from_dict DataFrame.from_dict( data, orient ='columns', dtype = None, columns = None ) data:å­—å…¸å½¢å¼ä¸º{fieldï¼šarray-like}æˆ–{fieldï¼šdict}ã€‚ orient:{â€˜columnsâ€™ï¼Œâ€˜indexâ€™}ï¼Œé»˜è®¤â€™åˆ—â€™æ•°æ®çš„â€œæ–¹å‘â€ã€‚ å¦‚æœä¼ é€’çš„dictçš„é”®åº”è¯¥æ˜¯ç»“æœDataFrameçš„åˆ—ï¼Œåˆ™ä¼ é€’â€™columnsâ€™ï¼ˆé»˜è®¤å€¼ï¼‰ã€‚ å¦åˆ™ï¼Œå¦‚æœé”®åº”è¯¥æ˜¯è¡Œï¼Œåˆ™ä¼ é€’â€™indexâ€™ã€‚ dtypeï¼šdtype:é»˜è®¤æ— æ•°æ®ç±»å‹å¼ºåˆ¶ï¼Œå¦åˆ™æ¨æ–­ã€‚ columnsï¼šlisté»˜è®¤æ— è¦ä½¿ç”¨çš„åˆ—æ ‡ç­¾orient=â€˜indexâ€™ã€‚ å¦‚æœä½¿ç”¨ï¼Œåˆ™å¼•å‘ValueError orient=â€˜columnsâ€™ã€‚ DataFrame.from_dict æ¥æ”¶å­—å…¸ç»„æˆçš„å­—å…¸æˆ–æ•°ç»„åºåˆ—å­—å…¸ï¼Œå¹¶ç”Ÿæˆ DataFrameã€‚é™¤äº† orient å‚æ•°é»˜è®¤ä¸º columnsï¼Œæœ¬æ„å»ºå™¨çš„æ“ä½œä¸ DataFrame æ„å»ºå™¨ç±»ä¼¼ã€‚æŠŠ orient å‚æ•°è®¾ç½®ä¸º 'index'ï¼Œ å³å¯æŠŠå­—å…¸çš„é”®ä½œä¸ºè¡Œæ ‡ç­¾ã€‚ In [57]: pd.DataFrame.from_dict(dict([('A', [1, 2, 3]), ('B', [4, 5, 6])])) Out[57]: A B 0 1 4 1 2 5 2 3 6 orient='index' æ—¶ï¼Œé”®æ˜¯è¡Œæ ‡ç­¾ã€‚æœ¬ä¾‹è¿˜ä¼ é€’äº†åˆ—åï¼š In [58]: pd.DataFrame.from_dict(dict([('A', [1, 2, 3]), ('B', [4, 5, 6])]), ....: orient='index', columns=['one', 'two', 'three']) ....: Out[58]: one two three A 1 2 3 B 4 5 6 Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ•°æ®è·å–ä¸æŸ¥è¯¢.html":{"url":"Chapter2/Pandas æ•°æ®è·å–ä¸æŸ¥è¯¢.html","title":"Pandas æ•°æ®è·å–ä¸æŸ¥è¯¢","keywords":"","body":"Pandas æ•°æ®è·å–ä¸æŸ¥è¯¢ æ•°æ®çš„æŸ¥çœ‹ import numpy as np import pandas as pd from pandas import Sereis, DataFrame ser = Series(np.arange(3.)) data = DataFrame(np.arange(16).reshape(4,4),index=list('abcd'),columns=list('wxyz')) data['w'] #é€‰æ‹©è¡¨æ ¼ä¸­çš„'w'åˆ—ï¼Œä½¿ç”¨ç±»å­—å…¸å±æ€§,è¿”å›çš„æ˜¯Seriesç±»å‹ data.w #é€‰æ‹©è¡¨æ ¼ä¸­çš„'w'åˆ—ï¼Œä½¿ç”¨ç‚¹å±æ€§,è¿”å›çš„æ˜¯Seriesç±»å‹ data[['w']] #é€‰æ‹©è¡¨æ ¼ä¸­çš„'w'åˆ—ï¼Œè¿”å›çš„æ˜¯DataFrameç±»å‹ data[['w','z']] #é€‰æ‹©è¡¨æ ¼ä¸­çš„'w'ã€'z'åˆ— data[0:2] #è¿”å›ç¬¬1è¡Œåˆ°ç¬¬2è¡Œçš„æ‰€æœ‰è¡Œï¼Œå‰é—­åå¼€ï¼ŒåŒ…æ‹¬å‰ä¸åŒ…æ‹¬å data[1:2] #è¿”å›ç¬¬2è¡Œï¼Œä»0è®¡ï¼Œè¿”å›çš„æ˜¯å•è¡Œï¼Œé€šè¿‡æœ‰å‰åå€¼çš„ç´¢å¼•å½¢å¼ï¼Œ #å¦‚æœé‡‡ç”¨data[1]åˆ™æŠ¥é”™ data.ix[1:2] #è¿”å›ç¬¬2è¡Œçš„ç¬¬ä¸‰ç§æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯DataFrameï¼Œè·Ÿdata[1:2]åŒ data['a':'b'] #åˆ©ç”¨indexå€¼è¿›è¡Œåˆ‡ç‰‡ï¼Œè¿”å›çš„æ˜¯**å‰é—­åé—­**çš„DataFrame, #å³æœ«ç«¯æ˜¯åŒ…å«çš„ data.head() #è¿”å›dataçš„å‰å‡ è¡Œæ•°æ®ï¼Œé»˜è®¤ä¸ºå‰äº”è¡Œï¼Œéœ€è¦å‰åè¡Œåˆ™data.head(10) data.tail() #è¿”å›dataçš„åå‡ è¡Œæ•°æ®ï¼Œé»˜è®¤ä¸ºåäº”è¡Œï¼Œéœ€è¦ååè¡Œåˆ™data.tail(10) data.iloc[-1] #é€‰å–DataFrameæœ€åä¸€è¡Œï¼Œè¿”å›çš„æ˜¯Series data.iloc[-1:] #é€‰å–DataFrameæœ€åä¸€è¡Œï¼Œè¿”å›çš„æ˜¯DataFrame data.loc['a',['w','x']] #è¿”å›â€˜aâ€™è¡Œ'w'ã€'x'åˆ—ï¼Œè¿™ç§ç”¨äºé€‰å–è¡Œç´¢å¼•åˆ—ç´¢å¼•å·²çŸ¥ data.iat[1,1] #é€‰å–ç¬¬äºŒè¡Œç¬¬äºŒåˆ—ï¼Œç”¨äºå·²çŸ¥è¡Œã€åˆ—ä½ç½®çš„é€‰å–ã€‚ ä»¥å±æ€§æ–¹å¼è®¿é—®ï¼Œå¯¹DataFrameæ˜¯åˆ—åï¼Œå¯¹Seriesæ˜¯é”®ã€‚ä¾‹å¦‚df.A, df.A.a .at,.iatå’Œ.get_valueï¼Œè·å–å•ä¸ªå€¼ï¼Œæ³¨æ„ä¸¤è€…çš„åŒºåˆ«ã€‚df.at[â€˜aâ€™,â€˜Aâ€™], df.get_value(â€˜aâ€™,â€˜Aâ€™)ã€‚ä»–ä»¬ç­‰ä»·äºdf.loc[â€˜aâ€™,â€˜Aâ€™]ã€‚è¿™ä¸ªæ¯”é‡‡ç”¨[]é€Ÿåº¦è¦å¿«ï¼Œéå†çš„æ—¶å€™æ¨èç”¨è¿™ä¸ªã€‚ df = pd.DataFrame([[0, 2, 3], [0, 4, 1], [10, 20, 30]], columns=['A', 'B', 'C']) print(df) ''' A B C 0 0 2 3 1 0 4 1 2 10 20 30 ''' print(df.at[2, 'B']) #20 print(df.at[2, 2]) #ValueError: At based indexing on an non-integer index can only have non-integer indexers print(df.get_value(2,'B')) #20 print(df.get_value(2,2)) #åªèƒ½æ ¹æ®æ ‡ç­¾ç´¢å¼• Update timeï¼š 2020-05-25 "},"Chapter2/Pandas ix ã€loc ã€ ilocåŒºåˆ«.html":{"url":"Chapter2/Pandas ix ã€loc ã€ ilocåŒºåˆ«.html","title":"Pandas ix ã€loc ã€ ilocåŒºåˆ«","keywords":"","body":"Pandas ix ã€loc ã€ ilocåŒºåˆ« loc locâ€”â€”é€šè¿‡è¡Œæ ‡ç­¾ç´¢å¼•è¡Œæ•°æ® loc[1]è¡¨ç¤ºç´¢å¼•çš„æ˜¯ç¬¬1è¡Œï¼ˆ index æ˜¯æ•´æ•°ï¼‰ .locä¸»è¦æ˜¯åŸºäºæ ‡ç­¾(label)çš„ï¼ŒåŒ…æ‹¬è¡Œæ ‡ç­¾(index)å’Œåˆ—æ ‡ç­¾(columns)ï¼Œå³è¡Œåç§°å’Œåˆ—åç§°ï¼Œå¯ä»¥ä½¿ç”¨df.loc[index_name,col_name]ï¼Œé€‰æ‹©æŒ‡å®šä½ç½®çš„æ•°æ® ä½¿ç”¨å•ä¸ªæ ‡ç­¾ å¦‚æœ.loc[]ä¸­åªæœ‰å•ä¸ªæ ‡ç­¾ï¼Œé‚£ä¹ˆé€‰æ‹©çš„æ˜¯æŸä¸€è¡Œã€‚ df.loc[1]é€‰æ‹©çš„æ˜¯ index åä¸º â€˜1â€™ çš„ä¸€è¡Œï¼Œæ³¨æ„è¿™é‡Œçš„â€™1â€™æ˜¯indexçš„åç§°ï¼Œè€Œä¸æ˜¯åºå· data = [[1,2,3],[4,5,6]] index = [0,1] columns=['a','b','c'] df = pd.DataFrame(data=data, index=index, columns=columns) df a b c 0 1 2 3 1 4 5 6 # é€‰å–è¡Œå·ä¸º 1 çš„ index df.loc[1] a 4 b 5 c 6 Name: 1, dtype: int64 ä½¿ç”¨æ ‡ç­¾çš„listï¼šåŒæ ·æ˜¯åªé€‰æ‹©è¡Œ df.loc[[0,1]] a b c 0 1 2 3 1 4 5 6 æ ‡ç­¾çš„åˆ‡ç‰‡å¯¹è±¡ï¼šä¸é€šå¸¸çš„pythonåˆ‡ç‰‡ä¸åŒï¼Œåœ¨æœ€ç»ˆé€‰æ‹©çš„æ•°æ®ä¸­åŒ…å«åˆ‡ç‰‡çš„start å’Œ stop df.loc['c':'f'] A B C D c 0.546339 0.009044 0.774770 0.121425 d 0.517394 0.665752 0.762913 0.940879 e 0.123988 0.209996 0.365368 0.401288 f 0.590005 0.993915 0.611509 0.683021 å¸ƒå°”å‹çš„æ•°ç»„ï¼šé€šå¸¸ç”¨äºç­›é€‰ç¬¦åˆæŸäº›æ¡ä»¶çš„è¡Œ df.loc[df.A > 0.7] A B C D a 0.899727 0.61540 0.970942 0.621620 b 0.936262 0.59904 0.139279 0.678375 A å±æ€§å¤§äº 0.7 çš„æ‰€æœ‰ C å’Œ D åˆ— df.loc[df.A > 0.7,['C', 'D']] C D a 0.970942 0.621620 b 0.139279 0.678375 å¯è°ƒç”¨çš„å‡½æ•° df.loc[lambda df : df.A > 0.7] A B C D a 0.899727 0.61540 0.970942 0.621620 b 0.936262 0.59904 0.139279 0.678375 lambdaè¡¨è¾¾å¼è¯­æ³•ï¼š lambda ä¼ å…¥å‚æ•° ï¼š è¿”å›çš„è®¡ç®—è¡¨è¾¾å¼ locæ‰©å±•â€”â€”ç´¢å¼•æŸè¡ŒæŸåˆ— ç´¢å¼•æŸè¡ŒæŸåˆ— data = [[1,2,3],[4,5,6]] index = ['d','e'] columns=['a','b','c'] df = pd.DataFrame(data=data, index=index, columns=columns) print(df) ''' a b c d 1 2 3 e 4 5 6 ''' print (df.loc['d',['b','c']]) ''' b 2 c 3 ''' ç´¢å¼•æŸåˆ— import pandas as pd data = [[1,2,3],[4,5,6]] index = ['d','e'] columns=['a','b','c'] df = pd.DataFrame(data=data, index=index, columns=columns) print(df) ''' a b c d 1 2 3 e 4 5 6 ''' print (df.loc[:,['c']]) ''' c d 3 e 6 ''' df = pd.DataFrame([[1, 2], [4, 5], [7, 8]], index=['cobra', 'viper', 'sidewinder'], columns=['max_speed', 'shield']) print(df) print(df.loc[['viper', 'sidewinder'],['max_speed', 'shield']]) ''' max_speed shield cobra 1 2 viper 4 5 sidewinder 7 8 max_speed shield viper 4 5 sidewinder 7 8 ''' ilocç”¨æ³• ilocæ˜¯åŸºäºä½ç½®çš„ç´¢å¼•ï¼Œåˆ©ç”¨å…ƒç´ åœ¨å„ä¸ªè½´ä¸Šçš„ç´¢å¼•åºå·è¿›è¡Œé€‰æ‹©ï¼Œåºå·è¶…å‡ºèŒƒå›´ä¼šäº§ç”ŸIndexErrorï¼Œåˆ‡ç‰‡æ—¶å…è®¸åºå·è¶…è¿‡èŒƒå›´ï¼Œç”¨æ³•åŒ…æ‹¬ï¼š ä½¿ç”¨æ•´æ•°ï¼šä¸.locç›¸åŒï¼Œå¦‚æœåªä½¿ç”¨ä¸€ä¸ªç»´åº¦ï¼Œåˆ™å¯¹è¡Œé€‰æ‹©ï¼Œä¸‹æ ‡ä»0å¼€å§‹ # é€‰æ‹©ç¬¬å…­è¡Œæ•°æ® df.iloc[5] A 0.590005 B 0.993915 C 0.611509 D 0.683021 Name: f, dtype: float64 ä½¿ç”¨åˆ—è¡¨æˆ–æ•°ç»„ï¼ŒåŒæ ·æ˜¯å¯¹è¡Œé€‰æ‹© df.iloc[[1,3,4]] A B C D b 0.936262 0.599040 0.139279 0.678375 d 0.517394 0.665752 0.762913 0.940879 e 0.123988 0.209996 0.365368 0.401288 å…ƒç´ ä¸ºæ•´æ•°çš„åˆ‡ç‰‡å¯¹è±¡ï¼šä¸.locä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œä¸‹æ ‡ä¸ºstopçš„æ•°æ®ä¸è¢«é€‰æ‹© df.iloc[0:3] A B C D a 0.899727 0.615400 0.970942 0.621620 b 0.936262 0.599040 0.139279 0.678375 c 0.546339 0.009044 0.774770 0.121425 ä¹Ÿå¯ä»¥å¯¹åˆ—è¿›è¡Œåˆ‡ç‰‡ï¼š df.iloc[0:3,1:3] B C a 0.615400 0.970942 b 0.599040 0.139279 c 0.009044 0.774770 import pandas as pd data = [[1,2,3],[4,5,6]] index = ['d','e'] columns=['a','b','c'] df = pd.DataFrame(data=data, index=index, columns=columns) print(df) ''' a b c d 1 2 3 e 4 5 6 ''' print (df.iloc[:,[1]]) ''' b d 2 e 5 ''' ä½¿ç”¨å¸ƒå°”æ•°ç»„è¿›è¡Œç­›é€‰ï¼š æ³¨æ„è¿™é‡Œå¯ä»¥ä½¿ç”¨ list æˆ–è€… arrayï¼Œä½¿ç”¨ Series çš„è¯ä¼šå‡ºé”™ï¼ŒNotImplementedErroræˆ–è€…ValueErrorï¼Œå‰è€…æ˜¯Seriesçš„indexä¸å¾…åˆ‡ç‰‡DataFrameçš„indexä¸åŒæ—¶ï¼Œåè€…æ˜¯indexç›¸åŒæ—¶æŠ¥çš„é”™ï¼Œå¯ä»¥è‡ªå·±å®ç°ä½“ä¼šä¸€ä¸‹ã€‚ä¸.locä½¿ç”¨å¸ƒå°”æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨listï¼Œ arrayï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Seriesï¼Œä½¿ç”¨Seriesæ—¶indexéœ€è¦ä¸€è‡´ï¼Œå¦åˆ™ä¼šæŠ¥IndexingError df.iloc[np.array(df.A > 0.6)] A B C D a 0.899727 0.61540 0.970942 0.621620 b 0.936262 0.59904 0.139279 0.678375 ä½¿ç”¨å¯è°ƒç”¨å‡½æ•° df.iloc[lambda df : [0,1]] # é€‰æ‹©å‰ä¸¤è¡Œ A B C D a 0.899727 0.61540 0.970942 0.621620 b 0.936262 0.59904 0.139279 0.678375 ixâ€”â€”ç»“åˆå‰ä¸¤ç§çš„æ··åˆç´¢å¼• é€šè¿‡è¡Œå·ç´¢å¼• df.ix[0] A 0.899727 B 0.615400 C 0.970942 D 0.621620 Name: a, dtype: float64 é€šè¿‡è¡Œæ ‡ç­¾ç´¢å¼• df.ix['a'] A 0.899727 B 0.615400 C 0.970942 D 0.621620 Name: a, dtype: float64 åˆ‡ç‰‡æ“ä½œ[] []æ“ä½œåªèƒ½è¾“å…¥ä¸€ä¸ªç»´åº¦ï¼Œä¸èƒ½ç”¨é€—å·éš”å¼€è¾“å…¥ä¸¤ä¸ªç»´åº¦ï¼š ä½¿ç”¨åˆ—åï¼š.locå’Œilocåªè¾“å…¥ä¸€ç»´æ—¶é€‰å–çš„æ˜¯è¡Œï¼Œè€Œ[]é€‰å–çš„æ˜¯åˆ—ï¼Œå¹¶ä¸”å¿…é¡»ä½¿ç”¨åˆ—å df[['A','B']] A B a 0.899727 0.615400 b 0.936262 0.599040 c 0.546339 0.009044 d 0.517394 0.665752 e 0.123988 0.209996 f 0.590005 0.993915 ç”¨å¸ƒå°”æ•°ç»„ï¼šbool æ•°ç»„çš„ index éœ€è¦å’Œ dataframe çš„ index ä¸€è‡´ï¼Œæ­¤æ—¶é€‰å–çš„æ˜¯è¡Œ df[df.B > 0.6] A B C D a 0.899727 0.615400 0.970942 0.621620 d 0.517394 0.665752 0.762913 0.940879 f 0.590005 0.993915 0.611509 0.683021 .aã€.iatä¸loc ã€ilocç±»ä¼¼ï¼Œ.aã€loc ã€åªèƒ½é€šè¿‡æ ‡ç­¾è·å–å€¼ï¼Œ.iatã€ilocé€šè¿‡è¡Œå·ï¼Œåˆ—å·è·å–å€¼ df = pd.DataFrame([[0, 2, 3], [0, 4, 1], [10, 20, 30]], columns=['A', 'B', 'C']) print(df) ''' A B C 0 0 2 3 1 0 4 1 2 10 20 30 ''' print(df.at[2, 'B']) #20 print(df.at[2, 2]) #ValueError: At based indexing on an non-integer index can only have non-integer indexers print(df.get_value(2,'B')) #20 print(df.get_value(2,2)) #åªèƒ½æ ¹æ®æ ‡ç­¾ç´¢å¼• å‚è€ƒï¼š pandasç´¢å¼•å’Œé€‰æ‹©æ•°æ® pythoné€‰å–ç‰¹å®šåˆ—â€”â€”pandasçš„ilocå’Œlocä»¥åŠicolä½¿ç”¨ Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ•°æ®å¯¹é½è¾“å‡º.html":{"url":"Chapter2/Pandas æ•°æ®å¯¹é½è¾“å‡º.html","title":"Pandas æ•°æ®å¯¹é½è¾“å‡º","keywords":"","body":"Pandas æ•°æ®å¯¹é½è¾“å‡º ç”¨pandaså±•ç¤ºæ•°æ®è¾“å‡ºæ—¶åˆ—åä¸èƒ½å¯¹é½ åˆ—åç”¨äº†ä¸­æ–‡çš„ç¼˜æ•…ï¼Œè®¾ç½®pandasçš„å‚æ•°å³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š import pandas as pd #è¿™ä¸¤ä¸ªå‚æ•°çš„é»˜è®¤è®¾ç½®éƒ½æ˜¯False pd.set_option('display.unicode.ambiguous_as_wide', True) pd.set_option('display.unicode.east_asian_width', True) Update timeï¼š 2020-05-25 "},"Chapter2/Pandas Indexå¯¹è±¡.html":{"url":"Chapter2/Pandas Indexå¯¹è±¡.html","title":"Pandas Indexå¯¹è±¡","keywords":"","body":"Pandas Indexå¯¹è±¡ Index å¯¹è±¡ä¿å­˜ç€ç´¢å¼•æ ‡ç­¾æ•°æ®ï¼Œå®ƒå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ ‡ç­¾å¯¹åº”çš„æ•´æ•°ä¸‹æ ‡ï¼Œå…¶åŠŸèƒ½ä¸Pythonçš„å­—å…¸ç±»ä¼¼ã€‚ dict1={\"Province\":[\"Guangdong\",\"Beijing\",\"Qinghai\",\"Fujiang\"], \"year\":[2018]*4, \"pop\":[1.3,2.5,1.1,0.7]} df1=DataFrame(dict1) print(df1) ''' Province year pop 0 Guangdong 2018 1.3 1 Beijing 2018 2.5 2 Qinghai 2018 1.1 3 Fujiang 2018 0.7 ''' è°ƒç”¨.columnsè¿”å›DataFrameå¯¹è±¡çš„åˆ—ç´¢å¼•ï¼ˆå³æ‰€æœ‰åˆ—æ ‡ç­¾ï¼‰ï¼š col_index=df1.columns print(col_index) # Index(['Province', 'year', 'pop'], dtype='object') print(col_index.values) # ['Province' 'year' 'pop'] è°ƒç”¨.index ind_index=df1.index print(ind_index.values) # RangeIndex(start=0, stop=4, step=1) print(ind_index.values) #array([0, 1, 2, 3], dtype=int64) Index å¯¹è±¡å¯å½“åšä¸€ç»´æ•°ç»„ï¼Œé€‚åˆ Numpy æ•°ç»„çš„ä¸‹æ ‡è¿ç®—ï¼Œä½† Index å¯¹è±¡åªæ˜¯å¯è¯»ï¼Œåˆ›å»ºåä¸å¯ä¿®æ”¹ã€‚ print(col_index[[1,2]]) print(ind_index[ind_index>1]) ''' Index(['year', 'pop'], dtype='object') Int64Index([2, 3], dtype='int64') ''' index å¯¹è±¡å…·æœ‰å­—å…¸çš„æ˜ å°„åŠŸèƒ½ï¼Œ.get_loc(value)è·å¾—å•å€¼å¾—ä¸‹æ ‡ï¼Œ.get_indexer(values) è·å¾—ä¸€ç»„å€¼å¾—ä¸‹æ ‡ï¼Œå½“å€¼ä¸å­˜åœ¨åˆ™è¿”å›-1ï¼š print(col_index.get_loc('pop')) print(col_index.get_indexer(['pop','year'])) ''' 2 [2 1] ''' Index å¯¹è±¡è°ƒç”¨ Index()æ¥åˆ›å»ºï¼Œå¯ä¼ é€’ç»™ DataFrame å¯¹è±¡çš„å‚æ•° index å’Œcolumnsã€‚å› ä¸º Index æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤å¤šä¸ª DataFrame å¯¹è±¡çš„ç´¢å¼•å¯ä»¥æ˜¯åŒä¸ªIndexå¯¹è±¡ã€‚ index=pd.Index(['a','b','c']) df2=DataFrame(np.random.randint(1,10,(3,3)),index=index,columns=index) print(df2) ''' a b c a 3 5 3 b 9 2 3 c 6 3 3 ''' Update timeï¼š 2020-05-25 "},"Chapter2/Pandas MultiIndexå¯¹è±¡.html":{"url":"Chapter2/Pandas MultiIndexå¯¹è±¡.html","title":"Pandas MultiIndexå¯¹è±¡","keywords":"","body":"Pandas MultiIndexå¯¹è±¡ åˆ†å±‚/å¤šçº§ç´¢å¼•ï¼Œå› ä¸ºå®ƒä¸ºä¸€äº›éå¸¸å¤æ‚çš„æ•°æ®åˆ†æå’Œæ“ä½œæä¾›äº†å¯èƒ½æ€§ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤„ç†æ›´é«˜ç»´åº¦çš„æ•°æ®ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œå®ƒä½¿ä½ èƒ½åœ¨è¾ƒä½ç»´åº¦çš„æ•°æ®ç»“æ„(å¦‚Seriesï¼ˆ1dï¼‰å’ŒDataFrameï¼ˆ2dï¼‰)ä¸­å­˜å‚¨å’Œæ“ä½œå…·æœ‰ä»»æ„æ•°é‡ç»´åº¦çš„æ•°æ®ã€‚ åˆ›å»ºMultiIndex MultiIndex å¯¹è±¡æ˜¯æ ‡å‡†Indexå¯¹è±¡çš„æ‰©å±•, ä½ å¯ä»¥å°† MultiIndex è§†ä¸ºå…ƒç»„æ„æˆçš„åˆ—è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç»„éƒ½æ˜¯å”¯ä¸€çš„, å®ƒä¸Indexçš„åŒºåˆ«æ˜¯, Index å¯ä»¥è§†ä¸ºæ•°å­—æˆ–è€…å­—ç¬¦ä¸²æ„æˆçš„åˆ—è¡¨ã€‚å¯ä»¥ä»æ•°ç»„åˆ—è¡¨ï¼ˆä½¿ç”¨MultiIndex.from_arraysï¼‰ï¼Œå…ƒç»„åˆ—è¡¨ï¼ˆä½¿ç”¨MultiIndex.from_tuplesï¼‰æˆ–äº¤å‰è¿­ä»£é›†ï¼ˆä½¿ç”¨MultiIndex.from_productï¼‰åˆ›å»ºMultiIndexã€‚å½“æ„é€ å‡½æ•°ä¼ é€’å…ƒç»„åˆ—è¡¨æ—¶ï¼Œå®ƒå°†å°è¯•è¿”å› MultiIndexã€‚ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†åˆ›å»º MultiIndexes çš„ä¸åŒæ–¹æ³•ã€‚ from_tuples åˆ›å»ºä¸€ä¸ªå…ƒç¥–æ„æˆçš„åˆ—è¡¨ arrays = [['bar', 'bar', 'baz', 'baz', 'foo', 'foo', 'qux', 'qux'], ['one', 'two', 'one', 'two', 'one', 'two', 'one', 'two']] tuples = list(zip(*arrays)) print(tuples) ''' [('bar', 'one'), ('bar', 'two'), ('baz', 'one'), ('baz', 'two'), ('foo', 'one'), ('foo', 'two'), ('qux', 'one'), ('qux', 'two')] ''' ä½¿ç”¨ from_tuples æ¥åˆ›å»º MultiIndex: arrays = [['bar', 'bar', 'baz', 'baz', 'foo', 'foo', 'qux', 'qux'], ['one', 'two', 'one', 'two', 'one', 'two', 'one', 'two']] tuples = list(zip(*arrays)) print(tuples) ''' [('bar', 'one'), ('bar', 'two'), ('baz', 'one'), ('baz', 'two'), ('foo', 'one'), ('foo', 'two'), ('qux', 'one'), ('qux', 'two')] ''' from_arrays å¦‚æœè¯´ from_tuples æ¥å—çš„å‚æ•°æ˜¯â€è¡Œâ€çš„åˆ—è¡¨, é‚£ä¹ˆ from_arrays æ¥å—çš„å‚æ•°æ˜¯å°±æ˜¯â€åˆ—â€çš„åˆ—è¡¨: arrays = [['bar', 'bar', 'baz', 'baz', 'foo', 'foo', 'qux', 'qux'], ['one', 'two', 'one', 'two', 'one', 'two', 'one', 'two']] index = pd.MultiIndex.from_arrays(arrays) s = pd.Series(np.random.randn(8), index=index) print(s) ''' bar one -0.268434 two -0.026027 baz one -0.658945 two 0.283218 foo one 1.054412 two 1.977076 qux one -0.563627 two -0.156421 dtype: float64 ''' ä¸è¿‡ä¸ºäº†ç®€ä¾¿, æˆ‘ä»¬é€šå¸¸å¯ä»¥ç›´æ¥åœ¨Seriesçš„æ„é€ å‡½æ•°ä¸­ä½¿ç”¨: arrays = [['bar', 'bar', 'baz', 'baz', 'foo', 'foo', 'qux', 'qux'], ['one', 'two', 'one', 'two', 'one', 'two', 'one', 'two']] s = pd.Series(np.random.randn(8), index=arrays) print(s) ''' bar one -1.411561 two 0.667025 baz one -0.079449 two -0.715518 foo one -1.844785 two 0.257104 qux one -0.776653 two -1.159284 dtype: float64 ''' from_product å‡å¦‚æˆ‘ä»¬æœ‰ä¸¤ä¸ª list , è¿™ä¸¤ä¸ª list å†…çš„å…ƒç´ ç›¸äº’äº¤å‰, ä¸¤ä¸¤æ­é…, è¿™å°±æ˜¯ä¸¤ä¸ª list çš„product: lists = [['bar', 'baz', 'foo', 'qux'], ['one', 'two']] index = pd.MultiIndex.from_product(lists, names=['first', 'second']) s = pd.Series(np.random.randn(len(index)), index=index) print(s) ''' first second bar one -1.309958 two 0.379085 baz one 0.739266 two -0.165164 foo one -0.022698 two -0.006190 qux one 0.299748 two -0.864639 dtype: float64 ''' MultiIndex.names ä½ å¯ä»¥ä¸º MultiIndex çš„å„ä¸ªå±‚èµ·åå­—, è¿™å°±æ˜¯ names å±æ€§: print(s.index.names) #['first', 'second'] s.index.names = ['FirstLevel', 'SecondLevel'] print(s.index.names) #['FirstLevel', 'SecondLevel'] MultiIndexå¯ä»¥ä½œä¸ºåˆ—åç§° Series å’Œ DataFrame çš„åˆ—åç§°å±æ€§å°±æ˜¯columns, ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª MultiIndex å¯¹è±¡: df = pd.DataFrame(np.random.randn(3, 8), index=['A', 'B', 'C'], columns=index) print(df) ''' FirstLevel bar baz ... foo qux SecondLevel one two one ... two one two A 1.127256 1.453003 0.025833 ... -1.258916 0.711659 -1.460118 B 1.589573 2.057785 0.028412 ... -1.678021 -0.662083 -1.044907 C -0.879705 0.730224 -0.003296 ... -0.446753 -1.694061 1.440663 [3 rows x 8 columns] ''' è·å–å„æ°´å¹³çš„å€¼ æ–¹æ³•get_level_valueså°†è¿”å›ç‰¹å®šçº§åˆ«çš„æ¯ä¸ªä½ç½®çš„æ ‡ç­¾å‘é‡ï¼š print(index.get_level_values(0)) ''' Index(['bar', 'bar', 'baz', 'baz', 'foo', 'foo', 'qux', 'qux'], dtype='object', name='FirstLevel') ''' å¦‚æœä½ ç»™ index è®¾ç½®äº†åç§°, é‚£ä¹ˆä½ å¯ä»¥ç›´æ¥ä½¿ç”¨åç§°æ¥è·å–æ°´å¹³å€¼: print(index.get_level_values('FirstLevel')) ''' Index(['bar', 'bar', 'baz', 'baz', 'foo', 'foo', 'qux', 'qux'], dtype='object', name='FirstLevel') ''' é€‰æ‹©æ•°æ® è¿™å¯èƒ½æ˜¯MultiIndexæœ€é‡è¦çš„åŠŸèƒ½ä¹‹ä¸€ã€‚ print(df) ''' FirstLevel bar baz ... foo qux SecondLevel one two one ... two one two A 1.134195 -0.351198 0.218614 ... -0.755923 0.129988 -0.052183 B -0.308971 1.399584 -0.894162 ... -1.022070 0.045872 1.539032 C -0.399760 0.351285 1.069002 ... -0.771437 2.350300 -0.922563 [3 rows x 8 columns] ''' è·å– FirstLevel æ˜¯ bar çš„æ‰€æœ‰æ•°æ® print(df['bar']) ''' SecondLevel one two A 0.204079 0.635272 B 1.691298 -0.449358 C -1.236855 -1.144767 ''' è·å–FirstLevelæ˜¯bar, SecondLevelæ˜¯oneçš„æ‰€æœ‰æ•°æ®: print(df['bar']['one']) ''' A 0.121725 B 1.130435 C -0.011153 Name: one, dtype: float64 ''' éœ€è¦æ³¨æ„çš„æ˜¯, ç»“æœé€‰æ‹©è¾“å‡ºçš„ç»“æœçš„columnså·²ç»æ”¹å˜: print(df['bar'].columns) #Index(['one', 'two'], dtype='object', name='SecondLevel') å¦‚æœä½ è¦é€‰æ‹©ç¬¬äºŒå±‚çš„åˆ—åä¸º one çš„æ‰€æœ‰æ•°æ®, ä½ éœ€è¦å€ŸåŠ© xs æ–¹æ³•: print(df.xs('bar', level=0, axis=1)) ''' SecondLevel one two A -1.493262 -0.704469 B 3.509268 -1.283146 C -0.056974 0.710284 ''' print(df.xs('one', level=1, axis=1)) ''' FirstLevel bar baz foo qux A 0.537299 -1.054771 0.144664 -0.940659 B -0.560000 -0.952308 -1.667759 -1.480754 C 0.733805 0.930315 -0.144840 -1.261983 ''' æˆ–è€…ä½¿ç”¨åç§°ä»£æ›¿æ•°å­—: print(df.xs('one', level='SecondLevel', axis='columns')) ''' FirstLevel bar baz foo qux A 0.537299 -1.054771 0.144664 -0.940659 B -0.560000 -0.952308 -1.667759 -1.480754 C 0.733805 0.930315 -0.144840 -1.261983 ''' axis, å®ƒä¸ä»…å¯ä»¥ç”¨æ¥é€‰æ‹©åˆ—, ä¹Ÿå¯ä»¥ç”¨æ¥é€‰æ‹©è¡Œ: print(s) ''' FirstLevel SecondLevel bar one 1.262375 two 0.211678 baz one -0.207278 two 0.386925 foo one -0.010342 two -1.775980 qux one -0.981227 two -2.159368 dtype: float64 ''' print(s.xs('one', level='SecondLevel', axis='index')) ''' FirstLevel bar 0.783906 baz 1.159497 foo -1.361565 qux -0.838874 dtype: float64 ''' é€‰æ‹©è¡Œ æŠŠ df è¿›è¡Œè½¬ç½®, ç„¶åçœ‹çœ‹ä¸€äº›é€‰æ‹©è¡Œçš„æ“ä½œ: df = df.T print(df) ''' A B C FirstLevel SecondLevel bar one 0.923159 3.412767 -2.821506 two 2.641013 0.229025 1.251807 baz one 0.900035 0.874848 0.246452 two -1.326872 0.647462 -0.088361 foo one 1.730885 -0.732980 -0.373840 two -1.369826 -1.532940 -0.204242 qux one 0.305318 0.929807 -0.331868 two 1.110960 -0.869984 0.990428 ''' é€‰æ‹© FirstLevel æ˜¯ bar, SecondLevel æ˜¯ two çš„æ•°æ®: print(df.loc[('bar', 'two')]) ''' A -0.096414 B 0.796829 C -0.571624 Name: (bar, two), dtype: float64 ''' å¤šé‡ç´¢å¼•çš„æ ‡ç­¾è¦ä¸€å…ƒç»„çš„å½¢å¼('bar', 'two')ï¼Œä¸èƒ½æ˜¯åˆ—è¡¨çš„å½¢å¼['bar', 'two'] ä¸‹é¢çš„ç”¨æ³•æ˜¯ç­‰æ•ˆçš„: print(df.loc['bar'].loc['two']) ''' A -0.755750 B 0.387714 C 1.164027 Name: two, dtype: float64 ''' é€‰æ‹©è¡Œçš„åŒæ—¶ä¹Ÿèƒ½é€‰æ‹©åˆ—: print(df.loc[('bar', 'two'), 'A']) #-0.5189738423458226 è¿˜èƒ½ä½¿ç”¨åˆ‡ç‰‡æ“ä½œ: print(df.loc['baz': 'foo']) ''' A B C FirstLevel SecondLevel baz one -1.507232 -0.207591 1.242952 two -0.424180 -1.741234 -1.205756 foo one 0.858520 1.594259 -1.314260 two -0.711255 0.356851 -0.276307 ''' æˆ–è®¸, ä½¿ç”¨æ›´å¤šçš„æ˜¯è¿™æ ·: print(df.loc[('bar', 'two'): ('baz', 'two')]) ''' FirstLevel SecondLevel bar two -1.293961 -0.931613 0.090003 baz one -0.509716 -0.802122 1.583681 two -0.613451 0.121745 0.895646 ''' æ¨èä½¿ç”¨xs, å®ƒå¯ä»¥ä½¿ä½ çš„ä»£ç æ›´å®¹æ˜“è¢«åˆ«äººç†è§£, è€Œä¸”é€‰æ‹©è¡Œå’Œåˆ—éƒ½ç”¨ç»Ÿä¸€çš„æ–¹å¼: print(df.xs('two', level='SecondLevel', axis='index')) ''' A B C FirstLevel bar -1.201396 -2.257291 0.831497 baz -1.204905 -0.351232 -0.025386 foo 0.987691 -0.454322 0.679079 qux 0.813230 0.073436 -0.951928 ''' MultiIndexå¯¹è±¡å±æ€§ m_index1=pd.Index([(\"A\",\"x1\"),(\"A\",\"x2\"),(\"B\",\"y1\"),(\"B\",\"y2\"),(\"B\",\"y3\")],name=[\"class1\",\"class2\"]) print(m_index1) ''' MultiIndex([('A', 'x1'), ('A', 'x2'), ('B', 'y1'), ('B', 'y2'), ('B', 'y3')], names=['class1', 'class2']) ''' df1=DataFrame(np.random.randint(1,10,(5,3)),index=m_index1) print(df1) ''' class1 class2 A x1 1 9 2 x2 5 3 2 B y1 8 8 6 y2 9 2 2 y3 5 6 8 ''' m_index=df1.index print(m_index[0]) # ('A', 'x1') print(m_index[1]) # ('A', 'x2') è°ƒç”¨.get_loc()å’Œ.get_indexer()è·å–æ ‡ç­¾çš„ä¸‹æ ‡ï¼š print(m_index.get_loc((\"A\",\"x2\"))) #1 print(m_index.get_indexer([(\"A\",\"x2\"),(\"B\",\"y1\"),\"nothing\"])) #[ 1 2 -1] MultiIndex å¯¹è±¡ä½¿ç”¨å¤šä¸ª Index å¯¹è±¡ä¿å­˜ç´¢å¼•ä¸­æ¯ä¸€çº§çš„æ ‡ç­¾ï¼š print(m_index.levels[0]) print(m_index.levels[1]) ''' Index(['A', 'B'], dtype='object', name='class1') Index(['x1', 'x2', 'y1', 'y2', 'y3'], dtype='object', name='class2') ''' MultiIndex å¯¹è±¡è¿˜æœ‰å±æ€§ labels ä¿å­˜æ ‡ç­¾çš„ä¸‹æ ‡ï¼š print(m_index.labels[0]) print(m_index.labels[1]) ''' [0 0 1 1 1] [0 1 2 3 4] ''' Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ ¹æ®æ¡ä»¶è·å–å…ƒç´ æ‰€åœ¨çš„ä½ç½®ï¼ˆç´¢å¼•ï¼‰.html":{"url":"Chapter2/Pandas æ ¹æ®æ¡ä»¶è·å–å…ƒç´ æ‰€åœ¨çš„ä½ç½®ï¼ˆç´¢å¼•ï¼‰.html","title":"Pandas æ ¹æ®æ¡ä»¶è·å–å…ƒç´ æ‰€åœ¨çš„ä½ç½®ï¼ˆç´¢å¼•ï¼‰","keywords":"","body":"Pandas æ ¹æ®æ¡ä»¶è·å–å…ƒç´ æ‰€åœ¨çš„ä½ç½®ï¼ˆç´¢å¼•ï¼‰ .index.tolist() åœ¨ dataframe ä¸­æ ¹æ®ä¸€å®šçš„æ¡ä»¶ï¼Œå¾—åˆ°ç¬¦åˆè¦æ±‚çš„æŸè¡Œå…ƒç´ æ‰€åœ¨çš„ä½ç½®ã€‚ df = pd.DataFrame({'BoolCol': [1, 2, 3, 3, 4], 'attr': [22, 33, 22, 44, 66] }, index=[10,20,30,40,50] ) print(df) ''' BoolCol attr 10 1 22 20 2 33 30 3 22 40 3 44 50 4 66 ''' a = df[(df.BoolCol==3)&(df.attr==22)].index.tolist() print(a) é€‰å–â€œBoolColâ€å–å€¼ä¸º3ä¸”â€œattrâ€å–å€¼ä¸º22çš„è¡Œï¼Œå¾—åˆ°è¯¥è¡Œåœ¨dfä¸­çš„ä½ç½® a = df[(df.BoolCol==3)&(df.attr==22)].index.tolist() # a=30 df.BoolCol==3 10 False 20 False 30 True 40 True 50 False Name: BoolCol, dtype: bool _temp = {'job':['farmer', 'teacher', 'worker', 'acter', 'present'], 'money':[3000, 7000, 5000, 100000, 66666]} df = pd.DataFrame(_temp) print(df) >> job money >>0 farmer 3000 >>1 teacher 7000 >>2 worker 5000 >>3 acter 100000 >>4 present 66666 a = df[(df['money']>10000)].index.tolist() print(a) >>[3, 4] Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ•°æ®åˆå¹¶ä¸é‡å¡‘.html":{"url":"Chapter2/Pandas æ•°æ®åˆå¹¶ä¸é‡å¡‘.html","title":"Pandas æ•°æ®åˆå¹¶ä¸é‡å¡‘","keywords":"","body":"Pandas æ•°æ®åˆå¹¶ä¸é‡å¡‘ pandas æ•°æ®çš„è¡Œæ›´æ–°ã€è¡¨åˆå¹¶ç­‰æ“ä½œï¼Œä¸€èˆ¬ç”¨åˆ°çš„æ–¹æ³•æœ‰ concatã€joinã€mergeã€‚ concat concat å‡½æ•°æ˜¯åœ¨ pandas åº•ä¸‹çš„æ–¹æ³•ï¼Œå¯ä»¥å°†æ•°æ®æ ¹æ®ä¸åŒçš„è½´ä½œç®€å•çš„èåˆ pd.concat(objs, axis=0, join='outer', join_axes=None, ignore_index=False, keys=None, levels=None, names=None, verify_integrity=False ) å‚æ•°è¯´æ˜ objs: seriesï¼Œdataframeæˆ–è€…æ˜¯panelæ„æˆçš„åºåˆ—lsit axisï¼š éœ€è¦åˆå¹¶é“¾æ¥çš„è½´ï¼Œ0æ˜¯è¡Œï¼Œ1æ˜¯åˆ— joinï¼šè¿æ¥çš„æ–¹å¼ innerï¼Œæˆ–è€…outer ç›¸åŒå­—æ®µçš„è¡¨é¦–å°¾ç›¸æ¥ import pandas as pd df1 = pd.DataFrame({'A': ['A0', 'A1', 'A2', 'A3'], 'B': ['B0', 'B1', 'B2', 'B3'], 'C': ['C0', 'C1', 'C2', 'C3'], 'D': ['D0', 'D1', 'D2', 'D3']}, index=[0, 1, 2, 3]) df2 = pd.DataFrame({'A': ['A4', 'A5', 'A6', 'A7'], 'B': ['B4', 'B5', 'B6', 'B7'], 'C': ['C4', 'C5', 'C6', 'C7'], 'D': ['D4', 'D5', 'D6', 'D7']}, index=[4, 5, 6, 7]) df3 = pd.DataFrame({'A': ['A8', 'A9', 'A10', 'A11'], 'B': ['B8', 'B9', 'B10', 'B11'], 'C': ['C8', 'C9', 'C10', 'C11'], 'D': ['D8', 'D9', 'D10', 'D11']}, index=[8, 9, 10, 11]) # ç°å°†è¡¨æ„æˆlistï¼Œç„¶ååœ¨ä½œä¸ºconcatçš„è¾“å…¥ frames = [df1, df2, df3] result = pd.concat(frames) print(result) å‚æ•°key è¦åœ¨ç›¸æ¥çš„æ—¶å€™åœ¨åŠ ä¸Šä¸€ä¸ªå±‚æ¬¡çš„ keyæ¥è¯†åˆ«æ•°æ®æºè‡ªäºå“ªå¼ è¡¨ï¼Œå¯ä»¥å¢åŠ  keyå‚æ•° result = pd.concat(frames, keys=['x', 'y', 'z']) ''' A B C D x 0 A0 B0 C0 D0 1 A1 B1 C1 D1 2 A2 B2 C2 D2 3 A3 B3 C3 D3 y 4 A4 B4 C4 D4 5 A5 B5 C5 D5 6 A6 B6 C6 D6 7 A7 B7 C7 D7 z 8 A8 B8 C8 D8 9 A9 B9 C9 D9 10 A10 B10 C10 D10 11 A11 B11 C11 D11 ''' æ¨ªå‘è¡¨æ‹¼æ¥ï¼ˆè¡Œå¯¹é½ï¼‰ å‚æ•° axis å½“ axis = 1 çš„æ—¶å€™ï¼Œconcat å°±æ˜¯è¡Œå¯¹é½ï¼Œç„¶åå°†ä¸åŒåˆ—åç§°çš„ä¸¤å¼ è¡¨åˆå¹¶ result = pd.concat([df1, df4], axis=1) å‚æ•° join åŠ ä¸Š joinå‚æ•°çš„å±æ€§ï¼Œå¦‚æœä¸ºinnerå¾—åˆ°çš„æ˜¯ä¸¤è¡¨çš„äº¤é›†ï¼Œå¦‚æœæ˜¯outerï¼Œå¾—åˆ°çš„æ˜¯ä¸¤è¡¨çš„å¹¶é›†ã€‚(è¡Œç´¢å¼•ç›¸åŒçš„è¡Œ) result = pd.concat([df1, df4], axis=1, join='inner') å‚æ•° join_axes å¦‚æœæœ‰join_axesçš„å‚æ•°ä¼ å…¥ï¼Œå¯ä»¥æŒ‡å®šæ ¹æ®é‚£ä¸ªè½´æ¥å¯¹é½æ•°æ® ä¾‹å¦‚æ ¹æ® df1 è¡¨å¯¹é½æ•°æ®ï¼Œå°±ä¼šä¿ç•™æŒ‡å®šçš„df1è¡¨çš„è½´ï¼Œç„¶åå°† df4 çš„è¡¨ä¸ä¹‹æ‹¼æ¥ result = pd.concat([df1, df4], axis=1, join_axes=[df1.index]) å‚æ•° ignore_index å¦‚æœä¸¤ä¸ªè¡¨çš„ index éƒ½æ²¡æœ‰å®é™…å«ä¹‰ï¼Œä½¿ç”¨ignore_indexå‚æ•°ï¼Œç½®trueï¼Œåˆå¹¶çš„ä¸¤ä¸ªè¡¨å°±ä¼šæ ¹æ®åˆ—å­—æ®µå¯¹é½ï¼Œç„¶ååˆå¹¶ã€‚æœ€åå†é‡æ–°æ•´ç†ä¸€ä¸ªæ–°çš„ indexã€‚ result=pd.concat([df1,df4],ignore_index=True) åˆå¹¶çš„åŒæ—¶å¢åŠ åŒºåˆ†æ•°æ®ç»„ å‰é¢æåˆ°çš„keyså‚æ•°å¯ä»¥ç”¨æ¥ç»™åˆå¹¶åçš„è¡¨å¢åŠ keyæ¥åŒºåˆ†ä¸åŒçš„è¡¨æ•°æ®æ¥æº ç›´æ¥ç”¨keyå‚æ•°å®ç° result = pd.concat(frames, keys=['x', 'y', 'z']) ''' A B C D x 0 A0 B0 C0 D0 1 A1 B1 C1 D1 2 A2 B2 C2 D2 3 A3 B3 C3 D3 y 4 A4 B4 C4 D4 5 A5 B5 C5 D5 6 A6 B6 C6 D6 7 A7 B7 C7 D7 z 8 A8 B8 C8 D8 9 A9 B9 C9 D9 10 A10 B10 C10 D10 11 A11 B11 C11 D11 ''' ä¼ å…¥å­—å…¸æ¥å¢åŠ åˆ†ç»„é”® pieces = {'x': df1, 'y': df2, 'z': df3} result = pd.concat(pieces) ''' A B C D x 0 A0 B0 C0 D0 1 A1 B1 C1 D1 2 A2 B2 C2 D2 3 A3 B3 C3 D3 y 4 A4 B4 C4 D4 5 A5 B5 C5 D5 6 A6 B6 C6 D6 7 A7 B7 C7 D7 z 8 A8 B8 C8 D8 9 A9 B9 C9 D9 10 A10 B10 C10 D10 11 A11 B11 C11 D11 ''' è¡¨æ ¼åˆ—å­—æ®µä¸åŒçš„è¡¨åˆå¹¶ å¦‚æœé‡åˆ°ä¸¤å¼ è¡¨çš„åˆ—å­—æ®µæœ¬æ¥å°±ä¸ä¸€æ ·ï¼Œä½†åˆæƒ³å°†ä¸¤ä¸ªè¡¨åˆå¹¶ï¼Œå…¶ä¸­æ— æ•ˆçš„å€¼ç”¨nanæ¥è¡¨ç¤ºã€‚é‚£ä¹ˆå¯ä»¥ä½¿ç”¨ ignore_indexæ¥å®ç°ã€‚ dicts = [{'A': 1, 'B': 2, 'C': 3, 'X': 4}, {'A': 5, 'B': 6, 'C': 7, 'Y': 8}] result = df1.append(dicts, ignore_index=True) append DataFrame.append(other, ignore_index=False, verify_integrity=False, sort=None ) otherï¼šDataFrameã€seriesã€dictã€listè¿™æ ·çš„æ•°æ®ç»“æ„ ignore_indexï¼šé»˜è®¤å€¼ä¸ºFalseï¼Œå¦‚æœä¸ºTrueåˆ™ä¸ä½¿ç”¨indexæ ‡ç­¾ verify_integrity ï¼šé»˜è®¤å€¼ä¸ºFalseï¼Œå¦‚æœä¸ºTrueå½“åˆ›å»ºç›¸åŒçš„indexæ—¶ä¼šæŠ›å‡ºValueErrorçš„å¼‚å¸¸ sortï¼šbooleanï¼Œé»˜è®¤æ˜¯Noneï¼Œè¯¥å±æ€§åœ¨pandasçš„0.23.0çš„ç‰ˆæœ¬æ‰å­˜åœ¨ã€‚ appendæ˜¯ series å’Œ dataframeçš„æ–¹æ³•ï¼Œä½¿ç”¨å®ƒå°±æ˜¯é»˜è®¤æ²¿ç€åˆ—è¿›è¡Œå‡­å€Ÿï¼ˆaxis = 0ï¼Œåˆ—å¯¹é½ï¼‰ result = df1.append(df2) appendæ·»åŠ å­—å…¸ import pandas as pd data = pd.DataFrame() a = {\"x\":1,\"y\":2} data = data.append(a,ignore_index=True) print(data) x y 0 1.0 2.0 appendæ·»åŠ series å¦‚æœä¸æ·»åŠ ignore_index=Trueï¼Œä¼šæŠ¥é”™æç¤ºTypeError: Can only append a Series if ignore_index=True or if the Series has a nameï¼Œå¦‚æœä¸æ·»åŠ ignore_index=Trueï¼Œä¹Ÿå¯ä»¥æ”¹æˆä»¥ä¸‹ä»£ç  import pandas as pd data = pd.DataFrame() series = pd.Series({\"x\":1,\"y\":2},name=\"a\") data = data.append(series) print(data) x y 0 1.0 2.0 appendæ·»åŠ list data = pd.DataFrame() a = [1,2,3] data = data.append(a) print(data) 0 0 1 1 2 2 3 å¦‚æœlistæ˜¯ä¸€ç»´çš„ï¼Œåˆ™æ˜¯ä»¥åˆ—çš„å½¢å¼æ¥è¿›è¡Œæ·»åŠ ï¼Œå¦‚æœlistæ˜¯äºŒç»´çš„åˆ™æ˜¯ä»¥è¡Œçš„å½¢å¼è¿›è¡Œæ·»åŠ çš„ ï¼Œå¦‚æœæ˜¯ä¸‰ç»´çš„åˆ™åªæ·»åŠ ä¸€ä¸ªå€¼ merge merge(left, right, how='inner', on=None, left_on=None, right_on=None, left_index=False, right_index=False, sort=True, suffixes=('_x', '_y'), copy=True, indicator=False ) onï¼šåˆ—åï¼Œjoinç”¨æ¥å¯¹é½çš„é‚£ä¸€åˆ—çš„åå­—ï¼Œç”¨åˆ°è¿™ä¸ªå‚æ•°çš„æ—¶å€™ä¸€å®šè¦ä¿è¯å·¦è¡¨å’Œå³è¡¨ç”¨æ¥å¯¹é½çš„é‚£ä¸€åˆ—éƒ½æœ‰ç›¸åŒçš„åˆ—åã€‚ left_onï¼šå·¦è¡¨å¯¹é½çš„åˆ—ï¼Œå¯ä»¥æ˜¯åˆ—åï¼Œä¹Ÿå¯ä»¥æ˜¯å’ŒdataframeåŒæ ·é•¿åº¦çš„arraysã€‚ right_onï¼šå³è¡¨å¯¹é½çš„åˆ—ï¼Œå¯ä»¥æ˜¯åˆ—åï¼Œä¹Ÿå¯ä»¥æ˜¯å’ŒdataframeåŒæ ·é•¿åº¦çš„arraysã€‚ left_index/ right_index: å¦‚æœæ˜¯ True çš„ haunted ä»¥ index ä½œä¸ºå¯¹é½çš„key howï¼šæ•°æ®èåˆçš„æ–¹æ³•ã€‚ sortï¼šæ ¹æ® dataframe åˆå¹¶çš„ keys æŒ‰å­—å…¸é¡ºåºæ’åºï¼Œé»˜è®¤æ˜¯ï¼Œå¦‚æœç½®falseå¯ä»¥æé«˜è¡¨ç°ã€‚ mergeçš„é»˜è®¤åˆå¹¶æ–¹æ³•ï¼š merge ç”¨äºè¡¨å†…éƒ¨åŸºäº index-on-index å’Œ index-on-column(s) çš„åˆå¹¶ï¼Œä½†é»˜è®¤æ˜¯åŸºäº index æ¥åˆå¹¶ã€‚ é€šè¿‡onæŒ‡å®šæ•°æ®åˆå¹¶å¯¹é½çš„åˆ— left = pd.DataFrame({'key1': ['K0', 'K0', 'K1', 'K2'], 'key2': ['K0', 'K1', 'K0', 'K1'], 'A': ['A0', 'A1', 'A2', 'A3'], 'B': ['B0', 'B1', 'B2', 'B3']}) right = pd.DataFrame({'key1': ['K0', 'K1', 'K1', 'K2'], 'key2': ['K0', 'K0', 'K0', 'K0'], 'C': ['C0', 'C1', 'C2', 'C3'], 'D': ['D0', 'D1', 'D2', 'D3']}) result = pd.merge(left, right, on=['key1', 'key2']) ''' key1 key2 A B C D 0 K0 K0 A0 B0 C0 D0 1 K1 K0 A2 B2 C1 D1 2 K1 K0 A2 B2 C2 D2 ''' æ²¡æœ‰æŒ‡å®šhowçš„è¯é»˜è®¤ä½¿ç”¨inneræ–¹æ³•ã€‚ howçš„æ–¹æ³•æœ‰ï¼š left åªä¿ç•™å·¦è¡¨çš„æ‰€æœ‰æ•°æ® result = pd.merge(left, right, how='left', on=['key1', 'key2']) right åªä¿ç•™å³è¡¨çš„æ‰€æœ‰æ•°æ® result = pd.merge(left, right, how='right', on=['key1', 'key2']) outer ä¿ç•™ä¸¤ä¸ªè¡¨çš„æ‰€æœ‰ä¿¡æ¯ result = pd.merge(left, right, how='outer', on=['key1', 'key2']) inner åªä¿ç•™ä¸¤ä¸ªè¡¨ä¸­å…¬å…±éƒ¨åˆ†çš„ä¿¡æ¯ result = pd.merge(left, right, how='inner', on=['key1', 'key2']) suffixåç¼€å‚æ•° å¦‚æœå’Œè¡¨åˆå¹¶çš„è¿‡ç¨‹ä¸­é‡åˆ°æœ‰ä¸€åˆ—ä¸¤ä¸ªè¡¨éƒ½åŒåï¼Œä½†æ˜¯å€¼ä¸åŒï¼Œåˆå¹¶çš„æ—¶å€™åˆéƒ½æƒ³ä¿ç•™ä¸‹æ¥ï¼Œå°±å¯ä»¥ç”¨suffixesç»™æ¯ä¸ªè¡¨çš„é‡å¤åˆ—åå¢åŠ åç¼€ã€‚ result = pd.merge(left, right, on='k', suffixes=['_l', '_r']) å¦å¤–è¿˜æœ‰lsuffix å’Œ rsuffixåˆ†åˆ«æŒ‡å®šå·¦è¡¨çš„åç¼€å’Œå³è¡¨çš„åç¼€ã€‚ join dataframe å†…ç½®çš„joinæ–¹ æ³•æ˜¯ä¸€ç§å¿«é€Ÿåˆå¹¶çš„æ–¹æ³•ã€‚å®ƒé»˜è®¤ä»¥index ä½œä¸ºå¯¹é½çš„åˆ—ã€‚ joinä¸­çš„ how å‚æ•°å’Œ merge ä¸­çš„how å‚æ•°ä¸€æ ·ï¼Œç”¨æ¥æŒ‡å®šè¡¨åˆå¹¶ä¿ç•™æ•°æ®çš„è§„åˆ™ã€‚ä¸»è¦ç”¨äºç´¢å¼•ä¸Šçš„åˆå¹¶ join(other, on=None, how='left', lsuffix='', rsuffix='', sort=False) å‚æ•° on åœ¨å®é™…åº”ç”¨ä¸­å¦‚æœå³è¡¨çš„ç´¢å¼•å€¼æ­£æ˜¯å·¦è¡¨çš„æŸä¸€åˆ—çš„å€¼ï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡å°† å³è¡¨çš„ç´¢å¼• å’Œ å·¦è¡¨çš„åˆ— å¯¹é½åˆå¹¶è¿™æ ·çµæ´»çš„æ–¹å¼è¿›è¡Œåˆå¹¶ã€‚ In [59]: left = pd.DataFrame({'A': ['A0', 'A1', 'A2', 'A3'], ....: 'B': ['B0', 'B1', 'B2', 'B3'], ....: 'key': ['K0', 'K1', 'K0', 'K1']}) ....: In [60]: right = pd.DataFrame({'C': ['C0', 'C1'], ....: 'D': ['D0', 'D1']}, ....: index=['K0', 'K1']) ....: In [61]: result = left.join(right, on='key') å‚è€ƒ PANDAS æ•°æ®åˆå¹¶ä¸é‡å¡‘ pandasçš„DataFrameçš„appendæ–¹æ³•è¯¦ç»†ä»‹ç» Update timeï¼š 2020-05-25 "},"Chapter2/Pandas è½´æ—‹è½¬stackå’Œunstack.html":{"url":"Chapter2/Pandas è½´æ—‹è½¬stackå’Œunstack.html","title":"Pandas è½´æ—‹è½¬stackå’Œunstack","keywords":"","body":"Pandas è½´æ—‹è½¬stackå’Œunstack pandas çš„ DataFrame çš„è½´æ—‹è½¬æ“ä½œï¼Œstack å’Œ unstack é¦–å…ˆï¼Œè¦çŸ¥é“ä»¥ä¸‹äº”ç‚¹ï¼š stackï¼šå°†æ•°æ®çš„åˆ—â€œæ—‹è½¬â€ä¸ºè¡Œ unstackï¼šå°†æ•°æ®çš„è¡Œâ€œæ—‹è½¬â€ä¸ºåˆ— stackå’Œunstacké»˜è®¤æ“ä½œä¸ºæœ€å†…å±‚ stackå’Œunstacké»˜è®¤æ—‹è½¬è½´çš„çº§åˆ«å°†ä¼šæˆæœç»“æœä¸­çš„æœ€ä½çº§åˆ«ï¼ˆæœ€å†…å±‚ï¼‰ stackå’Œunstackä¸ºä¸€ç»„é€†è¿ç®—æ“ä½œ åˆ›å»ºDataFrame,è¡Œç´¢å¼•åä¸ºstateï¼Œåˆ—ç´¢å¼•åä¸ºnumber import pandas as pd import numpy as np data = pd.DataFrame(np.arange(6).reshape((2, 3)), index=pd.Index(['Ohio', 'Colorado'], name='state'), columns=pd.Index(['one', 'two', 'three'], name='number')) data å°†DataFrameçš„åˆ—æ—‹è½¬ä¸ºè¡Œï¼Œå³stackæ“ä½œã€‚ ä»ç»“æœæ¥ç†è§£ä¸Šè¿°ç‚¹4stack æ“ä½œåå°†åˆ—ç´¢å¼•numberæ—‹è½¬ä¸ºè¡Œç´¢å¼•ï¼Œå¹¶ä¸”ç½®äºè¡Œç´¢å¼•çš„æœ€å†…å±‚ï¼ˆå¤–å±‚ä¸ºç´¢å¼•stateï¼‰ï¼Œä¹Ÿå°±æ˜¯å°†æ—‹è½¬è½´ï¼ˆnumberï¼‰çš„ç»“æœç½®äº æœ€ä½çº§åˆ«ã€‚ å°†DataFrameçš„è¡Œæ—‹è½¬ä¸ºåˆ—ï¼Œå³unstackæ“ä½œã€‚ result.unstack() unstackæ“ä½œé»˜è®¤å°†å†…å±‚ç´¢å¼•numberæ—‹è½¬ä¸ºåˆ—ç´¢å¼•ã€‚ åŒæ—¶ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šåˆ†å±‚çº§åˆ«æˆ–è€…ç´¢å¼•åç§°æ¥æŒ‡å®šæ“ä½œçº§åˆ«ï¼Œä¸‹é¢åšæ³•åŒæ ·ä¼šå¾—åˆ°ä¸Šé¢çš„ç»“æœã€‚ stack å’Œ unstack é€†è¿ç®— s1 = pd.Series([0,1,2,3],index=list('abcd')) s2 = pd.Series([4,5,6],index=list('cde')) data2 = pd.concat([s1,s2],keys=['one','two']) data2 data2.unstack() data2.unstack().stack() å‚è€ƒ ã€Pythonã€‘pandasè½´æ—‹è½¬stackå’Œunstackç”¨æ³•è¯¦è§£ Update timeï¼š 2020-05-25 "},"Chapter2/Pandas ç¼ºå¤±å€¼å¤„ç†.html":{"url":"Chapter2/Pandas ç¼ºå¤±å€¼å¤„ç†.html","title":"Pandas ç¼ºå¤±å€¼å¤„ç†","keywords":"","body":"Pandas ç¼ºå¤±å€¼å¤„ç† åœ¨å®é™…åº”ç”¨ä¸­å¯¹äºæ•°æ®è¿›è¡Œåˆ†æçš„æ—¶å€™ï¼Œç»å¸¸èƒ½çœ‹è§ç¼ºå¤±å€¼ï¼Œä¸‹å¦‚ä½•åˆ©ç”¨pandas æ¥å¤„ç†ç¼ºå¤±å€¼ã€‚å¸¸è§çš„ç¼ºå¤±å€¼å¤„ç†æ–¹å¼æœ‰ï¼Œè¿‡æ»¤ã€å¡«å……ã€‚ ç¼ºå¤±å€¼çš„åˆ¤æ–­ pandas ä½¿ç”¨æµ®ç‚¹å€¼ NaN(Not a Number)è¡¨ç¤ºæµ®ç‚¹æ•°å’Œéæµ®ç‚¹æ•°ç»„ä¸­çš„ç¼ºå¤±å€¼ï¼ŒåŒæ—¶ pythonå†…ç½®Noneå€¼ä¹Ÿä¼šè¢«å½“ä½œæ˜¯ç¼ºå¤±å€¼ã€‚ DataFrame.dropna() DataFrame.dropna(axis=0, how='any', thresh=None, subset=None, inplace=False ) axis: ç»´åº¦ï¼Œaxis=0 è¡¨ç¤ºindexè¡Œ, axis=1è¡¨ç¤ºcolumnsåˆ—ï¼Œé»˜è®¤ä¸º0 how: \"all\"è¡¨ç¤ºè¿™ä¸€è¡Œæˆ–åˆ—ä¸­çš„å…ƒç´ å…¨éƒ¨ç¼ºå¤±ï¼ˆä¸ºnanï¼‰æ‰åˆ é™¤è¿™ä¸€è¡Œæˆ–åˆ—ï¼Œ\"any\"è¡¨ç¤ºè¿™ä¸€è¡Œæˆ–åˆ—ä¸­åªè¦æœ‰å…ƒç´ ç¼ºå¤±ï¼Œå°±åˆ é™¤è¿™ä¸€è¡Œæˆ–åˆ— thresh:ä¸€è¡Œæˆ–ä¸€åˆ—ä¸­è‡³å°‘å‡ºç°äº†threshä¸ªæ‰åˆ é™¤ã€‚ subsetï¼šåœ¨æŸäº›åˆ—çš„å­é›†ä¸­é€‰æ‹©å‡ºç°äº†ç¼ºå¤±å€¼çš„åˆ—åˆ é™¤ï¼Œä¸åœ¨å­é›†ä¸­çš„å«æœ‰ç¼ºå¤±å€¼å¾—åˆ—æˆ–è¡Œä¸ä¼šåˆ é™¤ï¼ˆæœ‰axiså†³å®šæ˜¯è¡Œè¿˜æ˜¯åˆ—ï¼‰ inplaceï¼šåˆ·é€‰è¿‡ç¼ºå¤±å€¼å¾—æ–°æ•°æ®æ˜¯å­˜ä¸ºå‰¯æœ¬è¿˜æ˜¯ç›´æ¥åœ¨åŸæ•°æ®ä¸Šè¿›è¡Œä¿®æ”¹ã€‚ é»˜è®¤å‚æ•°ï¼šåˆ é™¤è¡Œï¼Œåªè¦æœ‰ç©ºå€¼å°±ä¼šåˆ é™¤ï¼Œä¸æ›¿æ¢ã€‚ df = pd.DataFrame({\"name\": ['Alfred', 'Batman', 'Catwoman'], \"toy\": [np.nan, 'Batmobile', 'Bullwhip'], \"born\": [pd.NaT, pd.Timestamp(\"1940-04-25\"), pd.NaT]}) # print(df) ''' name toy born 0 Alfred NaN NaT 1 Batman Batmobile 1940-04-25 2 Catwoman Bullwhip NaT ''' print(df.dropna()) ''' name toy born 1 Batman Batmobile 1940-04-25 ''' print(df) ''' name toy born 0 Alfred NaN NaT 1 Batman Batmobile 1940-04-25 2 Catwoman Bullwhip NaT ''' #delete colums print(df.dropna(axis=1) )#delete co ''' name 0 Alfred 1 Batman 2 Catwoman ''' #\"æ‰€æœ‰å€¼å…¨ä¸ºç¼ºå¤±å€¼æ‰åˆ é™¤\" print(df.dropna(how='all')) ''' name toy born 0 Alfred NaN NaT 1 Batman Batmobile 1940-04-25 2 Catwoman Bullwhip NaT ''' #\"è‡³å°‘å‡ºç°è¿‡ä¸¤ä¸ªç¼ºå¤±å€¼æ‰åˆ é™¤\" print(df.dropna(thresh=2)) ''' name toy born 1 Batman Batmobile 1940-04-25 2 Catwoman Bullwhip NaT ''' #\"åˆ é™¤è¿™ä¸ªsubsetä¸­çš„å«æœ‰ç¼ºå¤±å€¼çš„è¡Œæˆ–åˆ—\" print (df.dropna(subset=['name', 'born'])) ''' name toy born 1 Batman Batmobile 1940-04-25 ''' DataFrame.fillna() DataFrame.fillna(value=None, method=None, axis=None, inplace=False, limit=None, downcast=None, **kwargs ) å‡½æ•°ä½œç”¨ï¼šå¡«å……ç¼ºå¤±å€¼ value:éœ€è¦ç”¨ä»€ä¹ˆå€¼å»å¡«å……ç¼ºå¤±å€¼ axis:ç¡®å®šå¡«å……ç»´åº¦ï¼Œä»è¡Œå¼€å§‹æˆ–æ˜¯ä»åˆ—å¼€å§‹ methodï¼šffill:ç”¨ç¼ºå¤±å€¼å‰é¢çš„ä¸€ä¸ªå€¼ä»£æ›¿ç¼ºå¤±å€¼ï¼Œå¦‚æœaxis =1ï¼Œé‚£ä¹ˆå°±æ˜¯æ¨ªå‘çš„å‰é¢çš„å€¼æ›¿æ¢åé¢çš„ç¼ºå¤±å€¼ï¼Œå¦‚æœaxis=0ï¼Œé‚£ä¹ˆåˆ™æ˜¯ä¸Šé¢çš„å€¼æ›¿æ¢ä¸‹é¢çš„ç¼ºå¤±å€¼ã€‚backfill/bfillï¼Œç¼ºå¤±å€¼åé¢çš„ä¸€ä¸ªå€¼ä»£æ›¿å‰é¢çš„ç¼ºå¤±å€¼ã€‚ æ³¨æ„è¿™ä¸ªå‚æ•°ä¸èƒ½ä¸valueåŒæ—¶å‡ºç° limit: ç¡®å®šå¡«å……çš„ä¸ªæ•°ï¼Œå¦‚æœlimit=2ï¼Œåˆ™åªå¡«å……ä¸¤ä¸ªç¼ºå¤±å€¼ã€‚ df = pd.DataFrame([[np.nan, 2, np.nan, 0], [3, 4, np.nan, 1], [np.nan, np.nan, np.nan, 5], [np.nan, 3, np.nan, 4]], columns=list('ABCD')) print(df) ''' A B C D 0 NaN 2.0 NaN 0 1 3.0 4.0 NaN 1 2 NaN NaN NaN 5 3 NaN 3.0 NaN 4 ''' #\"æ¨ªå‘ç”¨ç¼ºå¤±å€¼å‰é¢çš„å€¼æ›¿æ¢ç¼ºå¤±å€¼\" print(df.fillna(axis=1, method='ffill')) ''' A B C D 0 NaN 2.0 2.0 0.0 1 3.0 4.0 4.0 1.0 2 NaN NaN NaN 5.0 3 NaN 3.0 3.0 4.0 ''' #\"çºµå‘ç”¨ç¼ºå¤±å€¼ä¸Šé¢çš„å€¼æ›¿æ¢ç¼ºå¤±å€¼\" print(df.fillna(axis=0,method='ffill')) ''' A B C D 0 NaN 2.0 NaN 0 1 3.0 4.0 NaN 1 2 3.0 4.0 NaN 5 3 3.0 3.0 NaN 4 ''' print(df.fillna(0)) ''' A B C D 0 0.0 2.0 0.0 0 1 3.0 4.0 0.0 1 2 0.0 0.0 0.0 5 3 0.0 3.0 0.0 4 ''' ä¸åŒçš„åˆ—ç”¨ä¸åŒçš„å€¼å¡«å……ï¼š,å¯ä»¥é€šè¿‡ä¸€ä¸ªå­—å…¸ç”¨fillna,å®ç°å¯¹ä¸åŒçš„åˆ—å¡«å……ä¸åŒçš„å€¼ # ä¸åŒçš„åˆ—ç”¨ä¸åŒçš„å€¼å¡«å……ï¼š values={'A':0,'B':1,'C':2,'D':3} print(df.fillna(value=values)) ''' A B C D 0 0.0 2.0 2.0 0 1 3.0 4.0 2.0 1 2 0.0 1.0 2.0 5 3 0.0 3.0 2.0 4 ''' DataFrame.isna() åˆ¤æ–­æ˜¯ä¸æ˜¯ç¼ºå¤±å€¼ï¼š df = pd.DataFrame({'age':[5, 6,np.NaN], 'born':[pd.NaT, pd.Timestamp('1939-05-27'), pd.Timestamp('1929-05-27')], 'name':['alf', 'daes',''], 'toy':[None, 'asyeg','aued'] }) df.isna() age born name toy 0 False True False True 1 False False False False 2 True False False False isnull åŒä¸Šã€‚ df = pd.DataFrame([[np.nan, 2, np.nan, 0], [3, 4, \"\", 1], [np.nan, np.nan, np.nan, 5], [np.nan, 3, \"\", 4]], columns=list('ABCD')) print(df) ''' A B C D 0 NaN 2.0 NaN 0 1 3.0 4.0 1 2 NaN NaN NaN 5 3 NaN 3.0 4 ''' å¦‚ä¸Šï¼Œç¼ºå¤±å€¼æ˜¯NANï¼Œç©ºå€¼æ˜¯æ²¡æœ‰æ˜¾ç¤ºã€‚ æ›¿æ¢ç©ºå€¼ä»£ç ï¼šéœ€è¦æŠŠå«æœ‰ç©ºå€¼çš„é‚£ä¸€åˆ—æå‡ºæ¥å•ç‹¬å¤„ç†ï¼Œç„¶ååœ¨æ”¾è¿›å»å°±å¥½ã€‚ clean_z = df['C'].fillna(0) clean_z[clean_z==''] = 'hello' df['C'] = clean_z print(df) ''' A B C D 0 NaN 2.0 0 0 1 3.0 4.0 hello 1 2 NaN NaN 0 5 3 NaN 3.0 hello 4 ''' Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ•°æ®æ’åº.html":{"url":"Chapter2/Pandas æ•°æ®æ’åº.html","title":"Pandas æ•°æ®æ’åº","keywords":"","body":"Pandas æ•°æ®æ’åº æœ‰çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥è¦æ ¹æ®ç´¢å¼•çš„å¤§å°æˆ–è€…å€¼çš„å¤§å°å¯¹Serieså’ŒDataFrameè¿›è¡Œæ’åå’Œæ’åºã€‚ æ ¹æ®æ¡ä»¶å¯¹Serieså¯¹è±¡æˆ–DataFrameå¯¹è±¡çš„å€¼æ’åºï¼ˆsortingï¼‰å’Œæ’å(ranking)æ˜¯ä¸€ç§é‡è¦çš„å†…ç½®è¿ç®—ã€‚ ä½¿ç”¨ pandas å¯¹è±¡çš„ï¼šsort_index()/ sort_values()/ rank()æ–¹æ³•ã€‚ Seriesæ’åº sort_index æ–¹æ³•å¯ä»¥æ ¹æ®è¡Œæˆ–åˆ—çš„ç´¢å¼•æŒ‰ç…§å­—å…¸çš„é¡ºåºè¿›è¡Œæ’åºï¼Œè¿”å›ä¸€ä¸ªå·²æ’ çš„æ–°å¯¹è±¡ sort_index æŒ‰ç´¢å¼•è¿›è¡Œæ’åº #å®šä¹‰ä¸€ä¸ªSeries s = Series([1,2,3],index=[\"a\",\"c\",\"b\"]) #å¯¹Seriesçš„ç´¢å¼•è¿›è¡Œæ’åºï¼Œé»˜è®¤æ˜¯å‡åº print(s.sort_index()) ''' a 1 b 3 c 2 ''' #å¯¹ç´¢å¼•è¿›è¡Œé™åºæ’åº print(s.sort_index(ascending=False)) ''' c 2 b 3 a 1 ''' sort_valuesæŒ‰å€¼è¿›è¡Œæ’åº DataFrame.sort_values(by, axis=0, ascending=True, inplace=False, kind='quicksort', na_position='last' ) axisè¿™ä¸ªå‚æ•°çš„é»˜è®¤å€¼ä¸º0ï¼ŒåŒ¹é…çš„æ˜¯indexï¼Œè·¨è¡Œè¿›è¡Œæ’åºï¼Œå½“axis=1æ—¶ï¼ŒåŒ¹é…çš„æ˜¯columnsï¼Œè·¨åˆ—è¿›è¡Œæ’åº byè¿™ä¸ªå‚æ•°è¦æ±‚ä¼ å…¥ä¸€ä¸ªå­—ç¬¦æˆ–è€…æ˜¯ä¸€ä¸ªå­—ç¬¦åˆ—è¡¨ï¼Œç”¨æ¥æŒ‡å®šæŒ‰ç…§axisçš„ä¸­çš„å“ªä¸ªå…ƒç´ æ¥è¿›è¡Œæ’åº ascendingè¿™ä¸ªå‚æ•°çš„é»˜è®¤å€¼æ˜¯Trueï¼ŒæŒ‰ç…§å‡åºæ’åºï¼Œå½“ä¼ å…¥Falseæ—¶ï¼ŒæŒ‰ç…§é™åºè¿›è¡Œæ’åˆ— kindè¿™ä¸ªå‚æ•°è¡¨ç¤ºæŒ‰ç…§ä»€ä¹ˆæ ·ç®—æ³•æ¥è¿›è¡Œæ’åºï¼Œé»˜è®¤å€¼æ˜¯quicksortï¼ˆå¿«é€Ÿæ’åºï¼‰ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥mergesortï¼ˆå½’å¹¶æ’åºï¼‰æˆ–è€…æ˜¯heapsortï¼ˆå †æ’åºï¼‰ï¼Œè‡³äºå…·ä½“æ¯ç§ç®—æ³•æ˜¯å¦‚ä½•å®ç°çš„ï¼Œæˆ‘ä»¬è¿™é‡ŒæŒ‰ä¸‹ä¸è¡¨ï¼ŒåŒæ ·çš„ï¼Œå¯¹äºinplaceè¿™ä¸ªå‚æ•°æˆ‘ä»¬ä¹Ÿä¸åšè®¨è®ºå¯¹äºæ¶‰åŠåˆ°çš„In-place algorithmï¼ˆåŸåœ°ç®—æ³•ï¼‰æ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹è¿™é‡Œ æœ€åä¸€ä¸ªå‚æ•°na_positionæ˜¯é’ˆå¯¹DataFrameä¸­çš„ç©ºç¼ºå€¼çš„ï¼Œé»˜è®¤å€¼æ˜¯lastè¡¨ç¤ºå°†ç©ºç¼ºå€¼æ”¾åœ¨æ’åºçš„æœ€åï¼Œä¹Ÿå¯ä»¥ä¼ å…¥firstæ”¾åœ¨æœ€å‰ï¼š s = Series([np.nan,1,7,2,0],index=[\"a\",\"c\",\"e\",\"b\",\"d\"]) #å¯¹Seriesçš„å€¼è¿›è¡Œæ’åºï¼Œé»˜è®¤æ˜¯æŒ‰å€¼çš„å‡åºè¿›è¡Œæ’åºçš„ print(s.sort_values()) ''' d 0.0 c 1.0 b 2.0 e 7.0 a NaN ''' #å¯¹Seiresçš„å€¼è¿›è¡Œé™åºæ’åº print(s.sort_values(ascending=False)) ''' e 7.0 b 2.0 c 1.0 d 0.0 a NaN ''' NaNå€¼ä¼šæ”¾åœ¨Seriesæœ«å°¾ se4=pd.Series([3,np.nan,-7,np.nan,5]) se4.sort_values() 2 -7.0 0 3.0 4 5.0 1 NaN 3 NaN dtype: float64 DataFrameæ’åº é€šè¿‡axiså‚æ•°å¯ä»¥å¯¹ä»»æ„è½´æ’åº df1=pd.DataFrame(np.arange(9).reshape(3,3),index=list(\"bac\"),columns=list(\"yzx\")) print(df1) ''' y z x b 0 1 2 a 3 4 5 c 6 7 8 ''' print(df1.sort_index()) ''' y z x a 3 4 5 b 0 1 2 c 6 7 8 ''' print(df1.sort_index(axis=1)) ''' x y z b 2 0 1 a 5 3 4 c 8 6 7 ''' æ ¹æ®ä¸€ä¸ªåˆ—çš„å€¼æ¥æ’åº df2=pd.DataFrame({'a':[20,3,3],'b':[1,-6,18]}) print(df2.sort_values(by='b')) ''' a b 1 3 -6 0 20 1 2 3 18 ''' å¯¹å¤šä¸ªåˆ—æ¥æ’åº df = DataFrame(np.arange(20).reshape(5,4),index=[3,1,2,4,6],columns=['d','c','a','b']) print(df.sort_index(ascending=False)) # é™åºæ’åˆ— ''' d c a b 6 16 17 18 19 4 12 13 14 15 3 0 1 2 3 2 8 9 10 11 1 4 5 6 7 ''' rank( )å‡½æ•° rank()å‡½æ•°è¿”å›ä»å°åˆ°å¤§æ’åºçš„ä¸‹æ ‡ DataFrame.rank(axis=0, method='average', numeric_only=None, na_option='keep', ascending=True, pct=False ) axisï¼šè®¾ç½®æ²¿ç€å“ªä¸ªè½´è®¡ç®—æ’åï¼ˆ0æˆ–è€…1) numeric_onlyï¼šæ˜¯å¦ä»…ä»…è®¡ç®—æ•°å­—å‹çš„columnsï¼Œå¸ƒå°”å€¼ na_optionï¼šNaNå€¼æ˜¯å¦å‚ä¸æ’åºåŠå¦‚ä½•æ’åºï¼ˆâ€˜keepâ€™ï¼Œâ€˜top'ï¼Œâ€™bottom'ï¼‰ ascendingï¼šè®¾å®šå‡åºæ’è¿˜æ˜¯é™åºæ’ pctï¼šæ˜¯å¦ä»¥æ’åçš„ç™¾åˆ†æ¯”æ˜¾ç¤ºæ’åï¼ˆæ‰€æœ‰æ’åä¸æœ€å¤§æ’åçš„ç™¾åˆ†æ¯”ï¼‰ methodï¼šå–å€¼å¯ä»¥ä¸º'average'ï¼Œ'first'ï¼Œ'min'ï¼Œ 'max'ï¼Œ'dense'ï¼Œ \"first\": é¡¾åæ€ä¹‰ï¼Œç¬¬ä¸€ä¸ªï¼Œè°å‡ºç°çš„ä½ç½®é å‰ï¼Œè°çš„æ’åé å‰ã€‚æå››å’Œç‹äº”çš„æˆç»©éƒ½ä¸º30ï¼Œä½†æ˜¯æå››å‡ºç°åœ¨ç‹äº”çš„å‰é¢ï¼Œæ‰€ä»¥æå››çš„æ’åé å‰ \"min\": å½“method=â€œminâ€æ—¶ï¼Œæˆç»©ç›¸åŒçš„åŒå­¦ï¼Œå–åœ¨é¡ºåºæ’åä¸­æœ€å°çš„é‚£ä¸ªæ’åä½œä¸ºè¯¥å€¼çš„æ’åï¼Œæå››å’Œç‹äº”åŒå­¦æ’ååˆ†åˆ«ä¸º2å’Œ3ï¼Œé‚£ä¹ˆå½“methodä¸ºminæ—¶ï¼Œå–2å’Œ3çš„æœ€å°çš„é‚£ä¸ªä½œä¸ºç¬¬2åä½œä¸ºæˆç»©30çš„æ’åã€‚ \"dense\": æ˜¯å¯†é›†çš„æ„æ€ï¼Œå³ç›¸åŒæˆç»©çš„åŒå­¦æ’åç›¸åŒï¼Œå…¶ä»–ä¾æ¬¡åŠ 1å³å¯ã€‚ averageï¼Œæˆç»©ç›¸åŒæ—¶ï¼Œå–é¡ºåºæ’åä¸­æ‰€æœ‰åæ¬¡ä¹‹å’Œé™¤ä»¥è¯¥æˆç»©çš„ä¸ªæ•°ï¼Œå³ä¸ºè¯¥æˆç»©çš„åæ¬¡ï¼›æ¯”å¦‚ä¸Šè¿°æ’åä¸­ï¼Œ30æ’åä¸º2,3ï¼Œé‚£ä¹ˆ 30çš„æ’å = ï¼ˆ2+3ï¼‰/2=2.5ï¼Œæˆç»©ä¸º50çš„åŒå­¦åªæœ‰1ä¸ªï¼Œä¸”æ’åä¸º1ï¼Œé‚£50çš„æ’åå°±ä½1/1=1ã€‚ maxï¼Œå’Œminä¸€æ ·ä¹Ÿæ˜¯è·³è·ƒæ’åçš„ä¸€ç§ï¼Œæˆç»©ç›¸åŒæ—¶å–é¡ºåºæ’åä¸­æ’åæœ€å¤§çš„ä½œä¸ºè¯¥æˆç»©çš„åæ¬¡ï¼Œåœ¨é¡ºåºæ’åä¸­ï¼Œ30æœ€å¤§çš„æ’åä¸º3ï¼Œé‚£ä¹ˆå½“å‚æ•°ä¸ºmaxæ—¶ï¼Œ30çš„æ’å=3ï¼Œæ­¤æ—¶ï¼Œæå››å’Œç‹äº”çš„æ’åéƒ½ä¸ºç¬¬3åäº†ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œrankæ˜¯é€šè¿‡â€œä¸ºå„ç»„åˆ†é…ä¸€ä¸ªå¹³å‡æ’åâ€çš„æ–¹å¼ç ´åå¹³çº§å…³ç³»çš„ In [120]:obj = pd.Series([7,-5,7,4,2,0,4]) In [121]:obj.rank() Out [121]: 0 6.5 1 1.0 2 6.5 3 4.5 4 3.0 5 2.0 6 4.5 dtype: float64 åœ¨ obj ä¸­ï¼Œ4å’Œ4çš„æ’åæ˜¯ç¬¬4åå’Œç¬¬äº”åï¼Œå–å¹³å‡å¾—4.5ã€‚7å’Œ7çš„æ’ååˆ†åˆ«æ˜¯ç¬¬å…­åå’Œç¬¬ä¸ƒåï¼Œåˆ™å…¶æ’åå–å¹³å‡å¾—6.5 æ ¹æ®å€¼åœ¨åŸæ•°æ®ä¸­å‡ºç°çš„é¡ºåºæ’å** In [122]:obj.rank(method='first') Out [122]: 0 6.0 1 1.0 2 7.0 3 4.0 4 3.0 5 2.0 6 5.0 dtype: float64 æŒ‰é™åºè¿›è¡Œ In [123]:obj.rank(ascending=False, method='max') Out [123]: 0 2.0 1 7.0 2 2.0 3 4.0 4 5.0 5 6.0 6 4.0 dtype: float64 è‹¥å¯¹DataFrameè¿›è¡Œæ’åºï¼Œåˆ™å¯æ ¹æ®axisæŒ‡å®šè¦è¿›è¡Œæ’åºçš„è½´ In [136]: frame=pd.DataFrame({'b':[5,7,-3,2],'a':[0,1,0,1],'c':[-2,5,8,-3]}) In [137]: frame Out[137]: a b c 0 0 5 -2 1 1 7 5 2 0 -3 8 3 1 2 -3 In [138]: frame.rank(axis=0) Out[138]: a b c 0 1.5 3.0 2.0 1 3.5 4.0 3.0 2 1.5 1.0 4.0 3 3.5 2.0 1.0 In [139]: frame.rank(axis=1) Out[139]: a b c 0 2.0 3.0 1.0 1 1.0 3.0 2.0 2 2.0 1.0 3.0 3 2.0 3.0 1.0 å‚è€ƒï¼š pandas.sort_valuesæ–¹æ³• pandasçš„rank()å‡½æ•° Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æè¿°å’Œæ±‡æ€»ç»Ÿè®¡.html":{"url":"Chapter2/Pandas æè¿°å’Œæ±‡æ€»ç»Ÿè®¡.html","title":"Pandas æè¿°å’Œæ±‡æ€»ç»Ÿè®¡","keywords":"","body":"Pandas æè¿°å’Œæ±‡æ€»ç»Ÿè®¡ pandas æä¾›äº†å¾ˆå¤šå¸¸ç”¨çš„æ•°å­¦å’Œç»Ÿè®¡æ–¹æ³•ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†éƒ½å±äºçº¦ç®€å’Œæ±‡æ€»ç»Ÿè®¡ï¼Œç”¨äºä»Series ä¸­æå–å•ä¸ªå€¼ï¼ˆå¦‚sumæˆ–meanï¼‰æˆ–ä»DataFrameçš„è¡Œæˆ–åˆ—ä¸­æå–ä¸€ä¸ª Seriesã€‚ mean()å¹³å‡å€¼ median()ä¸­ä½æ•° max()æœ€å¤§å€¼ min()æœ€å°å€¼ sum()æ±‚å’Œ std()æ ‡å‡†å·® Seriesç±»å‹ç‹¬æœ‰çš„æ–¹æ³•ï¼š argmax()æœ€å¤§å€¼çš„ä½ç½® argmin()æœ€å°å€¼çš„ä½ç½® DataFrameçš„sumå’Œmeanæ–¹æ³• a = [[1,np.nan,9],[2,8,3],[3,5,np.nan]] data = DataFrame(a,index=[\"a\",\"b\",\"c\"],columns=[\"one\",\"two\",\"three\"]) print(data) ''' one two three a 1 NaN 9.0 b 2 8.0 3.0 c 3 5.0 NaN ''' #å¯¹åˆ—æ±‚å’Œ print(data.sum()) ''' one 6.0 two 13.0 three 12.0 ''' #å¯¹è¡Œæ±‚å’Œ print(data.sum(axis=1)) ''' a 10.0 b 13.0 c 8.0 ''' #å¯¹è¡Œæ±‚å¹³å‡å€¼,é»˜è®¤æ’é™¤NaNå€¼ print(data.mean(axis=1)) ''' a 5.000000 b 4.333333 c 4.000000 ''' #å¯¹è¡Œæ±‚å¹³å‡å€¼ï¼Œç¦ç”¨è‡ªåŠ¨æ’é™¤NaNå€¼ print(data.mean(axis=1,skipna=False)) ''' a NaN b 4.333333 c NaN ''' ç»Ÿè®¡ .idxmax(), .idxmin(), .cumsum() ä¸Šé¢çš„æ“ä½œéƒ½æ˜¯å¯¹äºåˆ—ï¼Œå¦‚æœæƒ³è¦å¯¹è¡Œè¿›è¡Œæ“ä½œï¼Œåªéœ€è¦åœ¨æ–¹æ³•ä¸­è®¾ç½®axiså‚æ•°ä¸º1å³å¯ã€‚ a = [[1,np.nan,9],[2,8,3],[3,5,np.nan]] data = DataFrame(a,index=[\"0\",\"1\",\"2\"],columns=[\"a\",\"b\",\"c\"]) print(data) ''' a b c 0 1 NaN 9.0 1 2 8.0 3.0 2 3 5.0 NaN ''' # è¿”å›æ¯ä¸€åˆ—ä¸­æœ€å¤§å€¼çš„è¡Œç´¢å¼• print(data.idxmax()) ''' a 2 b 1 c 0 dtype: object ''' #è¿”å›æ¯ä¸€åˆ—ä¸­æœ€å°å€¼çš„è¡Œç´¢å¼• print(data.idxmin()) ''' a 0 b 2 c 1 dtype: object ''' #å¯¹æ¯åˆ—çš„å€¼è¿›è¡Œç´¯åŠ  print(data.cumsum()) ''' a b c 0 1.0 NaN 9.0 1 3.0 8.0 12.0 2 6.0 13.0 NaN ''' æ•°æ®æè¿° DataFrame df.describe() a = [[1,np.nan,9],[2,8,3],[3,5,np.nan]] data = DataFrame(a,index=[\"0\",\"1\",\"2\"],columns=[\"a\",\"b\",\"c\"]) print(data) ''' a b c 0 1 NaN 9.0 1 2 8.0 3.0 2 3 5.0 NaN ''' #åˆ—å‡ºDataFrameçš„æè¿° ''' å››åˆ†ä½æ•°ç”¨äºç»˜åˆ¶ç®±çº¿å›¾åˆ¤æ–­æ˜¯å¦ä¸ºå¼‚å¸¸å€¼ countï¼šè¯¥åˆ—ï¼ˆè¡Œï¼‰éNAå€¼çš„ä¸ªæ•° mean ï¼šè¯¥åˆ—ï¼ˆè¡Œï¼‰çš„å‡å€¼ std ï¼šè¯¥åˆ—ï¼ˆè¡Œï¼‰çš„æ–¹å·® 25% ï¼šä¸Šå››åˆ†ä½æ•° 50% ï¼šéNAå€¼çš„å¹³å‡æ•° 75% ï¼šä¸‹å››åˆ†ä½æ•° max ï¼šæœ€å¤§å€¼ ''' print(data.describe()) ''' a b c count 3.0 2.00000 2.000000 mean 2.0 6.50000 6.000000 std 1.0 2.12132 4.242641 min 1.0 5.00000 3.000000 25% 1.5 5.75000 4.500000 50% 2.0 6.50000 6.000000 75% 2.5 7.25000 7.500000 max 3.0 8.00000 9.000000 ''' Series å¦‚æœå€¼æ˜¯æ•°å€¼å‹çš„æè¿°ä¸DataFrameä¸€è‡´ï¼Œ s = Series([\"a\",\"b\",\"b\",\"d\"]) print(s) ''' 0 a 1 b 2 b 3 d ''' print(s.describe()) ''' count 4 unique 3 top b freq 2 ''' argmax(), argmin(),.tolist() argmax()æŸä¸€åˆ—æœ€å¤§å€¼çš„ä½ç½® argmin()æœ€å°å€¼çš„ä½ç½®,.tolist() tolist()è½¬æ¢æˆlistç±»å‹ # coding=utf-8 import numpy as np import pandas as pd # åˆ›å»ºDataFrame df = pd.DataFrame(np.arange(12, 32).reshape((5, 4)), index=[\"a\", \"b\", \"c\", \"d\", \"e\"], columns=[\"WW\", \"XX\", \"YY\", \"ZZ\"]) print(df) ''' WW XX YY ZZ a 12 13 14 15 b 16 17 18 19 c 20 21 22 23 d 24 25 26 27 e 28 29 30 31 ''' # mean()å¹³å‡å€¼ median()ä¸­ä½æ•° max()æœ€å¤§å€¼ min()æœ€å°å€¼ sum()æ±‚å’Œ std()æ ‡å‡†å·® print(df.mean()) # æ¯ä¸€åˆ—å¹³å‡å€¼ (Seriesç±»å‹) ''' WW 20.0 XX 21.0 YY 22.0 ZZ 23.0 dtype: float64 ''' print(df[\"YY\"].mean()) # 22.0 æŒ‡å®šåˆ—çš„å¹³å‡å€¼ print(df[\"YY\"]) # Seriesç±»å‹ YY_list = df[\"YY\"].tolist() # tolist()è½¬æ¢æˆlistç±»å‹ print(YY_list) # [14, 18, 22, 26, 30] print(len(YY_list)) # 5 print(len(set(YY_list))) # seté›†åˆå¯ä»¥å»é‡ print(df[\"YY\"].unique()) # [14 18 22 26 30] unique()è‡ªåŠ¨å»é‡(ndarrayç±»å‹) print(df.max()) # æ¯ä¸€åˆ—çš„æœ€å¤§å€¼ Seriesç±»å‹ã€‚ min()æœ€å°å€¼ ''' WW 28 XX 29 YY 30 ZZ 31 dtype: int64 ''' # argmax()æŸä¸€åˆ—æœ€å¤§å€¼çš„ä½ç½® argmin()æœ€å°å€¼çš„ä½ç½® print(df[\"YY\"].argmax()) # e Update timeï¼š 2020-05-25 "},"Chapter2/Pandas ä½¿ç”¨æµ‹è¯•æ¨¡å—åˆ¶ä½œä¼ªæ•°æ®.html":{"url":"Chapter2/Pandas ä½¿ç”¨æµ‹è¯•æ¨¡å—åˆ¶ä½œä¼ªæ•°æ®.html","title":"Pandas ä½¿ç”¨æµ‹è¯•æ¨¡å—åˆ¶ä½œä¼ªæ•°æ®","keywords":"","body":"Pandas ä½¿ç”¨æµ‹è¯•æ¨¡å—åˆ¶ä½œä¼ªæ•°æ® åœ¨pandasä¸­ï¼Œæœ‰ä¸€ä¸ªæµ‹è¯•æ¨¡å—å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç”ŸæˆåŠçœŸå®ï¼ˆä¼ªæ•°æ®ï¼‰ï¼Œå¹¶è¿›è¡Œæµ‹è¯•ï¼Œå®ƒå°±æ˜¯util.testingã€‚ åˆ›å»ºéšæœºæ•°æ®é›† df = pd.util.testing.makeDataFrame() åˆ›å»ºéšæœºæ—¥æœŸç´¢å¼•æ•°æ®é›† df = pd.util.testing.makePeriodFrame() df = pd.util.testing.makeTimeDataFrame() åˆ›å»ºéšæœºæ··åˆç±»å‹æ•°æ®é›† df = pd.util.testing.makeMixedDataFrame() >>> import pandas.util.testing as tm >>> tm.N, tm.K = 15, 3 # é»˜è®¤çš„è¡Œå’Œåˆ— >>> import numpy as np >>> np.random.seed(444) >>> tm.makeTimeDataFrame(freq='M').head() A B C 2000-01-31 0.3574 -0.8804 0.2669 2000-02-29 0.3775 0.1526 -0.4803 2000-03-31 1.3823 0.2503 0.3008 2000-04-30 1.1755 0.0785 -0.1791 2000-05-31 -0.9393 -0.9039 1.1837 >>> tm.makeDataFrame().head() A B C nTLGGTiRHF -0.6228 0.6459 0.1251 WPBRn9jtsR -0.3187 -0.8091 1.1501 7B3wWfvuDA -1.9872 -1.0795 0.2987 yJ0BTjehH1 0.8802 0.7403 -1.2154 0luaYUYvy1 -0.9320 1.2912 -0.2907 åˆ›å»ºéšæœºä¸ªæ•°çš„å­—ç¬¦ä¸² pd.util.testing.rands(n) [pd.util.testing.rands(3) for _ in range(4)] # ['crx', 'Z9k', 'KAU', 'mHz'] pd.util.testing.rand(n) éšæœºåˆ›å»ºå«æœ‰ä¸‰ä¸ªå…ƒç´ çš„æ•°ç»„ [pd.util.testing.rand(3) for _ in range(4)] [array([0.72753901, 0.01316105, 0.12749649]), array([0.68111966, 0.30113528, 0.27567208]), array([0.55361183, 0.19179808, 0.89546358]), array([0.97648769, 0.94504658, 0.1353476 ])] pd.util.testing.rands_array(nchars, size, dtype='O') åˆ›å»ºå­—ç¬¦ä¸²çŸ©é˜µ [pd.util.testing.rands_array(2,size=(2,2)) for _ in range(4)] [array([['YX', 'u9'], ['MY', 'Fa']], dtype=object), array([['Fa', 'CQ'], ['Kf', 'IR']], dtype=object), array([['Lz', 'q8'], ['1S', 'WU']], dtype=object), array([['EC', 'Jz'], ['2z', '6g']], dtype=object)] pd.util.testing.randbool(iterable) æ ¹æ® iterable çš„shape åˆ›å»º boolen ç±»å‹çš„ iterable [pd.util.testing.randbool([1,2]) for _ in range(4)] [array([[ True, True]]), array([[False, False]]), array([[ True, False]]), array([[ True, True]])] Update timeï¼š 2020-05-25 "},"Chapter2/Pandas å­—ç¬¦æ•°æ®çš„å¤„ç†æ–¹æ³•.html":{"url":"Chapter2/Pandas å­—ç¬¦æ•°æ®çš„å¤„ç†æ–¹æ³•.html","title":"Pandas å­—ç¬¦æ•°æ®çš„å¤„ç†æ–¹æ³•","keywords":"","body":"Pandas å­—ç¬¦æ•°æ®çš„å¤„ç†æ–¹æ³• åœ¨å•†ä¸šæ•°æ®è¡¨ä¸­ï¼Œç»å¸¸éœ€è¦å¤„ç†å­—ç¬¦å‹çš„æ•°æ®ï¼Œè€Œ pandas ä¸­çš„ Series.strå±æ€§å°±æœ‰å‡ ä¸‹å‡ åç§æ–¹æ³•å¯ä»¥å¤„ç†å­—ç¬¦ä¸²æ•°æ®ã€‚ Series.str.extract() str.extract()ï¼Œå¯ç”¨æ­£åˆ™ä»å­—ç¬¦æ•°æ®ä¸­æŠ½å–åŒ¹é…çš„æ•°æ®ï¼Œæ³¨æ„è¦åŠ ä¸Šæ‹¬å·ï¼Œ åªè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ•°æ®ï¼ˆè¦å°†è‡ªå·±è¦æå–çš„å†…å®¹åŠ ä¸Šæ‹¬å·ï¼Œæ‹¬å·å¤–çš„ä¸æå–ï¼‰ æ³¨æ„ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¸­å¿…é¡»æœ‰åˆ†ç»„ï¼Œåªæ˜¯è¿”å›åˆ†ç»„ä¸­çš„æ•°æ®ï¼Œå¦‚æœç»™åˆ†ç»„å–äº†åç§°ï¼Œåˆ™è¯¥åç§°å°±æ˜¯è¿”å›ç»“æœä¸­çš„å­—æ®µåã€‚ Series.str.extract(pat, flags=0, expand=None) å‚æ•°: pat : å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ flags : æ•´å‹, expand : å¸ƒå°”å‹,æ˜¯å¦è¿”å›DataFrame å½“å­—ç¬¦ä¸²ä¸­å«æœ‰å¤šä¸ªè¦æå–çš„å˜é‡æ—¶ï¼Œexpand=True ä¼šå°†å…¶åˆ†å‰²ä¸ºå¤šåˆ— Returns: æ•°æ®æ¡†dataframe/ç´¢å¼•index for i in df: df['Title']=df_raw['Name'].str.extract('([A-Za-z]+)\\.', expand=False) str.extractall() Series.str.extractall(pat, flags=0) è¿”å›æ‰€æœ‰åŒ¹é…çš„å­—ç¬¦ å‚æ•°: pat: å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ flags : æ•´å‹ è¿”å›å€¼: Series.str.cat() Series.str.cat(others=None, sep=None, na_rep=None) ç”¨ç»™å®šçš„å­—ç¬¦é“¾æ¥åºåˆ—æˆ–ç´¢å¼•ä¸­çš„å­—ç¬¦ä¸² è¿”å›ï¼šåˆå¹¶åçš„åºåˆ— æ³¨ï¼šå½“na_repä¸ºNoneï¼Œåºåˆ—ä¸­çš„nanå€¼å°†è¢«å¿½ç•¥ï¼Œå¦‚æœæŒ‡å®šï¼Œå°†ç”¨è¯¥å­—ç¬¦ä»£æ›¿ >>> df.index.str.cat(['1','2','3'],sep = ',') Index(['f,1', 'g,2', 'h,3'], dtype='object') >>> df.index.str.cat([['1','2','3'],['4','5','6']],sep='*') Index(['f*1*4', 'g*2*5', 'h*3*6'], dtype='object') >>> df.index.str.cat(sep='*') 'f*g*h' >>> Series.str.get() è·å–æŒ‡å®šä½ç½®çš„å­—ç¬¦ä¸² Series.str.contains() æ˜¯å¦åŒ…å«è¡¨è¾¾å¼ Series.str.contains(pat, case=True, flags=0, na=nan, regex=True) åˆ¤æ–­ç»™å®šçš„å­—ç¬¦ä¸²æˆ–è€…æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦åœ¨åºåˆ—æˆ–è€…ç´¢å¼•ä¸­ è¿”å›ï¼šbool >>> df a b hh f 1 4 d g 2 5 f h 3 6 g >>> df['hh'].str.contains('f') f False g True h False Name: hh, dtype: bool å‚æ•° na å½“æ•°æ®ä¸­æœ‰ç©ºå€¼çš„æ—¶å€™ å¤„ç†çš„ç­–ç•¥ mapping = {'liucixin': 'åˆ˜æ…ˆæ¬£|å¤§åˆ˜', 'guofan': 'éƒ­å¸†', 'quchuxiao': 'å±ˆæ¥šè§|åˆ˜å¯|æˆ·å£', 'wujing': 'å´äº¬|åˆ˜åŸ¹å¼º', 'liguangjie': 'æå…‰æ´|ç‹ç£Š', 'wumengda': 'å´å­Ÿè¾¾|è¾¾å”|éŸ©å­æ˜‚', 'zhaojinmai': 'èµµä»Šéº¦|éŸ©æœµæœµ'} for key, value in mapping.items(): data[key] = data['content'].str.contains(value,na=False) å¤„ç†åå¾—åˆ°ç»“æœ å…¨éƒ¨ä¸º bool ç±»å‹çš„å€¼ï¼Œ ä¸åŒ…å« NA/ ç­‰ç©ºå€¼ Series.str.count() Series.str.count(pat, flags=0, **kwargs) è®¡ç®—patåœ¨åºåˆ—æˆ–è€…ç´¢å¼•å­—ç¬¦ä¸²ä¸­å‡ºç°çš„æ¬¡æ•° >>> df['count']=['hello','hello','hel'] >>> df a b hh count f 1 4 d hello g 2 5 f hello h 3 6 g hel >>> df['count'].str.count('hel') f 1 g 1 h 1 Name: count, dtype: int64 >>> df['count'].str.count('l') f 2 g 2 h 1 Name: count, dtype: int64 Series.str.decode() Series.str.decode(encoding, errors=â€™strictâ€™) å¯¹æŒ‡å®šçš„ç¼–ç æ–¹å¼è¿›è¡Œè§£ç ï¼ˆâ€˜utf-8â€™,'gbk'ç­‰ç­‰ï¼‰ Series.str.endswith() Series.str.endswith(pat, na=nan) åˆ¤æ–­æ˜¯å¦å·²ç»™å®šçš„ pat ç»“å°¾ å…¶ä»– split()åˆ‡åˆ†å­—ç¬¦ä¸² str.split()æœ‰ä¸‰ä¸ªå‚æ•°ï¼š ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯å¼•å·é‡Œçš„å†…å®¹ï¼šå°±æ˜¯åˆ†åˆ—çš„ä¾æ®ï¼Œå¯ä»¥æ˜¯ç©ºæ ¼ï¼Œç¬¦å·ï¼Œå­—ç¬¦ä¸²ç­‰ç­‰ã€‚ ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯å‰é¢ç”¨åˆ°çš„expand=Trueï¼Œè¿™ä¸ªå‚æ•°ç›´æ¥å°†åˆ†åˆ—åçš„ç»“æœè½¬æ¢æˆDataFrameã€‚ ç¬¬ä¸‰ä¸ªå‚æ•°çš„n=æ•°å­—å°±æ˜¯é™åˆ¶åˆ†åˆ—çš„æ¬¡æ•° ã€‚ å°±æ˜¯å½“ç”¨äºåˆ†åˆ—çš„ä¾æ®ç¬¦å·åœ¨æœ‰å¤šä¸ªçš„è¯éœ€è¦æŒ‡å®šåˆ†åˆ—çš„æ¬¡æ•°ï¼ˆä¸æŒ‡å®šçš„è¯å°±ä¼šæ ¹æ®ç¬¦å·æœ‰å‡ ä¸ªåˆ†åˆ—å‡ æ¬¡ï¼‰ã€‚ data.auth_capital.sample(5) \"\"\" 411 æ³¨å†Œèµ„æœ¬ï¼š100 ä¸‡å…ƒ 735 æ³¨å†Œèµ„æœ¬ï¼š53760 ä¸‡å…ƒäººæ°‘å¸ 607 æ³¨å†Œèµ„æœ¬ï¼š1476.92ä¸‡å…ƒäººæ°‘å¸ 464 æ³¨å†Œèµ„æœ¬ï¼š22.3464ä¸‡å…ƒäººæ°‘å¸ 12 æ³¨å†Œèµ„æœ¬ï¼š430077.1898ä¸‡äººæ°‘å¸å…ƒ \"\"\" auth_capital = data['auth_capital'].str.split('ï¼š', expand = True) auth_capital.sample(5) join()å¯¹æ¯ä¸ªå­—ç¬¦éƒ½ç”¨ç»™ç‚¹çš„å­—ç¬¦ä¸²æ‹¼æ¥èµ·æ¥ï¼Œä¸å¸¸ç”¨ replace()æ›¿æ¢ repeat() é‡å¤ pad() å·¦å³è¡¥é½ >>> s.str.pad(10, fillchar=\"?\") 0 ?????a_b_c 1 ?????c_d_e 2 NaN 3 ?????f_g_h dtype: object >>> >>> s.str.pad(10, side=\"right\", fillchar=\"?\") 0 a_b_c????? 1 c_d_e????? 2 NaN 3 f_g_h????? dtype: object slice() æŒ‰ç»™å®šçš„å¼€å§‹ç»“æŸä½ç½®åˆ‡å‰²å­—ç¬¦ä¸² >>> s.str.slice(1,3) 0 _b 1 _d 2 NaN 3 _g dtype: object slice_replace()ä½¿ç”¨ç»™å®šçš„å­—ç¬¦ä¸²ï¼Œæ›¿æ¢æŒ‡å®šçš„ä½ç½®çš„å­—ç¬¦ >>> s.str.slice_replace(1, 3, \"?\") 0 a?_c 1 c?_e 2 NaN 3 f?_h dtype: object >>> s.str.slice_replace(1, 3, \"??\") 0 a??_c 1 c??_e 2 NaN 3 f??_h dtype: object findall() æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ï¼Œä»¥æ•°ç»„å½¢å¼è¿”å› >>> s.str.findall(\"[a-z]\"); 0 [a, b, c] 1 [c, d, e] 2 NaN 3 [f, g, h] dtype: object partition() æŠŠå­—ç¬¦ä¸²æ•°ç»„åˆ‡å‰²ç§°ä¸ºDataFrameï¼Œæ³¨æ„åˆ‡å‰²åªæ˜¯åˆ‡å‰²ç§°ä¸ºä¸‰éƒ¨åˆ†ï¼Œåˆ†éš”ç¬¦å‰ï¼Œåˆ†éš”ç¬¦ï¼Œåˆ†éš”ç¬¦å rpartition() ä»å³åˆ‡èµ· lower() å…¨éƒ¨å°å†™ upper() å…¨éƒ¨å¤§å†™ å‚è€ƒ Pandasä¹‹Series.stråˆ—å†…ç½®çš„æ–¹æ³• Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ—¶é—´åºåˆ—â€”date_rangeå‡½æ•°.html":{"url":"Chapter2/Pandas æ—¶é—´åºåˆ—â€”date_rangeå‡½æ•°.html","title":"Pandas æ—¶é—´åºåˆ—â€”date_rangeå‡½æ•°","keywords":"","body":"Pandas æ—¶é—´åºåˆ—â€”date_rangeå‡½æ•° å‡½æ•°åŸå‹ï¼š pandas.date_range( start=None, end=None, periods=None, freq='D', tz=None, normalize=False, name=None, closed=None, **kwargs ) å‚æ•°ï¼š startï¼šstring æˆ– datetime-likeï¼Œé»˜è®¤å€¼æ˜¯ Noneï¼Œè¡¨ç¤ºæ—¥æœŸçš„èµ·ç‚¹ã€‚ endï¼šstring æˆ– datetime-likeï¼Œé»˜è®¤å€¼æ˜¯ Noneï¼Œè¡¨ç¤ºæ—¥æœŸçš„ç»ˆç‚¹ã€‚ periodsï¼šinteger æˆ– Noneï¼Œé»˜è®¤å€¼æ˜¯Noneï¼Œè¡¨ç¤ºä½ è¦ä»è¿™ä¸ªå‡½æ•°äº§ç”Ÿå¤šå°‘ä¸ªæ—¥æœŸç´¢å¼•å€¼ï¼›å¦‚æœæ˜¯Noneçš„è¯ï¼Œé‚£ä¹ˆstartå’Œendå¿…é¡»ä¸èƒ½ä¸ºNoneã€‚ freqï¼šstring æˆ– DateOffsetï¼Œé»˜è®¤å€¼æ˜¯ â€™Dâ€™ï¼Œè¡¨ç¤ºä»¥è‡ªç„¶æ—¥ä¸ºå•ä½ï¼Œè¿™ä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šè®¡æ—¶å•ä½ï¼Œæ¯”å¦‚ â€™5Hâ€™ è¡¨ç¤ºæ¯éš”5ä¸ªå°æ—¶è®¡ç®—ä¸€æ¬¡ã€‚ tzï¼šstring æˆ– Noneï¼Œè¡¨ç¤ºæ—¶åŒºï¼Œä¾‹å¦‚ï¼šâ€™Asia/Hong_Kongâ€™ã€‚ normalizeï¼šboolï¼Œé»˜è®¤å€¼ä¸º Falseï¼Œå¦‚æœä¸ºTrueçš„è¯ï¼Œé‚£ä¹ˆåœ¨äº§ç”Ÿæ—¶é—´ç´¢å¼•å€¼ä¹‹å‰ä¼šå…ˆæŠŠstartå’Œendéƒ½è½¬åŒ–ä¸ºå½“æ—¥çš„åˆå¤œ0ç‚¹ã€‚ nameï¼šstrï¼Œé»˜è®¤å€¼ä¸ºNoneï¼Œç»™è¿”å›çš„æ—¶é—´ç´¢å¼•æŒ‡å®šä¸€ä¸ªåå­—ã€‚ closedï¼šstring æˆ–è€… Noneï¼Œé»˜è®¤å€¼ä¸ºNoneï¼Œè¡¨ç¤º start å’Œ end è¿™ä¸ªåŒºé—´ç«¯ç‚¹æ˜¯å¦åŒ…å«åœ¨åŒºé—´å†…ï¼Œå¯ä»¥æœ‰ä¸‰ä¸ªå€¼ï¼Œleft è¡¨ç¤ºå·¦é—­å³å¼€åŒºé—´ï¼Œrigh è¡¨ç¤ºå·¦å¼€å³é—­åŒºé—´ï¼ŒNone è¡¨ç¤ºä¸¤è¾¹éƒ½æ˜¯é—­åŒºé—´ã€‚ In [11]: import pandas as pd In [12]: pd.date_range(start='20170101',end='20170110') Out[12]: DatetimeIndex(['2017-01-01', '2017-01-02', '2017-01-03', '2017-01-04', '2017-01-05', '2017-01-06', '2017-01-07', '2017-01-08', '2017-01-09', '2017-01-10'], dtype='datetime64[ns]', freq='D') In [13]: pd.date_range(start='20170101',periods=10) Out[13]: DatetimeIndex(['2017-01-01', '2017-01-02', '2017-01-03', '2017-01-04', '2017-01-05', '2017-01-06', '2017-01-07', '2017-01-08', '2017-01-09', '2017-01-10'], dtype='datetime64[ns]', freq='D') In [14]: pd.date_range(start='20170101',periods=10,freq='1D') Out[14]: DatetimeIndex(['2017-01-01', '2017-01-02', '2017-01-03', '2017-01-04', '2017-01-05', '2017-01-06', '2017-01-07', '2017-01-08', '2017-01-09', '2017-01-10'], dtype='datetime64[ns]', freq='D') In [15]: pd.date_range(start='20170101',end='20170110',freq='3D',name='dt') Out[15]: DatetimeIndex(['2017-01-01', '2017-01-04', '2017-01-07', '2017-01-10'], dtype='datetime64[ns]', name='dt', freq='3D') In [16]: pd.date_range(start='2017-01-01 08:10:50',periods=10,freq='s',normaliz ...: e=True) Out[16]: DatetimeIndex(['2017-01-01 00:00:00', '2017-01-01 00:00:01', '2017-01-01 00:00:02', '2017-01-01 00:00:03', '2017-01-01 00:00:04', '2017-01-01 00:00:05', '2017-01-01 00:00:06', '2017-01-01 00:00:07', '2017-01-01 00:00:08', '2017-01-01 00:00:09'], dtype='datetime64[ns]', freq='S') In [17]: pd.date_range(start='2017-01-01 08:10:50',end='2017-01-02 09:20:40',fr ...: eq='s',normalize=True) Out[17]: DatetimeIndex(['2017-01-01 00:00:00', '2017-01-01 00:00:01', '2017-01-01 00:00:02', '2017-01-01 00:00:03', '2017-01-01 00:00:04', '2017-01-01 00:00:05', '2017-01-01 00:00:06', '2017-01-01 00:00:07', '2017-01-01 00:00:08', '2017-01-01 00:00:09', ... '2017-01-01 23:59:51', '2017-01-01 23:59:52', '2017-01-01 23:59:53', '2017-01-01 23:59:54', '2017-01-01 23:59:55', '2017-01-01 23:59:56', '2017-01-01 23:59:57', '2017-01-01 23:59:58', '2017-01-01 23:59:59', '2017-01-02 00:00:00'], dtype='datetime64[ns]', length=86401, freq='S') In [18]: pd.date_range(start='2017-01-01 08:10:50',periods=15,freq='s',normaliz ...: e=False) Out[18]: DatetimeIndex(['2017-01-01 08:10:50', '2017-01-01 08:10:51', '2017-01-01 08:10:52', '2017-01-01 08:10:53', '2017-01-01 08:10:54', '2017-01-01 08:10:55', '2017-01-01 08:10:56', '2017-01-01 08:10:57', '2017-01-01 08:10:58', '2017-01-01 08:10:59', '2017-01-01 08:11:00', '2017-01-01 08:11:01', '2017-01-01 08:11:02', '2017-01-01 08:11:03', '2017-01-01 08:11:04'], dtype='datetime64[ns]', freq='S') In [19]: pd.date_range(start='20170101',end='20170110',freq='3D',closed='left') ...: Out[19]: DatetimeIndex(['2017-01-01', '2017-01-04', '2017-01-07'], dtype='dateti me64[ns]', freq='3D') In [20]: pd.date_range(start='20170101',end='20170110',freq='3D',closed='right' ...: ) Out[20]: DatetimeIndex(['2017-01-04', '2017-01-07', '2017-01-10'], dtype='dateti me64[ns]', freq='3D') Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ—¶é—´åºåˆ—â€”period_rangeå‡½æ•°.html":{"url":"Chapter2/Pandas æ—¶é—´åºåˆ—â€”period_rangeå‡½æ•°.html","title":"Pandas æ—¶é—´åºåˆ—â€”period_rangeå‡½æ•°","keywords":"","body":"Pandas æ—¶é—´åºåˆ—â€”period_rangeå‡½æ•° pd.period_range(start=None, end=None, periods=None, freq='D', name=None) #æ—¶é—´æ®µèŒƒå›´è¿”å›PeriodIndex å‚æ•° start=None : #string or period-like,æœŸé—´å¼€å§‹ end=None : #string or period-like,æœŸé—´ç»“æŸ periods =None: #integer,è¦ç”Ÿæˆçš„å‘¨æœŸæ•° freq='D' : #string or DateOffset name=None : str,# ç”ŸæˆPeriodIndexçš„åç§° ç”Ÿæˆæ—¥æœŸåºåˆ— ä¸»è¦æä¾›pd.data_range()å’Œpd.period_range()ä¸¤ä¸ªæ–¹æ³•ï¼Œç»™å®šå‚æ•°æœ‰èµ·å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ã€ç”Ÿæˆæ—¶æœŸçš„æ•°ç›®åŠæ—¶é—´é¢‘ç‡ï¼ˆfreq='Mâ€™æœˆï¼Œ'Dâ€™å¤©ï¼Œâ€˜Wâ€™ï¼Œå‘¨ï¼Œ'Yâ€™å¹´ï¼‰ç­‰ã€‚ ä¸¤ç§ä¸»è¦åŒºåˆ«åœ¨äºpd.date_range() ç”Ÿæˆçš„æ˜¯DatetimeIndex æ ¼å¼çš„æ—¥æœŸåºåˆ—ï¼›pd.period_range() ç”Ÿæˆçš„æ˜¯PeriodIndexæ ¼å¼çš„æ—¥æœŸåºåˆ—ã€‚ ä»¥ä¸‹é€šè¿‡ç”Ÿæˆæœˆæ—¶é—´åºåˆ—å’Œå‘¨æ—¶é—´åºåˆ—æ¥å¯¹æ¯”ä¸‹ï¼š date_rng = pd.date_range('2019-01-01', freq='M', periods=12) print(f'month date_range()ï¼š\\n{date_rng}') \"\"\" date_range()ï¼š DatetimeIndex(['2019-01-31', '2019-02-28', '2019-03-31', '2019-04-30', '2019-05-31', '2019-06-30', '2019-07-31', '2019-08-31', '2019-09-30', '2019-10-31', '2019-11-30', '2019-12-31'], dtype='datetime64[ns]', freq='M') \"\"\" period_rng = pd.period_range('2019/01/01', freq='M', periods=12) print(f'month period_range()ï¼š\\n{period_rng}') \"\"\" period_range()ï¼š PeriodIndex(['2019-01', '2019-02', '2019-03', '2019-04', '2019-05', '2019-06', '2019-07', '2019-08', '2019-09', '2019-10', '2019-11', '2019-12'], dtype='period[M]', freq='M') \"\"\" date_rng = pd.date_range('2019-01-01', freq='W-SUN', periods=12) print(f'week date_range()ï¼š\\n{date_rng}') \"\"\" week date_range()ï¼š DatetimeIndex(['2019-01-06', '2019-01-13', '2019-01-20', '2019-01-27', '2019-02-03', '2019-02-10', '2019-02-17', '2019-02-24', '2019-03-03', '2019-03-10', '2019-03-17', '2019-03-24'], dtype='datetime64[ns]', freq='W-SUN') \"\"\" period_rng=pd.period_range('2019-01-01',freq='W-SUN',periods=12) print(f'week period_range()ï¼š\\n{period_rng}') \"\"\" week period_range()ï¼š PeriodIndex(['2018-12-31/2019-01-06', '2019-01-07/2019-01-13', '2019-01-14/2019-01-20', '2019-01-21/2019-01-27', '2019-01-28/2019-02-03', '2019-02-04/2019-02-10', '2019-02-11/2019-02-17', '2019-02-18/2019-02-24', '2019-02-25/2019-03-03', '2019-03-04/2019-03-10', '2019-03-11/2019-03-17', '2019-03-18/2019-03-24'], dtype='period[W-SUN]', freq='W-SUN') \"\"\" date_rng = pd.date_range('2019-01-01 00:00:00', freq='H', periods=12) print(f'hour date_range()ï¼š\\n{date_rng}') \"\"\" hour date_range()ï¼š DatetimeIndex(['2019-01-01 00:00:00', '2019-01-01 01:00:00', '2019-01-01 02:00:00', '2019-01-01 03:00:00', '2019-01-01 04:00:00', '2019-01-01 05:00:00', '2019-01-01 06:00:00', '2019-01-01 07:00:00', '2019-01-01 08:00:00', '2019-01-01 09:00:00', '2019-01-01 10:00:00', '2019-01-01 11:00:00'], dtype='datetime64[ns]', freq='H') \"\"\" period_rng=pd.period_range('2019-01-01 00:00:00',freq='H',periods=12) print(f'hour period_range()ï¼š\\n{period_rng}') \"\"\" hour period_range()ï¼š PeriodIndex(['2019-01-01 00:00', '2019-01-01 01:00', '2019-01-01 02:00', '2019-01-01 03:00', '2019-01-01 04:00', '2019-01-01 05:00', '2019-01-01 06:00', '2019-01-01 07:00', '2019-01-01 08:00', '2019-01-01 09:00', '2019-01-01 10:00', '2019-01-01 11:00'], dtype='period[H]', freq='H') \"\"\" Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ—¶é—´åºåˆ—â€”to_datetimeå‡½æ•°.html":{"url":"Chapter2/Pandas æ—¶é—´åºåˆ—â€”to_datetimeå‡½æ•°.html","title":"Pandas æ—¶é—´åºåˆ—â€”to_datetimeå‡½æ•°","keywords":"","body":"Pandas æ—¶é—´åºåˆ—â€”to_datetimeå‡½æ•° pandas.to_datetime()ï¼Œå®ƒæ˜¯pandasåº“çš„ä¸€ä¸ªæ–¹æ³•ï¼Œ è¿™ä¸ªæ–¹æ³•çš„å®ç”¨æ€§åœ¨äºï¼Œå½“éœ€è¦æ‰¹é‡å¤„ç†æ—¶é—´æ•°æ®æ—¶ï¼Œæ— ç–‘æ˜¯æœ€å¥½ç”¨çš„ã€‚ ä¸»è¦å‡ ä¸ªå‚æ•° pandas.to_datetime( arg, errors ='raise', utc = None, format = None, unit = None ) format æ ¼å¼åŒ–æ˜¾ç¤ºæ—¶é—´çš„æ ¼å¼ã€‚å¦‚ \"%Y-%m-%d\",..... units é»˜è®¤å€¼ä¸ºâ€˜nsâ€™ï¼Œåˆ™å°†ä¼šç²¾ç¡®åˆ°å¾®å¦™ï¼Œâ€˜s'ä¸ºç§’ã€‚ errors ä¸‰ç§å–å€¼ï¼Œâ€˜ignoreâ€™, â€˜raiseâ€™, â€˜coerceâ€™ï¼Œé»˜è®¤ä¸ºraiseã€‚ 'raise'ï¼Œåˆ™æ— æ•ˆçš„è§£æå°†å¼•å‘å¼‚å¸¸ 'coerce'ï¼Œé‚£ä¹ˆæ— æ•ˆè§£æå°†è¢«è®¾ç½®ä¸ºNaT 'ignore'ï¼Œé‚£ä¹ˆæ— æ•ˆçš„è§£æå°†è¿”å›è¾“å…¥å€¼ 1ã€ df = pd.DataFrame({'year': [2015, 2016], 'month': [2, 3], 'day': [4, 5]}) pd.to_datetime(df) #0 2015-02-04 #1 2016-03-05 #dtype: datetime64[ns] #å¯ä»¥çœ‹åˆ°å°†å­—å…¸å½¢å¼æ—¶é—´è½¬æ¢ä¸ºå¯è¯»æ—¶é—´ 2ã€ pd.to_datetime('13000101', format='%Y%m%d', errors='ignore') #datetime.datetime(1300, 1, 1, 0, 0) pd.to_datetime('13000101', format='%Y%m%d', errors='coerce') #NaT #å¦‚æœæ—¥æœŸä¸ç¬¦åˆæ—¶é—´æˆ³é™åˆ¶ï¼Œåˆ™errors ='ignore'å°†è¿”å›åŸå§‹è¾“å…¥ï¼Œè€Œä¸ä¼šæŠ¥é”™ã€‚ #errors='coerce'å°†å¼ºåˆ¶è¶…å‡ºNaTçš„æ—¥æœŸï¼Œè¿”å›NaTã€‚ ç„¶è€Œå®é™…ä¸­é‡åˆ°çš„å¯èƒ½æ˜¯è¿™æ ·çš„æ•°æ®ï¼š é€šè¿‡pandas.read_csv()æˆ–è€…pandas.read_excel()è¯»å–æ–‡ä»¶è¿‡åï¼Œå¾—åˆ°çš„æ•°æ®åˆ—å¯¹åº”çš„ç±»å‹æ˜¯â€œobjectâ€ï¼Œè¿™æ ·æ²¡æ³•å¯¹æ—¶é—´æ•°æ®å¤„ç†ï¼Œå¯ä»¥ç”¨è¿‡pd.to_datetime å°†è¯¥åˆ—æ•°æ®è½¬æ¢ä¸ºæ—¶é—´ç±»å‹ï¼Œå³datetime ã€‚ data.dtypes # object data= pd.to_datetime(data) data.dtypes # datetime64[ns] è½¬æ¢è¿‡åå°±å¯ä»¥å¯¹è¿™äº›æ—¶é—´æ•°æ®æ“ä½œäº†ï¼Œå¯ä»¥ç›¸å‡æ±‚æ—¶é—´å·®ï¼Œè®¡ç®—ç›¸å·®çš„ç§’æ•°å’Œå¤©æ•°ï¼Œè°ƒç”¨çš„æ–¹æ³•å’Œdatetimeåº“çš„æ–¹æ³•ä¸€è‡´ï¼Œåˆ†åˆ«æ˜¯ data.dt.days()ã€data.dt.seconds() ã€data.dt.total_seconds() å‚è€ƒï¼š https://www.pypandas.cn/docs/user_guide/timeseries.html#%E7%BA%B5%E8%A7%88 Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ—¶é—´åºåˆ—â€”to_periodå‡½æ•°.html":{"url":"Chapter2/Pandas æ—¶é—´åºåˆ—â€”to_periodå‡½æ•°.html","title":"Pandas æ—¶é—´åºåˆ—â€”to_periodå‡½æ•°","keywords":"","body":"Pandas æ—¶é—´åºåˆ—â€”to_periodå‡½æ•° Series.dtå¯ç”¨äºä»¥datetimelikeçš„å½¢å¼è®¿é—®åºåˆ—çš„å€¼å¹¶è¿”å›å‡ ä¸ªå±æ€§ã€‚ Pandas Series.dt.to_period()å‡½æ•°ä»¥ç‰¹å®šé¢‘ç‡å°†ç»™å®šSerieså¯¹è±¡çš„åŸºç¡€æ•°æ®å¼ºåˆ¶è½¬æ¢ä¸ºPeriodArray /Indexã€‚ å‚æ•°ï¼š freq ï¼šå­—ç¬¦ä¸²æˆ–åç§»é‡ï¼Œå¯é€‰ è¿”å›å€¼ï¼šPeriodArray /ç´¢å¼• èŒƒä¾‹1ï¼š é‡‡ç”¨Series.dt.to_period()å‡½æ•°ä»¥æ¯å‘¨é¢‘ç‡å°†ç»™å®šç³»åˆ—å¯¹è±¡çš„åŸºç¡€æ•°æ®è½¬æ¢ä¸ºç´¢å¼•ã€‚ import pandas as pd # Creating the Series sr = pd.Series(['2012-12-31', '2019-1-1 12:30', '2008-02-2 10:30', '2010-1-1 09:25', '2019-12-31 00:00']) # Creating the index idx = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5'] # set the index sr.index = idx # Convert the underlying data to datetime sr = pd.to_datetime(sr) # Print the series print(sr) ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨Series.dt.to_period()å‡½æ•°ä»¥æ¯å‘¨é¢‘ç‡å°†ç»™å®šç³»åˆ—å¯¹è±¡çš„åŸºç¡€æ•°æ®è½¬æ¢ä¸ºç´¢å¼• # cast to targert frequency result = sr.dt.to_period(freq = 'W') # print the result print(result) æ­£å¦‚æˆ‘ä»¬åœ¨è¾“å‡ºä¸­çœ‹åˆ°çš„ï¼ŒSeries.dt.to_period()åŠŸèƒ½å·²æˆåŠŸå°†æ•°æ®æŠ•å°„åˆ°ç›®æ ‡é¢‘ç‡ã€‚ # cast to targert frequency result = sr.dt.to_period(freq = 'M') # print the result print(result) èŒƒä¾‹2ï¼š é‡‡ç”¨Series.dt.to_period()å‡½æ•°ä»¥ä¸¤å¹´çš„é¢‘ç‡å°†ç»™å®šç³»åˆ—å¯¹è±¡çš„åŸºç¡€æ•°æ®è½¬æ¢ä¸ºIndexã€‚ # Creating the Series sr = pd.Series(pd.date_range('2012-12-31 00:00', periods = 5, freq = 'D')) # Creating the index idx = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5'] # set the index sr.index = idx # Print the series print(sr) ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨Series.dt.to_period()å‡½æ•°ä»¥ä¸¤å¹´çš„é¢‘ç‡å°†ç»™å®šç³»åˆ—å¯¹è±¡çš„åŸºç¡€æ•°æ®è½¬æ¢ä¸ºIndexã€‚ # cast to targert frequency result = sr.dt.to_period(freq = '2Y') # print the result print(result) å‚è€ƒ Python Pandas Series.dt.to_periodç”¨æ³•åŠä»£ç ç¤ºä¾‹ Update timeï¼š 2020-05-25 "},"Chapter2/Pandas sampleéšæœºæŠ½æ ·.html":{"url":"Chapter2/Pandas sampleéšæœºæŠ½æ ·.html","title":"Pandas sampleéšæœºæŠ½æ ·","keywords":"","body":"Pandas sampleéšæœºæŠ½æ · æœ‰æ—¶å€™æˆ‘ä»¬åªéœ€è¦æ•°æ®é›†ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸éœ€è¦å…¨éƒ¨çš„æ•°æ®ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¦å¯¹æ•°æ®é›†è¿›è¡Œéšæœºçš„æŠ½æ ·ã€‚pandasä¸­è‡ªå¸¦æœ‰æŠ½æ ·çš„æ–¹æ³•ã€‚ DataFrame.sample(n=None, frac=None, replace=False, weights=None, random_state=None, axis=None) Update timeï¼š 2020-05-25 "},"Chapter2/Pandas resampleæ–¹æ³•è¯¦è§£.html":{"url":"Chapter2/Pandas resampleæ–¹æ³•è¯¦è§£.html","title":"Pandas resampleæ–¹æ³•è¯¦è§£","keywords":"","body":"Pandas resampleæ–¹æ³•è¯¦è§£ Pandasä¸­çš„ resampleï¼Œé‡æ–°é‡‡æ ·ï¼Œæ˜¯å¯¹åŸæ ·æœ¬é‡æ–°å¤„ç†çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæ˜¯ä¸€ä¸ªå¯¹å¸¸è§„æ—¶é—´åºåˆ—æ•°æ®é‡æ–°é‡‡æ ·å’Œé¢‘ç‡è½¬æ¢çš„ä¾¿æ·çš„æ–¹æ³•ã€‚ DataFrame.resample(rule, how=None, axis=0, fill_method=None, closed=None, label=None, convention='start', kind=None, loffset=None, limit=None, base=0) rule : string åç§»é‡è¡¨ç¤ºç›®æ ‡å­—ç¬¦ä¸²æˆ–å¯¹è±¡è½¬æ¢ axis : int, optional, default 0 closed: {â€˜rightâ€™, â€˜leftâ€™} å“ªä¸€ä¸ªæ–¹å‘çš„é—´éš”æ˜¯å…³é—­çš„ label : {â€˜rightâ€™, â€˜leftâ€™} Which bin edge label to label bucket with convention : {â€˜startâ€™, â€˜endâ€™, â€˜sâ€™, â€˜eâ€™} loffset : timedelta è°ƒæ•´é‡æ–°å–æ ·æ—¶é—´æ ‡ç­¾ base : int, default 0 é¢‘ç‡å‡åŒ€ç»†åˆ†1å¤©,â€œèµ·æºâ€çš„èšåˆçš„é—´éš”ã€‚ä¾‹å¦‚,å¯¹äºâ€œ5åˆ†é’Ÿâ€é¢‘ç‡,åŸºåœ°å¯èƒ½èŒƒå›´ä»0åˆ°4ã€‚é»˜è®¤å€¼ä¸º0 é¦–å…ˆåˆ›å»ºä¸€ä¸ªSeriesï¼Œé‡‡æ ·é¢‘ç‡ä¸ºä¸€åˆ†é’Ÿã€‚ >>> index = pd.date_range('1/1/2000', periods=9, freq='T') >>> series = pd.Series(range(9), index=index) >>> series 2000-01-01 00:00:00 0 2000-01-01 00:01:00 1 2000-01-01 00:02:00 2 2000-01-01 00:03:00 3 2000-01-01 00:04:00 4 2000-01-01 00:05:00 5 2000-01-01 00:06:00 6 2000-01-01 00:07:00 7 2000-01-01 00:08:00 8 Freq: T, dtype: int64 é™ä½é‡‡æ ·é¢‘ç‡ä¸ºä¸‰åˆ†é’Ÿ >>> series.resample('3T').sum() 2000-01-01 00:00:00 3 2000-01-01 00:03:00 12 2000-01-01 00:06:00 21 Freq: 3T, dtype: int64 é™ä½é‡‡æ ·é¢‘ç‡ä¸ºä¸‰åˆ†é’Ÿï¼Œä½†æ˜¯æ¯ä¸ªæ ‡ç­¾ä½¿ç”¨rightæ¥ä»£æ›¿leftã€‚è¯·æ³¨æ„ï¼Œbucketä¸­å€¼çš„ç”¨ä½œæ ‡ç­¾ã€‚ >>> series.resample('3T', label='right').sum() 2000-01-01 00:03:00 3 2000-01-01 00:06:00 12 2000-01-01 00:09:00 21 Freq: 3T, dtype: int64 é™ä½é‡‡æ ·é¢‘ç‡ä¸ºä¸‰åˆ†é’Ÿï¼Œä½†æ˜¯å…³é—­rightåŒºé—´ã€‚ >>> series.resample('3T', label='right', closed='right').sum() 2000-01-01 00:00:00 0 2000-01-01 00:03:00 6 2000-01-01 00:06:00 15 2000-01-01 00:09:00 15 Freq: 3T, dtype: int64 ç¤ºä¾‹ çœ‹ä¸€ä¸ªdataframeï¼Œindexæ˜¯æ—¶é—´ï¼Œcolumns æ˜¯ price å’Œ volumeï¼š è¯¥dataframeçš„æ—¶é—´åˆ†å¸ƒå¼ä¸å‡åŒ€çš„ï¼Œç„¶è€Œå¾ˆå¤šç»Ÿè®¡åˆ†æå»ºæ¨¡éƒ½æ˜¯éœ€è¦æ—¶é—´å‡åŒ€é—´éš”çš„æ•°æ®çš„ï¼Œå¥½åœ¨ pandas ä¸ºæˆ‘ä»¬æä¾›äº† resample è¿™ä¸€å‡½æ•°å¯ä»¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚æ¯”å¦‚å¦‚æœæˆ‘ä»¬æƒ³è¦æ´—æˆ 1min é¢‘ç‡çš„æ•°æ®æˆ‘ä»¬å°±å¯ä»¥è¿™æ ·åšï¼š df = df.resample('60S').last() å¯ä»¥çœ‹åˆ°ç»è¿‡ resample å‡½æ•°çš„é‡æ–°æŠ½æ ·ï¼Œæ–°çš„dataframeå·²ç»å˜æˆäº†ç­‰é—´è·çš„åˆ†é’Ÿçº§åˆ«æ•°æ®ã€‚å…¶ä¸­ last() è¡¨ç¤ºä½¿ç”¨æ¯ä¸ªåˆ†é’Ÿæ®µåŒºé—´å†…çš„æœ€åä¸€ä¸ªæ•°æ®ä½œä¸ºè¯¥åˆ†é’Ÿæœ€ç»ˆæ˜¾ç¤ºçš„æ•°æ®ï¼Œå¦‚æœè¯¥åˆ†é’Ÿå†…æ²¡æœ‰ä»»ä½•æ•°æ®åˆ™ä¼šæ˜¾ç¤ºNaNï¼Œæ¯”å¦‚2014-12-07 00:02:00ã€‚é™¤äº†lastä¹‹å¤–ï¼Œè¿˜æœ‰firstï¼Œmeanï¼Œsum ç­‰ç­‰ã€‚ ä½†æ˜¯ï¼Œä»æ–°çš„ dataframe ä¸­æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥è§‚å¯Ÿå‡ºä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ï¼ŒåŸ dataframe çš„ç¬¬ä¸€ä¸ªè®°å½•æ˜¯00:00:07ï¼Œç„¶è€Œè¿™ä¸ªæ•°æ®å´è¢«è‡ªåŠ¨é™„åˆ°äº†æ–°dataframeä¸­00:00:00çš„indexä¸Šã€‚è€Œäº‹å®ä¸Šåœ¨00:00:00æ—¶åˆ»ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“00:00:07å‘ç”Ÿäº†ä»€ä¹ˆã€‚ç¬¬äºŒï¼Œå¯¹äºvolumeè€Œè¨€ä¸€èˆ¬ä¸åº”è¯¥ä½¿ç”¨lastè€Œåº”è¯¥æ˜¯ç”¨sumå‡½æ•°ï¼Œä»£è¡¨äº†è¿™ä¸ªæ—¶é—´æ®µå†…çš„æ€»çš„äº¤æ˜“é‡ï¼Œä¼šæ›´æœ‰æ„ä¹‰ã€‚ é‡æ–°å†™æˆ‘ä»¬çš„resampleå‡½æ•°å¦‚ä¸‹ï¼š price = df['price].resample('60S', label = 'right').last() volume = df['price].resample('60S', label = 'right').sum() df = pd.concat([price, volume], axis = 1) åœ¨è¿™æ®µä»£ç é‡Œï¼Œé¦–å…ˆæˆ‘ä»¬é€šè¿‡è®¾ç½®labelçš„å‚æ•°å»è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚åœ¨resampleå‡½æ•°é‡Œï¼Œlabelé»˜è®¤å€¼æ˜¯leftï¼Œä¹Ÿå°±æ˜¯æŠŠä¸€ä¸ªåŒºé—´å†…çš„æ•°æ®çš„è®¡ç®—ç»“æœéƒ½é™„åˆ°åŒºé—´å·¦ä¾§ç«¯ç‚¹ä¸Šï¼Œè€Œæˆ‘ä»¬æƒ³è¦çš„åˆ™æ˜¯ç›¸åçš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯label = rightã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬é€šè¿‡å°†priceå’Œvolumeåˆ†å¼€å¤„ç†ï¼Œpriceä½¿ç”¨lastï¼Œvolumeåˆ™ä½¿ç”¨sumå‡½æ•°ï¼Œè¾¾åˆ°äº†æ›´åˆç†çš„å¤„ç†æ•ˆæœã€‚æœ€åï¼Œæˆ‘ä»¬ç”¨concatå‡½æ•°å°†ä¸¤ä¸ªSeriesåˆå¹¶ï¼Œå°±å¾—åˆ°äº†å¦‚ä¸‹ç»“æœï¼š æœ€åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨applyå’Œlambdaå‡½æ•°è®¡ç®—æ¯ä¸€åˆ†é’Ÿçš„VWAPï¼Œä¹Ÿå°±æ˜¯æ¯åˆ†é’Ÿäº¤æ˜“é‡åŠ æƒçš„ä»·æ ¼ï¼Œä»£ç å¦‚ä¸‹ï¼š df.resample('60S', label = 'right').apply(lambda x:np.average(x['price'] ,weights = x['volume']) if sum(x['volume']) != 0 else np.average(x['price']))[['price']] å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†numpyé‡Œçš„averageå‡½æ•°å¸®æˆ‘ä»¬è®¡ç®—weighted averageï¼Œå…¶ä¸­weightså°±æ˜¯æ¯ä¸ªæ—¶é—´åŒºæ®µå†…çš„æ‰€æœ‰volumeæ•°æ®ã€‚åé¢æˆ‘ä»¬ä¸ºäº†é¿å…é”™è¯¯åŠ äº†ä¸€ä¸ªåˆ¤è¯»ï¼šå¦‚æœè¿™ä¸ªåŒºé—´å†…volumeåŠ å’Œç­‰äº0ï¼Œä¹Ÿå³æ²¡æœ‰æ•°æ®æˆ‘ä»¬å°±ç›´æ¥è¿”å›ä»·æ ¼å¹³å‡å€¼ï¼ˆå®é™…ä¸Šä¹Ÿåªä¼šè¿”å›NaNï¼‰ã€‚æœ€åç”±äºresampleå‡½æ•°è¿”å›çš„dataframeä¸­priceå’Œvolumeéƒ½è¢«é™„ä¸Šäº†æ–°çš„VWAPå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡ä¸‹æ ‡åªé€‰æ‹©priceè¿™ä¸€åˆ—æ•°æ®ï¼Œå¤šç”¨ä¸€ä¸ªä¸­æ‹¬å·æ˜¯ä¸ºäº†ç´¢å¼•åå¾—åˆ°çš„ä»æ—§æ˜¯ä¸€ä¸ªdataframeï¼Œæ‰“å°æ¯”è¾ƒç¾è§‚ã€‚ å‚è€ƒ ã€é‡‘èæ•°æ®å¤„ç†Tricksã€‘1. Resample Pandasä¸­resampleæ–¹æ³•è¯¦è§£ Update timeï¼š 2020-05-25 "},"Chapter2/Pandas nlargestå‡½æ•°.html":{"url":"Chapter2/Pandas nlargestå‡½æ•°.html","title":"Pandas nlargestå‡½æ•°","keywords":"","body":"Pandas nlargestå‡½æ•° nlargest() DataFrame.nlargest(self, n, columns, keep='first') â†’ 'DataFrame' è¿”å›æŒ‰åˆ—é™åºæ’åˆ—çš„å‰nè¡Œã€‚ ä»¥é™åºè¿”å›columnä¸­å…·æœ‰æœ€å¤§å€¼çš„å‰nè¡Œã€‚æœªæŒ‡å®šçš„åˆ—ä¹Ÿå°†è¿”å›ï¼Œä½†ä¸ç”¨äºæ’åºã€‚ æ­¤æ–¹æ³•ç­‰æ•ˆäº ï¼Œä½†æ€§èƒ½æ›´é«˜ã€‚df.sort_values(columns, ascending=False).head(n) å‚æ•° n : intè¦è¿”å›çš„è¡Œæ•°ã€‚ columns ï¼šæ ‡ç­¾æˆ–æ ‡ç­¾åˆ—è¡¨è¦æ’åºçš„åˆ—æ ‡ç­¾ã€‚ keep ï¼š{'first'ï¼Œ'last'ï¼Œ'all'}ï¼Œé»˜è®¤ä¸º'first'å…¶ä¸­æœ‰é‡å¤çš„å€¼: 1) firstï¼šä¼˜å…ˆå¤„ç†ç¬¬ä¸€æ¬¡å‡ºç°çš„äº‹ä»¶ 2) lastï¼šç¡®å®šæœ€åå‡ºç°çš„ä¼˜å…ˆé¡ºåº 3) all: è¯·å‹¿ä¸¢å¼ƒä»»ä½•é‡å¤é¡¹ï¼Œå³ä½¿è¿™æ„å‘³ç€é€‰æ‹©nä¸ªä»¥ä¸Šçš„é¡¹ç›®ã€‚ pandasçš„åˆ†ç»„å–æœ€å¤§å¤šè¡Œ é€‰æ‹©ä¸åŒlocation_roadä¸‹çš„å‰äº”åè¦æ€ä¹ˆæ“ä½œå‘¢ï¼Ÿ å¾ˆå¤šäººå¯èƒ½ç¬¬ä¸€ååº”ä¼šæƒ³åˆ°å…ˆåˆ†ç»„ç„¶åè¿›è¡Œmax()æ“ä½œï¼Œä½†æ˜¯è¿™æ ·çš„æ“ä½œåªèƒ½é€‰æ‹©æœ€å¤§çš„ä¸€åˆ—ï¼š nsmallest() ç”¨æ³•ç›¸åŒ å‚è€ƒ pandasçš„åˆ†ç»„å–æœ€å¤§å¤šè¡Œå¹¶æ±‚å’Œå‡½æ•° Update timeï¼š 2020-05-25 "},"Chapter2/Pandas renameå’Œreindex.html":{"url":"Chapter2/Pandas renameå’Œreindex.html","title":"Pandas rename()å’Œreindex()å‡½æ•°","keywords":"","body":"Pandas rename()å’Œreindex()å‡½æ•° pandas.DataFrame.rename æ›´æ”¹è¡Œååˆ—åã€‚ä¼ å…¥çš„å‡½æ•°æˆ–å­—å…¸å€¼å¿…é¡»æ˜¯1å¯¹1çš„ï¼Œæ²¡æœ‰åŒ…å«åœ¨å­—å…¸æˆ–è€…Seriesä¸­çš„æ ‡ç­¾å°†ä¿æŒåŸæ¥çš„åç§°ã€‚å­—å…¸ä¸­åŒ…å«dfä¸­æ²¡æœ‰çš„æ ‡ç­¾ï¼Œä¸ä¼šæŠ¥é”™ã€‚ DataFrame.rename(mapper=None, index=None, columns=None, axis=None, copy=True, inplace=False, level=None) å‚æ•°ï¼š mapper, index, columns : æ˜ å°„çš„è§„åˆ™ã€‚ axisï¼šæŒ‡å®šè½´ï¼Œå¯ä»¥æ˜¯è½´åç§°ï¼ˆ'index'ï¼Œ'columns'ï¼‰æˆ–æ•°å­—ï¼ˆ0,1ï¼‰ï¼Œé»˜è®¤ä¸ºindexã€‚ copyï¼šå¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸ºTrueï¼Œå¤åˆ¶åº•å±‚æ•°æ®ã€‚ inplaceï¼šå¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸ºFalseã€‚æŒ‡å®šæ˜¯å¦è¿”å›æ–°çš„DataFrameã€‚å¦‚æœä¸ºTrueï¼Œåˆ™åœ¨åŸdfä¸Šä¿®æ”¹ï¼Œè¿”å›å€¼ä¸ºNoneã€‚ levelï¼šintæˆ–level nameï¼Œé»˜è®¤ä¸ºNoneã€‚å¦‚æœæ˜¯MultiIndexï¼Œåªé‡å‘½åæŒ‡å®šçº§åˆ«çš„æ ‡ç­¾ã€‚ è¿”å›å€¼ï¼š DataFrame ä¸¤ç§ä¿®æ”¹çš„æ–¹æ³•ï¼š (index=index_mapper, columns=columns_mapper, ...) (mapper, axis={'index', 'columns'}, ...) In [1]: import numpy as np^M ...: import pandas as pd In [2]: list_l = [[1, 3, 3, 5, 4], [11, 7, 15, 13, 9], [4, 2, 7, 9, 3], [15, 11, 12, 6, 11]] ...: index = [\"2018-07-01\", \"2018-07-02\", \"2018-07-03\", \"2018-07-04\"] ...: df = pd.DataFrame(list_l, index=index, columns=['a', 'b', 'c', 'd', 'e']) In [3]: df Out[3]: a b c d e 2018-07-01 1 3 3 5 4 2018-07-02 11 7 15 13 9 2018-07-03 4 2 7 9 3 2018-07-04 15 11 12 6 11 # ç¬¬ä¸€ç§ä¿®æ”¹æ–¹æ³• In [4]: df_rename = df.rename({'a': 'rename_a', 'b': 'rename_b', 'c': 'rename_c', 'd': 'rename_d', 'e': 'rename_e'}, ...: axis='columns') In [5]: df_rename Out[5]: rename_a rename_b rename_c rename_d rename_e 2018-07-01 1 3 3 5 4 2018-07-02 11 7 15 13 9 2018-07-03 4 2 7 9 3 2018-07-04 15 11 12 6 11 # ç¬¬äºŒç§ä¿®æ”¹æ–¹æ³• In [6]: df_rename = df.rename(index={\"2018-07-01\": 71, \"2018-07-02\": 72, \"2018-07-03\": 73, \"2018-07-04\": 74}, ...: columns={'a': 'rename_a', 'b': 'rename_b', 'c': 'rename_c', 'd': 'rename_d', 'e': 'rename_e'}) In [7]: df_rename Out[7]: rename_a rename_b rename_c rename_d rename_e 71 1 3 3 5 4 72 11 7 15 13 9 73 4 2 7 9 3 74 15 11 12 6 11 å½“inplace=True æ—¶ï¼Œè¿”å›å€¼ä¸º Noneï¼Œå‡½æ•°ä¼šåœ¨åŸdfä¸Šè¿›è¡Œä¿®æ”¹ã€‚ In [9]: df_rename = df.rename(index={\"2018-07-01\": 71, \"2018-07-02\": 72, \"2018-07-03\": 73, \"2018-07-04\": 74},^M ...: columns={'a': 'rename_a', 'b': 'rename_b', 'c': 'rename_c', 'd': 'rename_d', 'e': 'rename ...: _e'}, inplace=True) In [10]: df Out[10]: rename_a rename_b rename_c rename_d rename_e 71 1 3 3 5 4 72 11 7 15 13 9 73 4 2 7 9 3 74 15 11 12 6 11 pandas.DataFrame.reindex é‡å»ºç´¢å¼•ï¼Œå¯¹äºç´¢å¼•æ²¡æœ‰å¯¹åº”å€¼çš„ï¼Œä½¿ç”¨ NaN æˆ–è€…æŒ‡å®šçš„å€¼å¡«å……ã€‚ DataFrame.reindex(labels=None, index=None, columns=None, axis=None, method=None, copy=True, level=None, fill_value=nan, limit=None, tolerance=None) å‚æ•°ï¼š method : ç”¨äºå¡«å……é‡å»ºç´¢å¼•çš„ DataFrame ä¸­çš„ç¼ºå¤±å€¼çš„æ–¹æ³•ã€‚ï¼ˆè¯·æ³¨æ„ï¼šä»…é€‚ç”¨äºå…·æœ‰å•è°ƒé€’å¢/é€’å‡ index çš„ DataFrames / Seriesã€‚ï¼‰ é»˜è®¤ï¼šä¸å¡«å…… pad / ffill: ä½¿ç”¨ä¸Šä¸€ä¸ªæœ‰æ•ˆè§‚å¯Ÿå¡«å…… backfill / bfill: ä½¿ç”¨ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„è§‚å¯Ÿå€¼å¡«å…… nearest: ä½¿ç”¨æœ€é è¿‘çš„æœ‰æ•ˆå€¼æ¥å¡«å……ç©ºç™½ copy: å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º Trueï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„ df å¯¹è±¡ï¼ˆè€Œä¸æ˜¯åœ¨åŸå¯¹è±¡ä¸Šä¿®æ”¹ï¼‰ã€‚ fill_value : æ ‡é‡ï¼Œé»˜è®¤ä¸º np.NaNï¼Œå¯ä»¥æ˜¯ä»»æ„çš„å€¼ã€‚ç”¨äºå¡«å……ç¼ºå¤±çš„å€¼ã€‚ è¿”å› : é‡å»ºç´¢å¼•æ–° DataFrame å¯¹è±¡ã€‚ DataFrame.reindex æ”¯æŒä¸¤ç§æ–¹æ³•ï¼š (index=index_labels, columns=column_labels, ...) (labels, axis={'index', 'columns'}, ...) import numpy as np import pandas as pd import matplotlib.pyplot as plt list_l = [[1, 3, 3, 5, 4.], [11, 7, 15, 13, 9.1], [4, 2, 7, 9, 3.5], [15, 11, 12, 6, 11.1]] index = [\"2018-07-01\", \"2018-07-02\", \"2018-07-03\", \"2018-07-04\"] df = pd.DataFrame(list_l, index=index, columns=['a', 'b', 'c', 'd', 'e']) print(df) \"\"\" a b c d e 2018-07-01 1 3 3 5 4.0 2018-07-02 11 7 15 13 9.1 2018-07-03 4 2 7 9 3.5 2018-07-04 15 11 12 6 11.1 \"\"\" # index new_index = [\"2018-07-04\", \"2018-07-05\", \"2018-07-06\"] df_reindex = df.reindex(index=new_index) df_reindex2 = df.reindex(labels=new_index, axis=\"index\") print(df_reindex) print(df_reindex2) \"\"\" a b c d e 2018-07-04 15.0 11.0 12.0 6.0 11.1 2018-07-05 NaN NaN NaN NaN NaN 2018-07-06 NaN NaN NaN NaN NaN \"\"\" # columns new_columns = [\"c\", \"d\", \"e\", \"f\"] df_re = df.reindex(columns=new_columns) df_re2 = df.reindex(labels=new_columns, axis=\"columns\") print(df_re) print(df_re2) \"\"\" c d e f 2018-07-01 3 5 4.0 NaN 2018-07-02 15 13 9.1 NaN 2018-07-03 7 9 3.5 NaN 2018-07-04 12 6 11.1 NaN \"\"\" å‚è€ƒ ã€pandasã€‘ ä¹‹ renameã€reindex Update timeï¼š 2020-05-25 "},"Chapter2/Pandas set_indexå’Œreset_indexå‡½æ•°.html":{"url":"Chapter2/Pandas set_indexå’Œreset_indexå‡½æ•°.html","title":"Pandas set_index()å’Œreset_index()å‡½æ•°","keywords":"","body":"Pandas set_index()å’Œreset_index()å‡½æ•° set_index() ä½œç”¨ï¼šDataFrameå¯ä»¥é€šè¿‡set_indexæ–¹æ³•ï¼Œå°†æ™®é€šåˆ—è®¾ç½®ä¸ºå•ç´¢å¼•/å¤åˆç´¢å¼•ã€‚ æ ¼å¼ï¼šDataFrame.set_index(keys, drop=True, append=False, inplace=False, verify_integrity=False) å‚æ•°å«ä¹‰ï¼š keysï¼šåˆ—æ ‡ç­¾æˆ–åˆ—æ ‡ç­¾/æ•°ç»„åˆ—è¡¨ï¼Œéœ€è¦è®¾ç½®ä¸ºç´¢å¼•çš„æ™®é€šåˆ— dropï¼šæ˜¯å¦åˆ é™¤åŸæ™®é€šåˆ—ï¼Œé»˜è®¤ä¸ºTrueï¼Œåˆ é™¤ç”¨ä½œæ–°ç´¢å¼•çš„åŸæ™®é€šåˆ—ï¼› appendï¼šæ˜¯å¦å˜æˆå¤åˆç´¢å¼•ï¼Œé»˜è®¤ä¸ºFalseï¼Œå³è¦†ç›–åŸç´¢å¼•ï¼Œå•ç´¢å¼•ï¼› inplaceï¼šé»˜è®¤ä¸ºFalseï¼Œé€‚å½“ä¿®æ”¹DataFrame(ä¸è¦åˆ›å»ºæ–°å¯¹è±¡)ï¼› verify_integrityï¼šé»˜è®¤ä¸ºfalseï¼Œæ£€æŸ¥æ–°ç´¢å¼•çš„å‰¯æœ¬ã€‚å¦åˆ™ï¼Œè¯·å°†æ£€æŸ¥æ¨è¿Ÿåˆ°å¿…è¦æ—¶è¿›è¡Œã€‚å°†å…¶è®¾ç½®ä¸ºfalseå°†æé«˜è¯¥æ–¹æ³•çš„æ€§èƒ½ã€‚ å‚æ•°drop # dropçš„ä½¿ç”¨ï¼š import pandas as pd df = pd.DataFrame({ 'A': ['A0', 'A1', 'A2', 'A3','A4'], 'B': ['B0', 'B1', 'B2', 'B3','B4'], 'C': ['C0', 'C1', 'C2', 'C3','C4'], 'D': ['D0', 'D1', 'D2', 'D3','D4']}) print ('è¾“å‡ºç»“æœ:\\n',df) print('------') df_drop_t = df.set_index('A',drop=True) # dropé»˜è®¤Trueï¼Œæ™®é€šåˆ—è¢«ç”¨ä½œç´¢å¼•åï¼ŒåŸåˆ—åˆ é™¤ print (df_drop_t) print('------') df_drop_f = df.set_index('A',drop=False) # æ™®é€šåˆ—è¢«ç”¨ä½œç´¢å¼•åï¼ŒåŸåˆ—ä¿ç•™ print (df_drop_f) ''' è¾“å‡ºç»“æœ: A B C D 0 A0 B0 C0 D0 1 A1 B1 C1 D1 2 A2 B2 C2 D2 3 A3 B3 C3 D3 4 A4 B4 C4 D4 ------ B C D A A0 B0 C0 D0 A1 B1 C1 D1 A2 B2 C2 D2 A3 B3 C3 D3 A4 B4 C4 D4 ------ A B C D A A0 A0 B0 C0 D0 A1 A1 B1 C1 D1 A2 A2 B2 C2 D2 A3 A3 B3 C3 D3 A4 A4 B4 C4 D4 ''' å‚æ•° append # appendçš„ä½¿ç”¨ import pandas as pd df = pd.DataFrame({ 'A': ['A0', 'A1', 'A2', 'A3','A4'], 'B': ['B0', 'B1', 'B2', 'B3','B4'], 'C': ['C0', 'C1', 'C2', 'C3','C4'], 'D': ['D0', 'D1', 'D2', 'D3','D4']}) print ('è¾“å‡ºç»“æœ:\\n',df) print('------') df_append_f = df.set_index('A', append=False) # appendé»˜è®¤ä¸ºFalseï¼Œæ™®é€šåˆ—å˜ä¸ºç´¢å¼•ï¼Œå¹¶è¦†ç›–åŸç´¢å¼•ï¼ŒåŸç´¢å¼•è¢«åˆ é™¤ print (df_append_f) df_append_t = df.set_index('A', append=True) # è¡¨ç¤ºå°†æ™®é€šåˆ—å˜ä¸ºç´¢å¼•ï¼ŒåŸç´¢å¼•ä¿ç•™ï¼Œå˜æˆäº†å¤åˆç´¢å¼• print (df_append_t) print('------') ''' è¾“å‡ºç»“æœ: A B C D 0 A0 B0 C0 D0 1 A1 B1 C1 D1 2 A2 B2 C2 D2 3 A3 B3 C3 D3 4 A4 B4 C4 D4 ------ B C D A A0 B0 C0 D0 A1 B1 C1 D1 A2 B2 C2 D2 A3 B3 C3 D3 A4 B4 C4 D4 ------ B C D A 0 A0 B0 C0 D0 1 A1 B1 C1 D1 2 A2 B2 C2 D2 3 A3 B3 C3 D3 4 A4 B4 C4 D4 ''' å‚æ•°inplace # inplaceçš„ä½¿ç”¨ï¼Œè¾“å‡ºNone df = pd.DataFrame({ 'A': ['A0', 'A1', 'A2', 'A3','A4'], 'B': ['B0', 'B1', 'B2', 'B3','B4'], 'C': ['C0', 'C1', 'C2', 'C3','C4'], 'D': ['D0', 'D1', 'D2', 'D3','D4']}) df_inplace_f = df.set_index('A', inplace=False) # inplaé»˜è®¤ä¸ºFalseï¼Œè¡¨ç¤ºé€‚å½“ä¿®æ”¹DataFrame(ä¸è¦åˆ›å»ºæ–°å¯¹è±¡) print ('è¾“å‡ºç»“æœï¼š\\n',df_inplace_f) print('------') df1 = pd.DataFrame({ 'A': ['A0', 'A1', 'A2', 'A3','A4'], 'B': ['B0', 'B1', 'B2', 'B3','B4'], 'C': ['C0', 'C1', 'C2', 'C3','C4'], 'D': ['D0', 'D1', 'D2', 'D3','D4']}) df_inplace_t = df1.set_index('A',inplace=True) # è¡¨ç¤ºåŸåœ°ä¸åŠ¨ print (df_inplace_t) print (type(df_inplace_t)) ''' è¾“å‡ºç»“æœï¼š B C D A A0 B0 C0 D0 A1 B1 C1 D1 A2 B2 C2 D2 A3 B3 C3 D3 A4 B4 C4 D4 ------ None ''' reset_index() ä½œç”¨ï¼šreset_indexå¯ä»¥è¿˜åŸç´¢å¼•ä¸ºæ™®é€šåˆ—ï¼Œé‡æ–°å˜ä¸ºé»˜è®¤çš„æ•´å‹ç´¢å¼• ï¼ˆæ³¨ï¼šreset_indexè¿˜åŸåˆ†ä¸ºä¸¤ç§ç±»å‹ï¼Œç¬¬ä¸€ç§æ˜¯å¯¹åŸDataFrameè¿›è¡Œresetï¼Œç¬¬äºŒç§æ˜¯å¯¹ä½¿ç”¨è¿‡set_index()å‡½æ•°çš„DataFrameè¿›è¡Œresetï¼‰ æ ¼å¼ï¼šDataFrame.reset_index(level=None, drop=False, inplace=False, col_level=0, col_fill=â€) å‚æ•°å«ä¹‰ï¼š levelï¼šintã€strã€tupleæˆ–listï¼Œé»˜è®¤æ— ï¼Œä»…ä»ç´¢å¼•ä¸­åˆ é™¤ç»™å®šçº§åˆ«ã€‚é»˜è®¤æƒ…å†µä¸‹ç§»é™¤æ‰€æœ‰çº§åˆ«ã€‚æ§åˆ¶äº†å…·ä½“è¦è¿˜åŸçš„é‚£ä¸ªç­‰çº§çš„ç´¢å¼• dropï¼šç´¢å¼•è¢«è¿˜åŸæˆæ™®é€šåˆ—åï¼Œæ˜¯å¦åˆ æ‰åˆ—ã€‚é»˜è®¤ä¸ºFalseï¼Œä¸ºFalseæ—¶åˆ™ç´¢å¼•åˆ—ä¼šè¢«è¿˜åŸä¸ºæ™®é€šåˆ—ï¼Œå¦åˆ™è¢«è¿˜åŸåçš„çš„åˆ—åˆä¼šè¢«ç¬é—´åˆ æ‰ï¼› inplaceï¼šé»˜è®¤ä¸ºfalseï¼Œé€‚å½“ä¿®æ”¹DataFrame(ä¸è¦åˆ›å»ºæ–°å¯¹è±¡)ï¼› col_levelï¼šintæˆ–strï¼Œé»˜è®¤å€¼ä¸º0ï¼Œå¦‚æœåˆ—æœ‰å¤šä¸ªçº§åˆ«ï¼Œåˆ™ç¡®å®šå°†æ ‡ç­¾æ’å…¥åˆ°å“ªä¸ªçº§åˆ«ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå°†æ’å…¥åˆ°ç¬¬ä¸€çº§ï¼› col_fillï¼šå¯¹è±¡ï¼Œé»˜è®¤â€˜â€™ï¼Œå¦‚æœåˆ—æœ‰å¤šä¸ªçº§åˆ«ï¼Œåˆ™ç¡®å®šå…¶ä»–çº§åˆ«çš„å‘½åæ–¹å¼ã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™é‡å¤ç´¢å¼•åï¼› å¯¹åŸDataFrameè¿›è¡Œreset # ä¸€èˆ¬æƒ…å†µä¸‹å‚æ•°åªä½¿ç”¨åˆ°dropï¼Œè¿™é‡Œåªæ¼”ç¤ºdropçš„ä½¿ç”¨ import pandas as pd df = pd.DataFrame({ 'A': ['A0', 'A1', 'A2', 'A3','A4'], 'B': ['B0', 'B1', 'B2', 'B3','B4'], 'C': ['C0', 'C1', 'C2', 'C3','C4'], 'D': ['D0', 'D1', 'D2', 'D3','D4']}) print ('è¾“å‡ºç»“æœ\\ndf:\\n',df) print('------') df1 = df.reset_index(drop=False) # é»˜è®¤ä¸ºFalseï¼ŒåŸæœ‰çš„ç´¢å¼•ä¸å˜,æ·»åŠ ä¸€åˆ—ï¼Œåˆ—åindexï¼› print (df1) print('------') df2 = df.reset_index(drop=True) # ç´¢å¼•è¢«è¿˜åŸä¸ºæ™®é€šåˆ—ï¼Œç¬é—´åˆè¢«åˆ æ‰äº†ï¼ŒåŒæ—¶åœ¨åŸä½ç½®é‡ç½®åŸå§‹ç´¢å¼•012...ï¼› print (df2) ''' è¾“å‡ºç»“æœ df: A B C D 0 A0 B0 C0 D0 1 A1 B1 C1 D1 2 A2 B2 C2 D2 3 A3 B3 C3 D3 4 A4 B4 C4 D4 ------ index A B C D 0 0 A0 B0 C0 D0 1 1 A1 B1 C1 D1 2 2 A2 B2 C2 D2 3 3 A3 B3 C3 D3 4 4 A4 B4 C4 D4 ------ A B C D 0 A0 B0 C0 D0 1 A1 B1 C1 D1 2 A2 B2 C2 D2 3 A3 B3 C3 D3 4 A4 B4 C4 D4 ''' å¯¹ä½¿ç”¨è¿‡set_index()å‡½æ•°çš„DataFrameè¿›è¡Œreset # ä¸€èˆ¬æƒ…å†µä¸‹å‚æ•°åªä½¿ç”¨åˆ°dropï¼Œè¿™é‡Œåªæ¼”ç¤ºdropçš„ä½¿ç”¨ import pandas as pd df = pd.DataFrame({ 'A': ['A0', 'A1', 'A2', 'A3','A4'], 'B': ['B0', 'B1', 'B2', 'B3','B4'], 'C': ['C0', 'C1', 'C2', 'C3','C4'], 'D': ['D0', 'D1', 'D2', 'D3','D4']}) print ('è¾“å‡ºç»“æœï¼š\\ndf:\\n' ,df) print('------') newdf = df.set_index('A') # è¿™é‡Œçš„dropå¿…éœ€ä¸ºTrueï¼ˆé»˜è®¤ä¸ºè¿™é‡Œçš„dropå¿…éœ€ä¸ºTrueï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™ValueError: cannot insert A, already existsï¼ˆæ„æ€æ˜¯...åªå¯æ„ä¼šä¸å¯è¨€ä¼ å“ˆå“ˆï¼‰ print (newdf) print('------') newdf1 = newdf.reset_index(drop=False) #ç´¢å¼•åˆ—ä¼šè¢«è¿˜åŸä¸ºæ™®é€šåˆ— print (newdf1) print('------') newdf2 = newdf.reset_index(drop=True) #ç´¢å¼•è¢«è¿˜åŸä¸ºæ™®é€šåˆ—ï¼Œç¬é—´åˆè¢«åˆ æ‰äº†ï¼ŒåŒæ—¶åœ¨åŸä½ç½®é‡ç½®åŸå§‹ç´¢å¼•ï¼› print (newdf2) ''' è¾“å‡ºç»“æœï¼š df: A B C D 0 A0 B0 C0 D0 1 A1 B1 C1 D1 2 A2 B2 C2 D2 3 A3 B3 C3 D3 4 A4 B4 C4 D4 ------ B C D A A0 B0 C0 D0 A1 B1 C1 D1 A2 B2 C2 D2 A3 B3 C3 D3 A4 B4 C4 D4 ------ A B C D 0 A0 B0 C0 D0 1 A1 B1 C1 D1 2 A2 B2 C2 D2 3 A3 B3 C3 D3 4 A4 B4 C4 D4 ------ B C D 0 B0 C0 D0 1 B1 C1 D1 2 B2 C2 D2 3 B3 C3 D3 4 B4 C4 D4 ''' å‚è€ƒ åŒºåˆ« python-pandasåº“set_indexã€reset_indexç”¨æ³•åŒºåˆ« Update timeï¼š 2020-05-25 "},"Chapter2/Pandas pd.cutå‡½æ•°.html":{"url":"Chapter2/Pandas pd.cutå‡½æ•°.html","title":"Pandas pd.cut()å‡½æ•°","keywords":"","body":"Pandas pd.cut()å‡½æ•° å°†æ•°æ®è¿›è¡Œç¦»æ•£åŒ– pandas.cut(x, bins, right=True, labels=None, retbins=False, precision=3, include_lowest=False ) å‚æ•° x : è¿›è¡Œåˆ’åˆ†çš„ä¸€ç»´æ•°ç»„ bins: æ•´æ•°---å°† x åˆ’åˆ†ä¸ºå¤šå°‘ä¸ªç­‰é—´è·çš„åŒºé—´ åºåˆ—â€”å°† x åˆ’åˆ†åœ¨æŒ‡å®šçš„åºåˆ—ä¸­ï¼Œè‹¥ä¸åœ¨è¯¥åºåˆ—ä¸­ï¼Œåˆ™æ˜¯NaN right : æ˜¯å¦åŒ…å«å³ç«¯ç‚¹ labels : æ˜¯å¦ç”¨æ ‡è®°æ¥ä»£æ›¿è¿”å›çš„bins precision: ç²¾åº¦ include_lowest: æ˜¯å¦åŒ…å«å·¦ç«¯ç‚¹ è¿”å›å€¼: å¦‚æœ retbins = False åˆ™è¿”å›xä¸­æ¯ä¸ªå€¼å¯¹åº”çš„binçš„åˆ—è¡¨ï¼Œå¦è€…åˆ™è¿”å›xä¸­æ¯ä¸ªå€¼å¯¹åº”çš„binçš„åˆ—è¡¨å’Œå¯¹åº”çš„bins pd.cut( çš„ä½œç”¨ï¼Œæœ‰ç‚¹ç±»ä¼¼ç»™æˆç»©è®¾å®šä¼˜è‰¯ä¸­å·®ï¼Œæ¯”å¦‚ï¼š0-59åˆ†ä¸ºå·®ï¼Œ60-70åˆ†ä¸ºä¸­ï¼Œ71-80åˆ†ä¸ºä¼˜ç§€ç­‰ç­‰ï¼Œåœ¨pandasä¸­ï¼Œä¹Ÿæä¾›äº†è¿™æ ·ä¸€ä¸ªæ–¹æ³•æ¥å¤„ç†è¿™äº›äº‹å„¿ã€‚ import numpy as np import pandas as pd np.random.seed(666) score_list = np.random.randint(25,100,20) score_list array([27, 70, 55, 87, 95, 98, 55, 61, 86, 76, 85, 53, 39, 88, 41, 71, 64, 94, 38, 94]) # æŒ‡å®šå¤šä¸ªåŒºé—´ bins = [0, 59, 70, 80, 100] score_cut = pd.cut(score_list, bins) type(score_cut) # pandas.core.arrays.categorical.Categorical score_cut [(0, 59], (59, 70], (0, 59], (80, 100], (80, 100], ..., (70, 80], (59, 70], (80, 100], (0, 59], (80, 100]] Length: 20 Categories (4, interval[int64]): [(0, 59] # ç»Ÿè®¡æ¯ä¸ªåŒºé—´çš„äººæ•° pd.value_counts(score_cut) (80, 100] 8 (0, 59] 7 (59, 70] 3 (70, 80] 2 dtype: int64 df = pd.DataFrame() df['score'] = score_list df['student'] = [pd.util.testing.rands(3) for i in range(len(score_list))] df score student 0 27 1ul 1 70 yuK 2 55 WWK 3 87 EU6 4 95 Vqn 5 98 KAf 6 55 QNT 7 61 HaE 8 86 aBo 9 76 MMa 10 85 Ctc 11 53 5BI 12 39 wBp 13 88 WMB 14 41 q5t 15 71 MjZ 16 64 nTc 17 94 Kyx 18 38 Rlh 19 94 2uV # ä½¿ç”¨cutæ–¹æ³•è¿›è¡Œåˆ†ç®± pd.cut(df['score'], bins) 0 (0, 59] 1 (59, 70] 2 (0, 59] 3 (80, 100] 4 (80, 100] 5 (80, 100] 6 (0, 59] 7 (59, 70] 8 (80, 100] 9 (70, 80] 10 (80, 100] 11 (0, 59] 12 (0, 59] 13 (80, 100] 14 (0, 59] 15 (70, 80] 16 (59, 70] 17 (80, 100] 18 (0, 59] 19 (80, 100] Name: score, dtype: category Categories (4, interval[int64]): [(0, 59] df['Categories'] = pd.cut(df['score'], bins) df score student Categories 0 27 1ul (0, 59] 1 70 yuK (59, 70] 2 55 WWK (0, 59] 3 87 EU6 (80, 100] 4 95 Vqn (80, 100] 5 98 KAf (80, 100] 6 55 QNT (0, 59] 7 61 HaE (59, 70] 8 86 aBo (80, 100] 9 76 MMa (70, 80] 10 85 Ctc (80, 100] 11 53 5BI (0, 59] 12 39 wBp (0, 59] 13 88 WMB (80, 100] 14 41 q5t (0, 59] 15 71 MjZ (70, 80] 16 64 nTc (59, 70] 17 94 Kyx (80, 100] 18 38 Rlh (0, 59] 19 94 2uV (80, 100] # ä½†æ˜¯è¿™æ ·çš„æ–¹æ³•ä¸æ˜¯å¾ˆé€‚åˆé˜…è¯»ï¼Œå¯ä»¥ä½¿ç”¨cutæ–¹æ³•ä¸­çš„labelå‚æ•° # ä¸ºæ¯ä¸ªåŒºé—´æŒ‡å®šä¸€ä¸ªlabel df['Categories'] = pd.cut(df['score'], bins, labels=[ 'low', 'middle', 'good', 'perfect']) df å‚è€ƒï¼š pandasä¸­pd.cut()çš„åŠŸèƒ½å’Œä½œç”¨ Update timeï¼š 2020-05-25 "},"Chapter2/Pandas pd.Categoricalå‡½æ•°.html":{"url":"Chapter2/Pandas pd.Categoricalå‡½æ•°.html","title":"Pandas pd.Categorical()å‡½æ•°","keywords":"","body":"Pandas pd.Categorical()å‡½æ•° pandas.Categorical(values, categories = None, ordered = None, dtype = Nonel fastpath = False ) å‚æ•°ï¼š valuesï¼šç±»ä¼¼åˆ—è¡¨ã€‚åˆ†ç±»çš„å€¼ï¼Œå¦‚æœç»™å‡ºäº†ç±»åˆ«ï¼Œåˆ™ä¸åœ¨ç±»åˆ«ä¸­çš„å€¼å°†æ›¿æ¢ä¸ºNaNã€‚ categoriesï¼šç´¢å¼•å¼ï¼ˆå”¯ä¸€ï¼‰ï¼Œå¯é€‰ã€‚æ­¤åˆ†ç±»çš„å”¯ä¸€ç±»åˆ«ã€‚å¦‚æœæ²¡æœ‰ç»™å‡ºï¼Œåˆ™å‡å®šç±»åˆ«æ˜¯å€¼çš„å”¯ä¸€å€¼ã€‚ orderedï¼šå¸ƒå°”å€¼ï¼Œï¼ˆé»˜è®¤ä¸ºFalseï¼‰ã€‚æ­¤åˆ†ç±»æ˜¯å¦è¢«è§†ä¸ºæœ‰åºåˆ†ç±»ã€‚å¦‚æœæ²¡æœ‰ç»™å‡ºï¼Œåˆ™ä¸ä¼šè®¢è´­ç”Ÿæˆçš„åˆ†ç±»ã€‚ dtypeï¼šCategoricalDtypeï¼ŒCategoricalDtypeç”¨äºæ­¤åˆ†ç±»çš„å®ä¾‹ ç¤ºä¾‹ In [16]: st = ['a','a','b','c','c'] In [17]: ss = pd.Categorical(st) In [18]: ss Out[18]: [a, a, b, c, c] Categories (3, object): [a, b, c] In [22]: ss.dtype Out[22]: CategoricalDtype(categories=['a', 'b', 'c'], ordered=False) è¿™é‡Œå°±å¯ä»¥çœ‹åˆ° categorical å®é™…ä¸Šæ˜¯è®¡ç®—ä¸€ä¸ªåˆ—è¡¨å‹æ•°æ®ä¸­çš„ç±»åˆ«æ•°ï¼Œå³ä¸é‡å¤é¡¹ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªCategoricalDtype ç±»å‹çš„å¯¹è±¡ï¼Œç›¸å½“äºåœ¨åŸæ¥æ•°æ®ä¸Šé™„åŠ ä¸Šç±»åˆ«ä¿¡æ¯ å±æ€§ codeså’Œ categories å…·ä½“çš„ç±»åˆ«å¯ä»¥é€šè¿‡å’Œå¯¹åº”çš„åºå·å¯ä»¥é€šè¿‡codeså’Œ categoriesæ¥æŸ¥çœ‹ï¼š In [23]: ss.codes Out[23]: array([0, 0, 1, 2, 2], dtype=int8) In [21]: ss.categories Out[21]: Index(['a', 'b', 'c'], dtype='object') æœ‰åºåˆ†ç±»å¯ä»¥æ ¹æ®ç±»åˆ«çš„è‡ªå®šä¹‰é¡ºåºè¿›è¡Œæ’åºï¼Œå¹¶ä¸”å¯ä»¥å…·æœ‰æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚ >>>c = pd.Categorical(['a','b','c','a','b','c'], ordered=True, categories=['c', 'b', 'a']) >>> c [a, b, c, a, b, c] Categories (3, object): [c >> c.min() 'c' å±æ€§ categories è¿™ç§åˆ†ç±»çš„ç±»åˆ«ã€‚ codes æ­¤ç±»åˆ«çš„ç±»åˆ«ä»£ç ã€‚ ordered ç±»åˆ«æ˜¯å¦å…·æœ‰æœ‰åºå…³ç³» dtype åœ¨CategoricalDtypeæ­¤å®ä¾‹ å‚è€ƒï¼š pandas ä¸­ pd.Categoricalç”¨æ³• Update timeï¼š 2020-05-25 "},"Chapter2/Pandas pd.get_dummieså‡½æ•°.html":{"url":"Chapter2/Pandas pd.get_dummieså‡½æ•°.html","title":"Pandas pd.get_dummies()å‡½æ•°","keywords":"","body":"Pandas pd.get_dummies()å‡½æ•° get_dummies æ˜¯åˆ©ç”¨ pandas å®ç°one hot encodeçš„æ–¹å¼ã€‚è¯¦ç»†å‚æ•°è¯·æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ å®˜æ–¹æ–‡æ¡£åœ¨è¿™é‡Œ pandas.get_dummies(data, prefix=None, prefix_sep='_', dummy_na=False, columns=None, sparse=False, drop_first=False ) å‚æ•°è¯´æ˜ï¼š data : array-like, Series, or DataFrame è¾“å…¥çš„æ•°æ® prefix : string, list of strings, or dict of strings, default None get_dummiesè½¬æ¢åï¼Œåˆ—åçš„å‰ç¼€ columns: list-like, default None æŒ‡å®šéœ€è¦å®ç°ç±»åˆ«è½¬æ¢çš„åˆ—å dummy_na : bool, default False å¢åŠ ä¸€åˆ—è¡¨ç¤ºç©ºç¼ºå€¼ï¼Œå¦‚æœFalseå°±å¿½ç•¥ç©ºç¼ºå€¼ drop_first : bool, default False è·å¾—kä¸­çš„k-1ä¸ªç±»åˆ«å€¼ï¼Œå»é™¤ç¬¬ä¸€ä¸ª æ¡ˆä¾‹ import pandas as pd df = pd.DataFrame([ ['green' , 'A'], ['red' , 'B'], ['blue' , 'A']]) df.columns = ['color', 'class'] pd.get_dummies(df) get_dummies å‰ï¼š color class 0 green A 1 red B 2 blue A get_dummies åï¼š color_blue color_green color_red class_A class_B 0 0 1 0 1 0 1 0 0 1 0 1 2 1 0 0 1 0 å¯ä»¥å¯¹æŒ‡å®šåˆ—è¿›è¡Œ get_dummies pd.get_dummies(df.color) Update timeï¼š 2020-05-25 "},"Chapter2/Pandas pd.Series.to_dictå‡½æ•°.html":{"url":"Chapter2/Pandas pd.Series.to_dictå‡½æ•°.html","title":"Pandas pd.Series.to_dict()å‡½æ•°","keywords":"","body":"Pandas pd.Series.to_dict()å‡½æ•° Series.to_dict(self, into=) å‚æ•°ï¼š orient : str {â€˜dictâ€™, â€˜listâ€™, â€˜seriesâ€™, â€˜splitâ€™, â€˜recordsâ€™, â€˜indexâ€™} dict (default) : {column -> {index -> value}} list: {column -> [values]} series : {column -> Series(values)} split : {â€˜indexâ€™ -> [index], â€˜columnsâ€™ -> [columns], â€˜dataâ€™ -> [values]} records : [{column -> value}, â€¦ , {column -> value}] index: {index -> {column -> value}} è¿”å› dict, list æˆ– collections.Mapping é€‰æ‹©å‚æ•° orient=dict dictä¹Ÿæ˜¯é»˜è®¤çš„å‚æ•°ï¼Œä¸‹é¢çš„dataæ•°æ®ç±»å‹ä¸ºDataFrameç»“æ„, ä¼šå½¢æˆ {column -> {index -> value}}è¿™æ ·çš„ç»“æ„çš„å­—å…¸ï¼Œå¯ä»¥çœ‹æˆæ˜¯ä¸€ç§åŒé‡å­—å…¸ç»“æ„ å•ç‹¬æå–æ¯åˆ—çš„å€¼åŠå…¶ç´¢å¼•ï¼Œç„¶åç»„åˆæˆä¸€ä¸ªå­—å…¸ å†å°†ä¸Šè¿°çš„åˆ—å±æ€§ä½œä¸ºå…³é”®å­—ï¼ˆkeyï¼‰ï¼Œå€¼ï¼ˆvaluesï¼‰ä¸ºä¸Šè¿°çš„å­—å…¸ æŸ¥è¯¢æ–¹å¼ä¸º ï¼šdata_dict[key1][key2] data_dict ä¸ºå‚æ•°é€‰æ‹©orient=â€™dictâ€™æ—¶çš„æ•°æ®å key1 ä¸ºåˆ—å±æ€§çš„é”®å€¼ï¼ˆå¤–å±‚ï¼‰ key2 ä¸ºå†…å±‚å­—å…¸å¯¹åº”çš„é”®å€¼ >>> df = pd.DataFrame({'col1': [1, 2], ... 'col2': [0.5, 0.75]}, ... index=['row1', 'row2']) >>> df col1 col2 row1 1 0.50 row2 2 0.75 >>> df.to_dict() {'col1': {'row1': 1, 'row2': 2}, 'col2': {'row1': 0.5, 'row2': 0.75}} å½“å…³é”®å­— orient= list å’Œ1ä¸­æ¯”è¾ƒç›¸ä¼¼ï¼Œåªä¸è¿‡å†…å±‚å˜æˆäº†ä¸€ä¸ªåˆ—è¡¨ï¼Œç»“æ„ä¸º{column -> [values]} æŸ¥è¯¢æ–¹å¼ä¸ºï¼š data_list[keys][index] data_list ä¸ºå…³é”®å­—orient=â€™listâ€™ æ—¶å¯¹åº”çš„æ•°æ®å keys ä¸ºåˆ—å±æ€§çš„é”®å€¼ï¼Œ index ä¸ºæ•´å‹ç´¢å¼•ï¼Œä»0å¼€å§‹åˆ°æœ€å >>> df.to_dict('list') # {'col1': [1, 2], 'col2': [0.5, 0.75]} df.to_dict('list')['col2'][1] # 0.75 å…³é”®å­—å‚æ•°orient=series å½¢æˆç»“æ„{column -> Series(values)} è°ƒç”¨æ ¼å¼ä¸ºï¼šdata_series[key1][key2]æˆ– data_dict[key1] data_series ä¸ºæ•°æ®å¯¹åº”çš„åå­— key1 ä¸ºåˆ—å±æ€§çš„é”®å€¼ key2 ä½¿ç”¨æ•°æ®åŸå§‹çš„ç´¢å¼•ï¼ˆå¯é€‰ï¼‰ >>> df.to_dict('series') {'col1': row1 1 row2 2 Name: col1, dtype: int64, 'col2': row1 0.50 row2 0.75 Name: col2, dtype: float64} å…³é”®å­—å‚æ•° orient=split å½¢æˆ{index -> [index], columns -> [columns], data -> [values]}çš„ç»“æ„ï¼Œæ˜¯å°†æ•°æ®ã€ç´¢å¼•ã€å±æ€§åå•ç‹¬è„±ç¦»å‡ºæ¥æ„æˆå­—å…¸ è°ƒç”¨æ–¹å¼æœ‰ data_split[â€˜indexâ€™],data_split[â€˜dataâ€™],data_split[â€˜columnsâ€™] df.to_dict('split') {'index': ['row1', 'row2'], 'columns': ['col1', 'col2'], 'data': [[1, 0.5], [2, 0.75]]} df.to_dict('split')['data'] # [[1, 0.5], [2, 0.75]] å½“å…³é”®å­—orient=records å½¢æˆ[{column -> value}, â€¦ , {column -> value}]çš„ç»“æ„ æ•´ä½“æ„æˆä¸€ä¸ªåˆ—è¡¨ï¼Œå†…å±‚æ˜¯å°†åŸå§‹æ•°æ®çš„æ¯è¡Œæå–å‡ºæ¥å½¢æˆå­—å…¸ è°ƒç”¨æ ¼å¼ä¸ºdata_records[index][key1] df.to_dict(orient='records') # [{'col1': 1, 'col2': 0.5}, {'col1': 2, 'col2': 0.75}] å½“å…³é”®å­—orient=index å½¢æˆ{index -> {column -> value}}çš„ç»“æ„ï¼Œè°ƒç”¨æ ¼å¼æ­£å¥½å’Œâ€™dictâ€™ å¯¹åº”çš„åè¿‡æ¥ df.to_dict(orient='index') # {'row1': {'col1': 1, 'col2': 0.5}, 'row2': {'col1': 2, 'col2': 0.75}} å‚è€ƒ pandas to_dict çš„ç”¨æ³• Update timeï¼š 2020-05-25 "},"Chapter2/Pandas Series.to_frame.html":{"url":"Chapter2/Pandas Series.to_frame.html","title":"Pandas Series.to_frame","keywords":"","body":"Pandas Series.to_frame Pandas ç³»åˆ—æ˜¯å¸¦æœ‰è½´æ ‡ç­¾çš„ä¸€ç»´ndarrayã€‚æ ‡ç­¾ä¸å¿…æ˜¯å”¯ä¸€çš„ï¼Œä½†å¿…é¡»æ˜¯å¯å“ˆå¸Œçš„ç±»å‹ã€‚è¯¥å¯¹è±¡åŒæ—¶æ”¯æŒåŸºäºæ•´æ•°å’ŒåŸºäºæ ‡ç­¾çš„ç´¢å¼•ï¼Œå¹¶æä¾›äº†è®¸å¤šæ–¹æ³•æ¥æ‰§è¡Œæ¶‰åŠç´¢å¼•çš„æ“ä½œã€‚ Pandas Series.to_frame()å‡½æ•°ç”¨äºå°†ç»™å®šçš„ç³»åˆ—å¯¹è±¡è½¬æ¢ä¸º DataFrame ã€‚ ç”¨æ³•ï¼šSeries.to_frame(name=None) å‚æ•°ï¼š name:ä¼ é€’çš„åç§°åº”æ›¿æ¢ç³»åˆ—åç§°(å¦‚æœæœ‰çš„è¯)ã€‚ è¿”å›ï¼šdata_frameï¼šDataFrame # importing pandas as pd import pandas as pd # Creating the Series sr = pd.Series(['New York', 'Chicago', 'Toronto', 'Lisbon', 'Rio', 'Moscow']) # Create the Datetime Index didx = pd.DatetimeIndex(start ='2014-08-01 10:00', freq ='W', periods = 6, tz = 'Europe/Berlin') # set the index sr.index = didx # Print the series print(sr) è¾“å‡º ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨Series.to_frame()å‡½æ•°å°†ç»™å®šçš„ç³»åˆ—å¯¹è±¡è½¬æ¢ä¸º DataFrame # convert to dataframe sr.to_frame() å‚è€ƒ Python Pandas Series.to_frame() Update timeï¼š 2020-05-25 "},"Chapter2/Pandas æ•°æ®å»é‡.html":{"url":"Chapter2/Pandas æ•°æ®å»é‡.html","title":"Pandas æ•°æ®å»é‡","keywords":"","body":"Pandas æ•°æ®å»é‡ æ•°æ®å»é‡å¯ä»¥ä½¿ç”¨ duplicated() å’Œ drop_duplicates() ä¸¤ä¸ªæ–¹æ³•ã€‚ drop_duplicates() df.drop_duplicates(subset=None, keep='first', inplace=False) drop_duplicate æ–¹æ³•æ˜¯å¯¹ DataFrame æ ¼å¼çš„æ•°æ®ï¼Œå»é™¤ç‰¹å®šåˆ—ä¸‹é¢çš„é‡å¤è¡Œã€‚è¿”å›DataFrame æ ¼å¼çš„æ•°æ®ã€‚ å‚æ•° subsetï¼šå¯ä»¥æŒ‡å®šä¼ å…¥å•ä¸ªåˆ—æ ‡ç­¾æˆ–è€…ä¸€ä¸ªåˆ—æ ‡ç­¾çš„åˆ—è¡¨ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨æ‰€æœ‰çš„åˆ—æ ‡ç­¾ï¼Œå³ä¼šåˆ é™¤ä¸€æ•´è¡Œ keepï¼šæœ‰ {â€˜firstâ€™, â€˜lastâ€™, False} ä¸‰ä¸ªå¯ä¾›é€‰æ‹©, é»˜è®¤å€¼ â€˜firstâ€™ï¼Œæ„å‘³ç€é™¤äº†ç¬¬ä¸€ä¸ª, åé¢é‡å¤çš„å…¨éƒ¨åˆ é™¤ï¼Œkeep='firstâ€™è¡¨ç¤ºä¿ç•™ç¬¬ä¸€æ¬¡å‡ºç°çš„é‡å¤è¡Œï¼Œæ˜¯é»˜è®¤å€¼ã€‚keepå¦å¤–ä¸¤ä¸ªå–å€¼ä¸º\"last\"å’ŒFalseï¼Œåˆ†åˆ«è¡¨ç¤ºä¿ç•™æœ€åä¸€æ¬¡å‡ºç°çš„é‡å¤è¡Œå’Œå»é™¤æ‰€æœ‰é‡å¤è¡Œã€‚ inplace : è¿”å›æ˜¯å¦æ›¿ä»£è¿‡çš„å€¼ï¼Œé»˜è®¤False,å³ä¸æ”¹å˜åŸæ•°æ®ã€‚ data = pd.DataFrame({'A':[1,1,2,2],'B':['a','b','a','b']}) data.drop_duplicates('B','first',inplace=True) data A B 0 1 a 1 1 b duplicated() DataFrame.duplicatedï¼ˆsubset = Noneï¼Œkeep =â€˜firstâ€™ ï¼‰è¿”å›boolean Seriesè¡¨ç¤ºé‡å¤è¡Œ å‚æ•°ï¼š subsetï¼šåˆ—æ ‡ç­¾æˆ–æ ‡ç­¾åºåˆ—ï¼Œå¯é€‰ ä»…è€ƒè™‘ç”¨äºæ ‡è¯†é‡å¤é¡¹çš„æŸäº›åˆ—ï¼Œé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨æ‰€æœ‰åˆ— keepï¼š{â€˜firstâ€™ï¼Œâ€˜lastâ€™ï¼ŒFalse}ï¼Œé»˜è®¤â€™firstâ€™ firstï¼šæ ‡è®°é‡å¤ï¼ŒTrueé™¤äº†ç¬¬ä¸€æ¬¡å‡ºç°ã€‚ lastï¼šæ ‡è®°é‡å¤ï¼ŒTrueé™¤äº†æœ€åä¸€æ¬¡å‡ºç°ã€‚ é”™è¯¯ï¼šå°†æ‰€æœ‰é‡å¤é¡¹æ ‡è®°ä¸ºTrueã€‚ data['B'].duplicated() 0 False 1 False 2 True 3 True Name: B, dtype: bool data[data['A'].duplicated()] A B 2 2 a 3 2 b Update timeï¼š 2020-05-25 "},"Chapter2/Pandas dropå‡½æ•°.html":{"url":"Chapter2/Pandas dropå‡½æ•°.html","title":"Pandas dropå‡½æ•°","keywords":"","body":"Pandas dropå‡½æ•° åˆ é™¤è¡¨ä¸­çš„æŸä¸€è¡Œæˆ–è€…æŸä¸€åˆ—æ›´æ˜æ™ºçš„æ–¹æ³•æ˜¯ä½¿ç”¨dropï¼Œå®ƒä¸æ”¹å˜åŸæœ‰çš„dfä¸­çš„æ•°æ®ï¼Œè€Œæ˜¯è¿”å›å¦ä¸€ä¸ªdataframeæ¥å­˜æ”¾åˆ é™¤åçš„æ•°æ®ã€‚ æ¸…ç†æ— æ•ˆæ•°æ® df[df.isnull()] #è¿”å›çš„æ˜¯ä¸ªtrueæˆ–falseçš„Serieså¯¹è±¡ï¼ˆæ©ç å¯¹è±¡ï¼‰ï¼Œè¿›è€Œç­›é€‰å‡ºæˆ‘ä»¬éœ€è¦çš„ç‰¹å®šæ•°æ®ã€‚ df[df.notnull()] df.dropna() #å°†æ‰€æœ‰å«æœ‰nané¡¹çš„rowåˆ é™¤ df.dropna(axis=1,thresh=3) #å°†åœ¨åˆ—çš„æ–¹å‘ä¸Šä¸‰ä¸ªä¸ºNaNçš„é¡¹åˆ é™¤ df.dropna(how='ALL') #å°†å…¨éƒ¨é¡¹éƒ½æ˜¯nançš„rowåˆ é™¤ dropå‡½æ•°çš„ä½¿ç”¨ åˆ é™¤è¡Œã€åˆ é™¤åˆ— print frame.drop(['a']) print frame.drop(['Ohio'], axis = 1) drop å‡½æ•°é»˜è®¤åˆ é™¤è¡Œï¼Œåˆ—éœ€è¦åŠ axis = 1 inplaceå‚æ•° 1. DF= DF.drop('column_name', axis=1)ï¼› 2. DF.drop('column_name',axis=1, inplace=True) 3. DF.drop([DF.columns[[0,1, 3]]], axis=1, inplace=True) # Note: zero indexed æ³¨æ„ï¼šå‡¡æ˜¯ä¼šå¯¹åŸæ•°ç»„ä½œå‡ºä¿®æ”¹å¹¶è¿”å›ä¸€ä¸ªæ–°æ•°ç»„çš„ï¼Œå¾€å¾€éƒ½æœ‰ä¸€ä¸ª inplaceå¯é€‰å‚æ•°ã€‚å¦‚æœæ‰‹åŠ¨è®¾å®šä¸ºTrueï¼ˆé»˜è®¤ä¸ºFalseï¼‰ï¼Œé‚£ä¹ˆåŸæ•°ç»„ç›´æ¥å°±è¢«æ›¿æ¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé‡‡ç”¨ inplace=True ä¹‹åï¼ŒåŸæ•°ç»„åï¼ˆå¦‚2å’Œ3æƒ…å†µæ‰€ç¤ºï¼‰å¯¹åº”çš„å†…å­˜å€¼ç›´æ¥æ”¹å˜ï¼› è€Œé‡‡ç”¨ inplace=False ä¹‹åï¼ŒåŸæ•°ç»„åå¯¹åº”çš„å†…å­˜å€¼å¹¶ä¸æ”¹å˜ï¼Œéœ€è¦å°†æ–°çš„ç»“æœèµ‹ç»™ä¸€ä¸ªæ–°çš„æ•°ç»„æˆ–è€…è¦†ç›–åŸæ•°ç»„çš„å†…å­˜ä½ç½®ï¼ˆå¦‚1æƒ…å†µæ‰€ç¤ºï¼‰ã€‚ æ•°æ®ç±»å‹è½¬æ¢ df['Name'] = df['Name'].astype(np.datetime64) DataFrame.astype()æ–¹æ³•å¯å¯¹æ•´ä¸ª DataFrame æˆ–æŸä¸€åˆ—è¿›è¡Œæ•°æ®æ ¼å¼è½¬æ¢ï¼Œæ”¯æŒ Python å’Œ NumPy çš„æ•°æ®ç±»å‹ã€‚ Update timeï¼š 2020-05-25 "},"Chapter2/Pandas å”¯ä¸€å€¼ï¼Œè®¡æ•°å€¼.html":{"url":"Chapter2/Pandas å”¯ä¸€å€¼ï¼Œè®¡æ•°å€¼.html","title":"Pandas å”¯ä¸€å€¼ï¼Œè®¡æ•°å€¼","keywords":"","body":"Pandas å”¯ä¸€å€¼ï¼Œè®¡æ•°å€¼ unique() pd.unique(Series) è·å– Series ä¸­å…ƒç´ çš„å”¯ä¸€å€¼ï¼ˆå³å»æ‰é‡å¤çš„ï¼‰ è®¡ç®— Series ä¸­çš„å”¯ä¸€å€¼æ•°ç»„ï¼ŒæŒ‰å‘ç°çš„é¡ºåºè¿”å›ã€‚ obj=pd.Series(['c','a','d','a','a','b','b','c','c','c']) print(obj.unique()) # ['c' 'a' 'd' 'b'] value_counts() pd.value_counts(Series) ç»Ÿè®¡ Series ä¸­ä¸åŒå…ƒç´ å‡ºç°çš„æ¬¡æ•° print(obj.value_counts()) ''' c 4 a 3 b 2 d 1 dtype: int64 ''' isin() In [144]: obj.isin(['a','b']) Out[144]: 0 False 1 True 2 False 3 True 4 True 5 True 6 True 7 False 8 False 9 False dtype: bool pd.cut() pandas.cut(x, bins, right=True, labels=None, retbins=False, precision=3, include_lowest=False ) å‚æ•° x : è¿›è¡Œåˆ’åˆ†çš„ä¸€ç»´æ•°ç»„ bins : bins æ˜¯è¢«åˆ‡å‰²åçš„åŒºé—´ï¼ˆæˆ–è€…å«â€œæ¡¶â€ã€â€œç®±â€ã€â€œé¢å…ƒâ€ï¼‰ï¼Œæœ‰3ä¸­å½¢å¼ï¼šä¸€ä¸ªintå‹çš„æ ‡é‡ã€æ ‡é‡åºåˆ—ï¼ˆæ•°ç»„ï¼‰æˆ–è€…pandas.IntervalIndex ã€‚ ä¸€ä¸ªintå‹çš„æ ‡é‡ å½“binsä¸ºä¸€ä¸ªintå‹çš„æ ‡é‡æ—¶ï¼Œä»£è¡¨å°†xå¹³åˆ†æˆbinsä»½ã€‚xçš„èŒƒå›´åœ¨æ¯ä¾§æ‰©å±•0.1%ï¼Œä»¥åŒ…æ‹¬xçš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚ æ ‡é‡åºåˆ— æ ‡é‡åºåˆ—å®šä¹‰äº†è¢«åˆ†å‰²åæ¯ä¸€ä¸ªbinçš„åŒºé—´è¾¹ç¼˜ï¼Œæ­¤æ—¶xæ²¡æœ‰æ‰©å±•ã€‚ pandas.IntervalIndex å®šä¹‰è¦ä½¿ç”¨çš„ç²¾ç¡®åŒºé—´ ã€‚ right : boolå‹å‚æ•°ï¼Œ é»˜è®¤ä¸ºTrueï¼Œè¡¨ç¤ºæ˜¯å¦åŒ…å«åŒºé—´å³éƒ¨ã€‚æ¯”å¦‚å¦‚æœbins=[1,2,3]ï¼Œright=Trueï¼Œåˆ™åŒºé—´ä¸º(1,2]ï¼Œ(2,3]ï¼›right=Falseï¼Œåˆ™åŒºé—´ä¸º(1,2),(2,3)ã€‚ labelsï¼šç»™åˆ†å‰²åçš„ bins æ‰“æ ‡ç­¾ï¼Œæ¯”å¦‚æŠŠå¹´é¾„ x åˆ†å‰²æˆå¹´é¾„æ®µ bins åï¼Œå¯ä»¥ç»™å¹´é¾„æ®µæ‰“ä¸Šè¯¸å¦‚é’å¹´ã€ä¸­å¹´çš„æ ‡ç­¾ã€‚ labels çš„é•¿åº¦å¿…é¡»å’Œåˆ’åˆ†åçš„åŒºé—´é•¿åº¦ç›¸ç­‰ï¼Œæ¯”å¦‚bins=[1,2,3]ï¼Œåˆ’åˆ†åæœ‰2ä¸ªåŒºé—´(1,2]ï¼Œ(2,3]ï¼Œåˆ™labelsçš„é•¿åº¦å¿…é¡»ä¸º2ã€‚å¦‚æœæŒ‡å®š labels = Falseï¼Œåˆ™è¿”å›xä¸­çš„æ•°æ®åœ¨ç¬¬å‡ ä¸ªbinä¸­ï¼ˆä»0å¼€å§‹ï¼‰ã€‚ retbinsï¼šbool å‹çš„å‚æ•°ï¼Œè¡¨ç¤ºæ˜¯å¦å°†åˆ†å‰²åçš„binsè¿”å›ï¼Œå½“binsä¸ºä¸€ä¸ªintå‹çš„æ ‡é‡æ—¶æ¯”è¾ƒæœ‰ç”¨ï¼Œè¿™æ ·å¯ä»¥å¾—åˆ°åˆ’åˆ†åçš„åŒºé—´ï¼Œé»˜è®¤ä¸ºFalseã€‚ precision: ä¿ç•™åŒºé—´å°æ•°ç‚¹çš„ä½æ•°ï¼Œé»˜è®¤ä¸º3. include_lowest :boolå‹çš„å‚æ•°ï¼Œ è¡¨ç¤ºåŒºé—´çš„å·¦è¾¹æ˜¯å¼€è¿˜æ˜¯é—­çš„ï¼Œé»˜è®¤ä¸ºfalseï¼Œä¹Ÿå°±æ˜¯ä¸åŒ…å«åŒºé—´å·¦éƒ¨ï¼ˆé—­ï¼‰ã€‚ è¿”å› outï¼šä¸€ä¸ªpandas.Categorical, Seriesæˆ–è€…ndarrayç±»å‹çš„å€¼ï¼Œä»£è¡¨åˆ†åŒºåxä¸­çš„æ¯ä¸ªå€¼åœ¨å“ªä¸ªbinï¼ˆåŒºé—´ï¼‰ä¸­ï¼Œå¦‚æœæŒ‡å®šäº†labelsï¼Œåˆ™è¿”å›å¯¹åº”çš„labelã€‚ binsï¼šåˆ†éš”åçš„åŒºé—´ï¼Œå½“æŒ‡å®šretbinsä¸ºTrueæ—¶è¿”å›ã€‚ import numpy as np import pandas as pd # å¹´é¾„æ•°æ® ages = np.array([1,5,10,40,36,12,58,62,77,89,100,18,20,25,30,32]) # å°†ageså¹³åˆ†æˆ5ä¸ªåŒºé—´ pd.cut(ages, 5) [(0.901, 20.8], (0.901, 20.8], (0.901, 20.8], (20.8, 40.6], (20.8, 40.6], ..., (0.901, 20.8], (0.901, 20.8], (20.8, 40.6], (20.8, 40.6], (20.8, 40.6]] Length: 16 Categories (5, interval[float64]): [(0.901, 20.8] å¯ä»¥çœ‹åˆ° ages è¢«å¹³åˆ†æˆ 5 ä¸ªåŒºé—´ï¼Œä¸”åŒºé—´ä¸¤è¾¹éƒ½æœ‰æ‰©å±•ä»¥åŒ…å«æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚ å°† ages å¹³åˆ†æˆ 5 ä¸ªåŒºé—´å¹¶æŒ‡å®š labels ages = np.array([1,5,10,40,36,12,58,62,77,89,100,18,20,25,30,32]) #å¹´é¾„æ•°æ® pd.cut(ages, 5, labels=[u\"å©´å„¿\",u\"é’å¹´\",u\"ä¸­å¹´\",u\"å£®å¹´\",u\"è€å¹´\"]) [å©´å„¿, å©´å„¿, å©´å„¿, é’å¹´, é’å¹´, ..., å©´å„¿, å©´å„¿, é’å¹´, é’å¹´, é’å¹´] Length: 16 Categories (5, object): [å©´å„¿ ç»™agesæŒ‡å®šåŒºé—´è¿›è¡Œåˆ†å‰² ages = np.array([1,5,10,40,36,12,58,62,77,89,100,18,20,25,30,32]) #å¹´é¾„æ•°æ® pd.cut(ages, [0,5,20,30,50,100], labels=[u\"å©´å„¿\",u\"é’å¹´\",u\"ä¸­å¹´\",u\"å£®å¹´\",u\"è€å¹´\"]) [å©´å„¿, å©´å„¿, é’å¹´, å£®å¹´, å£®å¹´, ..., é’å¹´, é’å¹´, ä¸­å¹´, ä¸­å¹´, å£®å¹´] Length: 16 Categories (5, object): [å©´å„¿ è¿™é‡Œä¸å†å¹³åˆ† agesï¼Œè€Œæ˜¯å°† ages åˆ†ä¸ºäº† 5 ä¸ªåŒºé—´ (0, 5],(5, 20],(20, 30],(30,50],(50,100]. è¿”å›åˆ†å‰²åçš„ bins ä»¤labels=Falseå³å¯ ages = np.array([1,5,10,40,36,12,58,62,77,89,100,18,20,25,30,32]) #å¹´é¾„æ•°æ® pd.cut(ages, [0,5,20,30,50,100], labels=False) array([0, 0, 1, 3, 3, 1, 4, 4, 4, 4, 4, 1, 1, 2, 2, 3], dtype=int64) å‚è€ƒ pandas.cut pandas.cutä½¿ç”¨æ€»ç»“ Update timeï¼š 2020-05-25 "},"Chapter2/èšç±» Groupby.html":{"url":"Chapter2/èšç±» Groupby.html","title":"èšç±» Groupby","keywords":"","body":"GroupBy pandasæä¾›äº†ä¸€ä¸ªçµæ´»é«˜æ•ˆçš„groupbyåŠŸèƒ½ï¼Œå®ƒä½¿ä½ èƒ½ä»¥ä¸€ç§è‡ªç„¶çš„æ–¹å¼å¯¹æ•°æ®é›†è¿›è¡Œåˆ‡ç‰‡ã€åˆ‡å—ã€æ‘˜è¦ç­‰æ“ä½œã€‚æ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼ˆå¯ä»¥æ˜¯å‡½æ•°ã€æ•°ç»„æˆ–DataFrameåˆ—åï¼‰æ‹†åˆ†pandaså¯¹è±¡ã€‚è®¡ç®—åˆ†ç»„æ‘˜è¦ç»Ÿè®¡ï¼Œå¦‚è®¡æ•°ã€å¹³å‡å€¼ã€æ ‡å‡†å·®ï¼Œæˆ–ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ã€‚å¯¹DataFrameçš„åˆ—åº”ç”¨å„ç§å„æ ·çš„å‡½æ•°ã€‚åº”ç”¨ç»„å†…è½¬æ¢æˆ–å…¶ä»–è¿ç®—ï¼Œå¦‚è§„æ ¼åŒ–ã€çº¿æ€§å›å½’ã€æ’åæˆ–é€‰å–å­é›†ç­‰ã€‚è®¡ç®—é€è§†è¡¨æˆ–äº¤å‰è¡¨ã€‚æ‰§è¡Œåˆ†ä½æ•°åˆ†æä»¥åŠå…¶ä»–åˆ†ç»„åˆ†æ groupby DataFrame.groupby(by=None, axis=0, level=None, as_index=True, sort=True, group_keys=True, squeeze=False, **kwargs) æ•°æ®åˆ†ç»„ å°†ä¸€ä¸ªdataframeå¯¹è±¡åˆ†å‰²æˆç»„ import pandas as pd df = pd.DataFrame({'A': ['girl', 'boy', 'girl', 'boy', 'girl', 'boy', 'girl', 'girl'], 'B': ['one', 'one', 'two', 'three', 'two', 'two', 'one', 'three'], 'C': [3,1,4,5,6,7,8,1], 'D': [9,1,2,3,1,6,4,3]}) A B C D 0 girl one 3 9 1 boy one 1 1 2 girl two 4 2 3 boy three 5 3 4 girl two 6 1 5 boy two 7 6 6 girl one 8 4 å°†æ•°æ®è¿›è¡Œåˆ†ç»„ï¼š grouped = df.groupby('A') print(grouped) # grouped = df.groupby(['A','B']) print(grouped) # ç¤ºä¾‹ >>> import pandas as pd >>> df = pd.DataFrame({'key1':['a', 'a', 'b', 'b', 'a'], ... 'key2':['one', 'two', 'one', 'two', 'one'], ... 'data1':np.random.randn(5), ... 'data2':np.random.randn(5)}) >>> df data1 data2 key1 key2 0 -0.410673 0.519378 a one 1 -2.120793 0.199074 a two 2 0.642216 -0.143671 b one 3 0.975133 -0.592994 b two 4 -1.017495 -0.530459 a one å‡è®¾ä½ æƒ³è¦æŒ‰ key1 è¿›è¡Œåˆ†ç»„ï¼Œå¹¶è®¡ç®— data1 åˆ—çš„å¹³å‡å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—® data1 ï¼Œå¹¶æ ¹æ® key1è°ƒç”¨ groupbyï¼š >>> grouped = df['data1'].groupby(df['key1']) # grouped = df.groupby(df['key1'])['data1'] åŒæ ·çš„ç»“æœ >>> grouped å˜é‡groupedæ˜¯ä¸€ä¸ªGroupByå¯¹è±¡ï¼Œå®ƒå®é™…ä¸Šè¿˜æ²¡æœ‰è¿›è¡Œä»»ä½•è®¡ç®—ï¼Œåªæ˜¯å«æœ‰ä¸€äº›æœ‰å…³åˆ†ç»„é”® df['key1'] çš„ä¸­é—´æ•°æ®è€Œå·²ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥è°ƒç”¨GroupByçš„meanæ–¹æ³•æ¥è®¡ç®—åˆ†ç»„å¹³å‡å€¼ï¼š >>> grouped.mean() key1 a -1.182987 b 0.808674 dtype: float64 è¯´æ˜ï¼šæ•°æ®ï¼ˆSeriesï¼‰æ ¹æ®åˆ†ç»„é”®è¿›è¡Œäº†èšåˆï¼Œäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„Seriesï¼Œå…¶ç´¢å¼•ä¸º key1 åˆ—ä¸­çš„å”¯ä¸€å€¼ã€‚ä¹‹æ‰€ä»¥ç»“æœä¸­ç´¢å¼•çš„åç§°ä¸ºkey1ï¼Œæ˜¯å› ä¸ºåŸå§‹DataFrameçš„åˆ—df['key1']å°±å«è¿™ä¸ªåå­—ã€‚ å¦‚æœæˆ‘ä»¬ä¸€æ¬¡ä¼ å…¥å¤šä¸ªæ•°ç»„ï¼Œå°±ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœï¼š >>> means = df['data1'].groupby([df['key1'], df['key2']]).mean() >>> means key1 key2 a one -0.714084 two -2.120793 b one 0.642216 two 0.975133 dtype: float64 é€šè¿‡ä¸¤ä¸ªé”®å¯¹æ•°æ®è¿›è¡Œäº†åˆ†ç»„ï¼Œå¾—åˆ°çš„Serieså…·æœ‰ä¸€ä¸ªå±‚æ¬¡åŒ–ç´¢å¼•ï¼ˆç”±å”¯ä¸€çš„é”®å¯¹ç»„æˆï¼‰ >>> means.unstack() key2 one two key1 a -0.714084 -2.120793 b 0.642216 0.975133 æ— è®ºä½ å‡†å¤‡æ‹¿groupbyåšä»€ä¹ˆï¼Œéƒ½æœ‰å¯èƒ½ä¼šç”¨åˆ°GroupByçš„sizeæ–¹æ³•ï¼Œå®ƒå¯ä»¥è¿”å›ä¸€ä¸ªå«æœ‰åˆ†ç»„å¤§å°çš„Seriesï¼š >>> df.groupby(['key1', 'key2']).size() key1 key2 a one 2 two 1 b one 1 two 1 dtype: int64 å±æ€§ groups GroupBy.groups è¿”å›å€¼ç±»å‹ï¼šDict {group name -> group labels} df.groupby('A').groups # {'boy': Int64Index([1, 3, 5], dtype='int64'), # 'girl': Int64Index([0, 2, 4, 6, 7], dtype='int64'#)} å±æ€§ indices GroupBy.indices Dict {group name -> group indices} df.groupby('A').indices # {'boy': array([1, 3, 5], dtype=int64), # 'girl': array([0, 2, 4, 6, 7], dtype=int64)} å‡½æ•° get_group() è·å–åˆ†ç»„åçš„æ•°æ® get_group get_group('key name') grouped = df.groupby('A') print(grouped.get_group('boy')) # A B C D #1 boy one 1 1 #3 boy three 5 3 #5 boy two 7 6 print(grouped.get_group('girl')) # A B C D #0 girl one 3 9 #2 girl two 4 2 #4 girl two 6 1 #6 girl one 8 4 #7 girl three 1 3 è¿­ä»£éå†åˆ†ç»„ GroupByå¯¹è±¡æ”¯æŒè¿­ä»£ï¼Œå¯ä»¥äº§ç”Ÿä¸€ç»„äºŒå…ƒå…ƒç»„ï¼ˆç”±åˆ†ç»„åå’Œæ•°æ®å—ç»„æˆï¼‰ import pandas as pd ipl_data = {'Team': ['Riders', 'Riders', 'Devils', 'Devils', 'Kings', 'kings', 'Kings', 'Kings', 'Riders', 'Royals', 'Royals', 'Riders'], 'Rank': [1, 2, 2, 3, 3,4 ,1 ,1,2 , 4,1,2], 'Year': [2014,2015,2014,2015,2014,2015,2016,2017,2016,2014,2015,2017], 'Points':[876,789,863,673,741,812,756,788,694,701,804,690]} df = pd.DataFrame(ipl_data) grouped = df.groupby('Year') for name,group in grouped: print (name) print (group) 2014 Team Rank Year Points 0 Riders 1 2014 876 2 Devils 2 2014 863 4 Kings 3 2014 741 9 Royals 4 2014 701 2015 Team Rank Year Points 1 Riders 2 2015 789 3 Devils 3 2015 673 5 kings 4 2015 812 10 Royals 1 2015 804 2016 Team Rank Year Points 6 Kings 1 2016 756 8 Riders 2 2016 694 2017 Team Rank Year Points 7 Kings 1 2017 788 11 Riders 2 2017 690 é€‰æ‹©ä¸€ä¸ªåˆ†ç»„ ä½¿ç”¨get_group()æ–¹æ³•ï¼Œå¯ä»¥é€‰æ‹©ä¸€ä¸ªç»„ã€‚ ipl_data = {'Team': ['Riders', 'Riders', 'Devils', 'Devils', 'Kings', 'kings', 'Kings', 'Kings', 'Riders', 'Royals', 'Royals', 'Riders'], 'Rank': [1, 2, 2, 3, 3,4 ,1 ,1,2 , 4,1,2], 'Year': [2014,2015,2014,2015,2014,2015,2016,2017,2016,2014,2015,2017], 'Points':[876,789,863,673,741,812,756,788,694,701,804,690]} df = pd.DataFrame(ipl_data) grouped = df.groupby('Year') grouped.groups #{2014: Int64Index([0, 2, 4, 9], dtype='int64'), # 2015: Int64Index([1, 3, 5, 10], dtype='int64'), # 2016: Int64Index([6, 8], dtype='int64'), # 2017: Int64Index([7, 11], dtype='int64')} grouped.get_group(2014) # Team Rank Year Points #0 Riders 1 2014 876 #2 Devils 2 2014 863 #4 Kings 3 2014 741 #9 Royals 4 2014 701 Function application èšåˆå‡½æ•°ä¸ºæ¯ä¸ªç»„è¿”å›å•ä¸ªèšåˆå€¼ã€‚å½“åˆ›å»ºäº†åˆ†ç»„(group by)å¯¹è±¡ï¼Œå°±å¯ä»¥å¯¹åˆ†ç»„æ•°æ®æ‰§è¡Œå¤šä¸ªèšåˆæ“ä½œã€‚ GroupBy.apply() å¯¹äºapply()æ–¹æ³•æ¥è¯´ï¼Œå®ƒåšäº†è¿™ä¹ˆä¸€ä¸ªæ“ä½œ å°†groupbyåˆ†ç»„å¥½çš„æ•°æ®ï¼Œä¸€ç»„ï¼Œä¸€ç»„ï¼Œä¸€ç»„çš„ä¼ é€’åˆ°äº†å‡½æ•°é‡Œé¢ã€‚ df = pd.DataFrame({'A':['bob','sos','bob','sos','bob','sos','bob','bob'], 'B':['one','one','two','three','two','two','one','three'], 'C':[3,1,4,1,5,9,2,6], 'D':[1,2,3,4,5,6,7,8]}) A B C D 0 bob one 3 1 1 sos one 1 2 2 bob two 4 3 3 sos three 1 4 4 bob two 5 5 5 sos two 9 6 6 bob one 2 7 7 bob three 6 8 grouped = df.groupby('A') for name,group in grouped: print(name) print(group) bob A B C D 0 bob one 3 1 2 bob two 4 3 4 bob two 5 5 6 bob one 2 7 7 bob three 6 8 sos A B C D 1 sos one 1 2 3 sos three 1 4 5 sos two 9 6 ç„¶åå¯¹ç»“æœåº”ç”¨applyæ–¹æ³• d = grouped.apply(lambda x:x.describe()) print(d) # è¾“å‡ºç»“æœ C D A bob count 5.000000 5.000000 mean 4.000000 4.800000 std 1.581139 2.863564 min 2.000000 1.000000 25% 3.000000 3.000000 50% 4.000000 5.000000 75% 5.000000 7.000000 max 6.000000 8.000000 sos count 3.000000 3.000000 mean 3.666667 4.000000 std 4.618802 2.000000 min 1.000000 2.000000 25% 1.000000 3.000000 50% 1.000000 4.000000 75% 5.000000 5.000000 max 9.000000 6.000000 çœ‹å¥½æ˜¯ä¸€ç»„ï¼Œä¸€ç»„çš„ä¼ é€’è¿›å», æ‰€ä»¥ï¼Œå‘ˆç°å‡ºä¸€ç§å¤šå±‚çº§çš„ç»“æ„ è·å–åˆ†ç»„ä¹‹åçš„å‰2æ¡æ•°æ® import pandas as pd df = pd.DataFrame({'A':['bob','sos','bob','sos','bob','sos','bob','bob'], 'B':['one','one','two','three','two','two','one','three'], 'C':[3,1,4,1,5,9,2,6], 'D':[1,2,3,4,5,6,7,8]}) grouped = df.groupby('A') d = grouped.apply(lambda x:x.head(2)) print(d) # A B C D #A #bob 0 bob one 3 1 # 2 bob two 4 3 #sos 1 sos one 1 2 # 3 sos three 1 4 ä¸ç”¨lambdaï¼Œå®ç°ä¸€ä¸‹ def get_top(df): return df.head(2) d = grouped.apply(get_top) print(d) # A B C D #A #bob 0 bob one 3 1 # 2 bob two 4 3 #sos 1 sos one 1 2 # 3 sos three 1 4 å°†åˆ†ç»„åçš„æ•°æ®åœ¨è¿›è¡Œèšåˆå‡½æ•°çš„æ—¶å€™ï¼Œå¾—åˆ°çš„ç»“æœå¯ä»¥ç”¨ index å’Œ value å±æ€§è¿›è¡Œè®¿é—®èšåˆçš„ç»“æœï¼Œä½†ç»“æœä¸æ˜¯ Dataframe ç±»å‹çš„æ•°æ®ï¼Œèšåˆç»“æœçš„åˆ—æ²¡æœ‰åˆ—åï¼Œ data[data['city'] == c].groupby( 'bin')['aver_price'].mean() ç»“æœ bin (0, 100] 111.885075 (100, 200] 121.225610 (200, 300] 107.873333 (300, 400] 113.877059 (400, 500] 114.099038 (500, 600] 107.006912 (600, 700] 121.664796 (700, 800] 108.501117 (800, 900] 113.650955 (900, 1000] 94.152482 (1000, 1100] 102.882639 (1100, 1200] 96.952336 Name: aver_price, dtype: float64 GroupBy.agg() ç›¸æ¯”äºapply()å‡½æ•° agg()æ¯æ¬¡åªä¼ å…¥ä¸€åˆ—æ•°æ®ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ“ä½œï¼Œä¹Ÿå¯ä»¥ä¼ å…¥è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œå’Œapplyçš„ç”¨æ³•ç±»ä¼¼ã€‚ GroupBy.agg(self, func, *args, **kwargs) # å‚æ•° # fun:æ•°æ®èšåˆçš„æ–¹æ³• df.groupby('A').agg(lambda x:print(x)) # è¾“å‡ºç»“æœ 0 one 2 two 4 two 6 one 7 three Name: B, dtype: object 1 one 3 three 5 two Name: B, dtype: object 0 3 2 4 4 5 6 2 7 6 Name: C, dtype: int64 1 1 3 1 5 9 Name: C, dtype: int64 0 1 2 3 4 5 6 7 7 8 Name: D, dtype: int64 1 2 3 4 5 6 Name: D, dtype: int64 å¸¸ç”¨çš„èšåˆæ–¹æ³• å‡½æ•°å è¯´æ˜ count åˆ†ç»„ä¸­é NA å€¼çš„æ•°é‡ sum é NA å€¼çš„å’Œ mean é NA å€¼çš„å¹³å‡å€¼ median é NA å€¼çš„ç®—æœ¯ä¸­ä½æ•° std ã€var æ— åï¼ˆåˆ†æ¯ä¸º n-1ï¼‰æ ‡å‡†å·®å’Œæ–¹å·® minã€max é NA å€¼çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ prod é NA å€¼çš„ç§¯ first ã€last ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªé NA å€¼ æˆ–è€…ä½¿ç”¨ numpy ä¸­çš„èšåˆå‡½æ•°ï¼› ipl_data = {'Team': ['Riders', 'Riders', 'Devils', 'Devils', 'Kings', 'kings', 'Kings', 'Kings', 'Riders', 'Royals', 'Royals', 'Riders'], 'Rank': [1, 2, 2, 3, 3,4 ,1 ,1,2 , 4,1,2], 'Year': [2014,2015,2014,2015,2014,2015,2016,2017,2016,2014,2015,2017], 'Points':[876,789,863,673,741,812,756,788,694,701,804,690]} df = pd.DataFrame(ipl_data) Team Rank Year Points 0 Riders 1 2014 876 1 Riders 2 2015 789 2 Devils 2 2014 863 3 Devils 3 2015 673 4 Kings 3 2014 741 5 kings 4 2015 812 6 Kings 1 2016 756 7 Kings 1 2017 788 8 Riders 2 2016 694 9 Royals 4 2014 701 10 Royals 1 2015 804 11 Riders 2 2017 690 grouped = df.groupby('Year') grouped['Points'].agg(np.mean) # Year # 2014 795.25 # 2015 769.50 # 2016 725.00 # 2017 739.00 # Name: Points, dtype: float64 size()å‡½æ•° grouped = df.groupby('Team') grouped.agg(np.size) # è¾“å‡ºç»“æœ Rank Year Points Team Devils 2 2 2 Kings 3 3 3 Riders 4 4 4 Royals 2 2 2 kings 1 1 1 åº”ç”¨å¤šä¸ªèšåˆå‡½æ•° grouped = df.groupby('Team') grouped['Points'].agg([np.sum, np.mean, np.std]) # è¾“å‡ºç»“æœ sum mean std Team Devils 1536 768.000000 134.350288 Kings 2285 761.666667 24.006943 Riders 3049 762.250000 88.567771 Royals 1505 752.500000 72.831998 kings 812 812.000000 NaN æ±‚å¤šç§èšåˆè¿ç®—çš„åŒæ—¶æ›´æ”¹åˆ—å grouped['Points'].agg([('æ±‚å’Œ',np.sum), ('å‡å€¼',np.mean), ('æ ‡å‡†å·®',np.std)]) # è¾“å‡ºç»“æœ æ±‚å’Œ å‡å€¼ æ ‡å‡†å·® Team Devils 1536 768.000000 134.350288 Kings 2285 761.666667 24.006943 Riders 3049 762.250000 88.567771 Royals 1505 752.500000 72.831998 kings 812 812.000000 NaN ä¸åŒçš„åˆ—è¿ç”¨ä¸åŒçš„èšåˆå‡½æ•° df = pd.DataFrame({'A':['bar', 'bar', 'foo', 'foo', 'foo', 'foo', 'foo'], 'B':['one', 'two', 'one', 'two', 'one', 'two', 'three'], 'C':[3,1,4,5,9,2,6], 'D':[1,1,1,1,2,2,3]}) # è¾“å‡ºç»“æœ A B C D 0 bar one 3 1 1 bar two 1 1 2 foo one 4 1 3 foo two 5 1 4 foo one 9 2 5 foo two 2 2 6 foo three 6 3 grouped = df.groupby(['A','B']) grouped.agg({'C':['sum','mean'],'D':['min','max']}) # è¾“å‡ºç»“æœ C D sum mean min max A B bar one 3 3.0 1 1 two 1 1.0 1 1 foo one 13 6.5 1 2 three 6 6.0 3 3 two 7 3.5 1 2 aggé‡Œé¢æ˜¯å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„èšåˆå‡½æ•° grouped = df.groupby('A') def max_min(group): return group.max() - group.min() grouped.agg(max_min) # C D #A #bar 2 0 #foo 7 2 è¿‡æ»¤ GroupBy.filter() è¿‡æ»¤æ ¹æ®å®šä¹‰çš„æ ‡å‡†è¿‡æ»¤æ•°æ®å¹¶è¿”å›æ•°æ®çš„å­é›†ã€‚filter()å‡½æ•°ç”¨äºè¿‡æ»¤æ•°æ®ã€‚ è¿”å›ä¸‰æ¬¡ä»¥ä¸Šå‚åŠ IPLçš„é˜Ÿä¼ã€‚ df.groupby('Team').filter(lambda x: len(x) >= 3) # è¾“å‡ºç»“æœ Team Rank Year Points 0 Riders 1 2014 876 1 Riders 2 2015 789 4 Kings 3 2014 741 6 Kings 1 2016 756 7 Kings 1 2017 788 8 Riders 2 2016 694 11 Riders 2 2017 690 æ¡ˆä¾‹ å®ä¾‹ 1 å°†åˆ†ç»„åçš„å­—ç¬¦æ‹¼æ¥ import pandas as pd df=pd.DataFrame({ 'user_id':[1,2,1,3,3], 'content_id':[1,1,2,2,2], 'tag':['cool','nice','clever','clever','not-bad'] }) df å°†dfæŒ‰content_idåˆ†ç»„ï¼Œç„¶åå°†æ¯ç»„çš„tagç”¨é€—å·æ‹¼æ¥ df.groupby('content_id')['tag'].apply(lambda x:','.join(x)).to_frame() ä¸»è¦æ˜¯å› ä¸º for group_name,group_values in df.groupby('content_id')['tag']: print(group_name) print(group_values.values,'\\n') å‚è€ƒ æ¢¦æƒ³æ©¡çš®æª«ï¼šå­¦ä¹ pandas applyæ–¹æ³• æ¢¦æƒ³æ©¡çš®æª«ï¼šagg() Pandasä¹‹groupby( )ç”¨æ³•ç¬”è®° æ˜“ç™¾æ•™ç¨‹ python/pandasæ•°æ®æŒ–æ˜ï¼ˆåå››ï¼‰-groupby,èšåˆï¼Œåˆ†ç»„çº§è¿ç®— Pandas GroupBy ä½¿ç”¨æ•™ç¨‹ Update timeï¼š 2020-05-25 "},"Chapter2/Pandas value_countså‡½æ•°.html":{"url":"Chapter2/Pandas value_countså‡½æ•°.html","title":"Pandas value_counts()å‡½æ•°","keywords":"","body":"Pandas value_counts()å‡½æ•° Series.value_counts(normalize=False, sort=True, ascending=False, bins=None, dropna=True) è¿”å›ä¸€ä¸ªåŒ…å«å”¯ä¸€å€¼è®¡æ•°çš„ç³»åˆ—ã€‚ pandas çš„ value_counts()å‡½æ•°å¯ä»¥å¯¹Seriesé‡Œé¢çš„æ¯ä¸ªå€¼è¿›è¡Œè®¡æ•°å¹¶ä¸”æ’åºã€‚ Series æƒ…å†µï¼š In [1]: import pandas as pd^M ...: df = pd.DataFrame({'åŒºåŸŸ' : ['è¥¿å®‰', 'å¤ªåŸ', 'è¥¿å®‰', 'å¤ªåŸ', 'éƒ‘å·', 'å¤ªåŸ'], ^M ...: '10æœˆä»½é”€å”®' : ['0.477468', '0.195046', '0.015964', '0.259654', '0.856412', '0.259644'],^M ...: '9æœˆä»½é”€å”®' : ['0.347705', '0.151220', '0.895599', '0236547', '0.569841', '0.254784']}) In [2]: df Out[2]: åŒºåŸŸ 10æœˆä»½é”€å”® 9æœˆä»½é”€å”® 0 è¥¿å®‰ 0.477468 0.347705 1 å¤ªåŸ 0.195046 0.151220 2 è¥¿å®‰ 0.015964 0.895599 3 å¤ªåŸ 0.259654 0236547 4 éƒ‘å· 0.856412 0.569841 5 å¤ªåŸ 0.259644 0.254784 # ç»Ÿè®¡æ¯ä¸ªåŒºåŸŸå‡ºç°å¤šå°‘æ¬¡ï¼š In [3]: df['åŒºåŸŸ'].value_counts() Out[3]: å¤ªåŸ 3 è¥¿å®‰ 2 éƒ‘å· 1 Name: åŒºåŸŸ, dtype: int64 # æ¯ä¸ªåŒºåŸŸéƒ½è¢«è®¡æ•°ï¼Œå¹¶ä¸”é»˜è®¤ä»é«˜åˆ°ä½æ’åºã€‚ # å¦‚æœæƒ³å‡åºæ’åˆ—ï¼Œè®¾ç½®å‚æ•° ascending = Trueï¼š In [4]: df['åŒºåŸŸ'].value_counts(ascending=True) Out[4]: éƒ‘å· 1 è¥¿å®‰ 2 å¤ªåŸ 3 Name: åŒºåŸŸ, dtype: int64 # å¦‚æœæƒ³å¾—å‡ºè®¡æ•°å æ¯”ï¼Œå¯ä»¥åŠ å‚æ•° normalize=Trueï¼š In [5]: df['åŒºåŸŸ'].value_counts(normalize=True) Out[5]: å¤ªåŸ 0.500000 è¥¿å®‰ 0.333333 éƒ‘å· 0.166667 Name: åŒºåŸŸ, dtype: float64 DataFrame æƒ…å†µ In [6]: df = pd.DataFrame({'åŒºåŸŸ1' : ['è¥¿å®‰', 'å¤ªåŸ', 'è¥¿å®‰', 'å¤ªåŸ', 'éƒ‘å·', 'å¤ªåŸ'],^M ...: 'åŒºåŸŸ2' : ['å¤ªåŸ', 'å¤ªåŸ', 'è¥¿å®‰', 'è¥¿å®‰', 'è¥¿å®‰', 'å¤ªåŸ']}) In [7]: df.apply(pd.value_counts) Out[7]: åŒºåŸŸ1 åŒºåŸŸ2 å¤ªåŸ 3 3.0 è¥¿å®‰ 2 3.0 éƒ‘å· 1 NaN # åŒºåŸŸ2ä¸­æ²¡æœ‰éƒ‘å·ï¼Œæ‰€ä»¥æ˜¯NaNã€‚ å±æ€§ index In [1]: import pandas as pd^M ...: df = pd.DataFrame({'åŒºåŸŸ' : ['è¥¿å®‰', 'å¤ªåŸ', 'è¥¿å®‰', 'å¤ªåŸ', 'éƒ‘å·', 'å¤ªåŸ'], ^M ...: '10æœˆä»½é”€å”®' : ['0.477468', '0.195046', '0.015964', '0.259654', '0.856412', '0.259644'],^M ...: '9æœˆä»½é”€å”®' : ['0.347705', '0.151220', '0.895599', '0236547', '0.569841', '0.254784']}) In [2]: df Out[2]: åŒºåŸŸ 10æœˆä»½é”€å”® 9æœˆä»½é”€å”® 0 è¥¿å®‰ 0.477468 0.347705 1 å¤ªåŸ 0.195046 0.151220 2 è¥¿å®‰ 0.015964 0.895599 3 å¤ªåŸ 0.259654 0236547 4 éƒ‘å· 0.856412 0.569841 5 å¤ªåŸ 0.259644 0.254784 In [3]: df['åŒºåŸŸ'].value_counts() Out[3]: å¤ªåŸ 3 è¥¿å®‰ 2 éƒ‘å· 1 Name: åŒºåŸŸ, dtype: int64 In [4]: df['åŒºåŸŸ'].value_counts().index Out[4]: Index(['å¤ªåŸ', 'è¥¿å®‰', 'éƒ‘å·'], dtype='object') å±æ€§ values In [5]: df['åŒºåŸŸ'].value_counts().values Out[5]: array([3, 2, 1], dtype=int64) å‚è€ƒ pandasè®¡æ•° value_counts() Update timeï¼š 2020-05-25 "},"Chapter2/Pandas sort_valueså‡½æ•°.html":{"url":"Chapter2/Pandas sort_valueså‡½æ•°.html","title":"Pandas sort_values()å‡½æ•°","keywords":"","body":"Pandas sort_values()å‡½æ•° pandasä¸­çš„sort_values()å‡½æ•°åŸç†ç±»ä¼¼äºSQLä¸­çš„order byï¼Œå¯ä»¥å°†æ•°æ®é›†ä¾ç…§æŸä¸ªå­—æ®µä¸­çš„æ•°æ®è¿›è¡Œæ’åºï¼Œè¯¥å‡½æ•°å³å¯æ ¹æ®æŒ‡å®šåˆ—æ•°æ®ä¹Ÿå¯æ ¹æ®æŒ‡å®šè¡Œçš„æ•°æ®æ’åºã€‚ sort_values()å‡½æ•°çš„å…·ä½“å‚æ•° DataFrame.sort_values(by=â€˜##â€™, axis=0, ascending=True, inplace=False, na_position=â€˜lastâ€™) å‚æ•° by æŒ‡å®šåˆ—å(axis=0æˆ–â€™indexâ€™)æˆ–ç´¢å¼•å€¼(axis=1æˆ–â€™columnsâ€™) axis è‹¥axis=0æˆ–â€™indexâ€™ï¼Œåˆ™æŒ‰ç…§æŒ‡å®šåˆ—ä¸­æ•°æ®å¤§å°æ’åºï¼›è‹¥axis=1æˆ–â€™columnsâ€™ï¼Œåˆ™æŒ‰ç…§æŒ‡å®šç´¢å¼•ä¸­æ•°æ®å¤§å°æ’åºï¼Œé»˜è®¤axis=0 ascending æ˜¯å¦æŒ‰æŒ‡å®šåˆ—çš„æ•°ç»„å‡åºæ’åˆ—ï¼Œé»˜è®¤ä¸ºTrueï¼Œå³å‡åºæ’åˆ— inplace æ˜¯å¦ç”¨æ’åºåçš„æ•°æ®é›†æ›¿æ¢åŸæ¥çš„æ•°æ®ï¼Œé»˜è®¤ä¸ºFalseï¼Œå³ä¸æ›¿æ¢ na_position {â€˜firstâ€™,â€˜lastâ€™}ï¼Œè®¾å®šç¼ºå¤±å€¼çš„æ˜¾ç¤ºä½ç½® sort_valuesç”¨æ³•ä¸¾ä¾‹ åˆ›å»ºæ•°æ®æ¡† #åˆ©ç”¨å­—å…¸dictåˆ›å»ºæ•°æ®æ¡† import numpy as np import pandas as pd df=pd.DataFrame({'col1':['A','A','B',np.nan,'D','C'], 'col2':[2,1,9,8,7,7], 'col3':[0,1,9,4,2,8] }) print(df) >>> col1 col2 col3 0 A 2 0 1 A 1 1 2 B 9 9 3 NaN 8 4 4 D 7 2 5 C 7 8 ä¾æ®ç¬¬ä¸€åˆ—æ’åºï¼Œå¹¶å°†è¯¥åˆ—ç©ºå€¼æ”¾åœ¨é¦–ä½ #ä¾æ®ç¬¬ä¸€åˆ—æ’åºï¼Œå¹¶å°†è¯¥åˆ—ç©ºå€¼æ”¾åœ¨é¦–ä½ print(df.sort_values(by=['col1'],na_position='first')) >>> col1 col2 col3 3 NaN 8 4 0 A 2 0 1 A 1 1 2 B 9 9 5 C 7 8 4 D 7 2 ä¾æ®ç¬¬äºŒã€ä¸‰åˆ—ï¼Œæ•°å€¼é™åºæ’åº #ä¾æ®ç¬¬äºŒã€ä¸‰åˆ—ï¼Œæ•°å€¼é™åºæ’åº print(df.sort_values(by=['col2','col3'],ascending=False)) >>> col1 col2 col3 2 B 9 9 3 NaN 8 4 5 C 7 8 4 D 7 2 0 A 2 0 1 A 1 1 æ ¹æ®ç¬¬ä¸€åˆ—ä¸­æ•°å€¼æ’åºï¼ŒæŒ‰é™åºæ’åˆ—ï¼Œå¹¶æ›¿æ¢åŸæ•°æ® #æ ¹æ®ç¬¬ä¸€åˆ—ä¸­æ•°å€¼æ’åºï¼ŒæŒ‰é™åºæ’åˆ—ï¼Œå¹¶æ›¿æ¢åŸæ•°æ® df.sort_values(by=['col1'],ascending=False,inplace=True, na_position='first') print(df) >>> col1 col2 col3 3 NaN 8 4 4 D 7 2 5 C 7 8 2 B 9 9 1 A 1 1 0 A 2 0 æŒ‰ç…§ç´¢å¼•å€¼ä¸º0çš„è¡Œï¼Œå³ç¬¬ä¸€è¡Œçš„å€¼æ¥é™åºæ’åº x = pd.DataFrame({'x1':[1,2,2,3],'x2':[4,3,2,1],'x3':[3,2,4,1]}) print(x) #æŒ‰ç…§ç´¢å¼•å€¼ä¸º0çš„è¡Œï¼Œå³ç¬¬ä¸€è¡Œçš„å€¼æ¥é™åºæ’åº print(x.sort_values(by =0,ascending=False,axis=1)) >>> x1 x2 x3 0 1 4 3 1 2 3 2 2 2 2 4 3 3 1 1 x2 x3 x1 0 4 3 1 1 3 2 2 2 2 4 2 3 1 1 3 sort_indexï¼ˆï¼‰ Series çš„ sort_index(ascending=True)æ–¹æ³•å¯ä»¥å¯¹ index è¿›è¡Œæ’åºæ“ä½œï¼Œascending å‚æ•°ç”¨äºæ§åˆ¶å‡åºæˆ–é™åºï¼Œé»˜è®¤ä¸ºå‡åºã€‚ å’Œ sort_values() çš„ç”¨æ³•ç›¸åŒã€‚ Update timeï¼š 2020-05-25 "},"Chapter2/Pandas Applyå‡½æ•°.html":{"url":"Chapter2/Pandas Applyå‡½æ•°.html","title":"Pandas Applyå‡½æ•°","keywords":"","body":"Pandas Applyå‡½æ•° pandas çš„ apply() å‡½æ•°å¯ä»¥ä½œç”¨äº Series æˆ–è€…æ•´ä¸ª DataFrameï¼ŒåŠŸèƒ½ä¹Ÿæ˜¯è‡ªåŠ¨éå†æ•´ä¸ª Series æˆ–è€… DataFrame, å¯¹æ¯ä¸€ä¸ªå…ƒç´ è¿è¡ŒæŒ‡å®šçš„å‡½æ•°ã€‚ DataFrame.apply(func, axis=0, broadcast=False, raw=False, reduce=None, args=(), **kwds ) è¯¥å‡½æ•°æœ€æœ‰ç”¨çš„æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯å‡½æ•°ï¼Œç›¸å½“äºC/C++çš„å‡½æ•°æŒ‡é’ˆã€‚ func : functionä½œç”¨äºæ¯ä¸€åˆ—æˆ–è¡Œã€‚ axis : {0 æˆ– â€˜indexâ€™, 1 æˆ– â€˜columnsâ€™}, é»˜è®¤ 0 å‡½æ•°æ‰€åº”ç”¨çš„è½´: 0 æˆ– â€˜indexâ€™: å¯¹æ¯ä¸€åˆ—åº”ç”¨å‡½æ•°ã€‚ 1 æˆ– â€˜columnsâ€™: å¯¹æ¯ä¸€è¡Œåº”ç”¨å‡½æ•°ã€‚ broadcast : bool, å¯é€‰ ä»…ä¸èšåˆå‡½æ•°ç›¸å…³: False æˆ– None : è¿”å›ä¸€ä¸ªSeriesï¼Œè¯¥Seriesçš„é•¿åº¦æ˜¯ç´¢å¼•çš„é•¿åº¦æˆ–åˆ—çš„æ•°é‡(åŸºäºaxiså‚æ•°) True : ç»“æœå°†å¹¿æ’­åˆ°æ¡†æ¶çš„åŸå§‹å½¢çŠ¶ï¼ŒåŸå§‹ç´¢å¼•å’Œåˆ—å°†ä¿ç•™ã€‚ ä»0.23.0ç‰ˆæœ¬å¼€å§‹å°±ä¸æ¨èä½¿ç”¨:è¿™ä¸ªå‚æ•°å°†åœ¨å°†æ¥çš„ç‰ˆæœ¬ä¸­è¢«åˆ é™¤ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯result_type= ' broadcast 'ã€‚ raw : bool, é»˜è®¤ False False : å°†æ¯ä¸€è¡Œæˆ–æ¯ä¸€åˆ—ä½œä¸ºä¸€ä¸ªSeriesä¼ é€’ç»™å‡½æ•°ã€‚ True : tä¼ é€’çš„å‡½æ•°å°†æ¥æ”¶ndarrayå¯¹è±¡ã€‚å¦‚æœæ‚¨åªæ˜¯åº”ç”¨ä¸€ä¸ªNumPyçº¦ç®€å‡½æ•°ï¼Œè¿™å°†è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚ reduce : boolæˆ– None, é»˜è®¤ None è¯•ç€ä½¿ç”¨å‡é‡ç¨‹åºã€‚å¦‚æœDataFrameä¸ºç©ºï¼Œapplyå°†ä½¿ç”¨reductoç¡®å®šç»“æœåº”è¯¥æ˜¯ä¸€ä¸ªSeriesè¿˜æ˜¯ä¸€ä¸ªDataFrameã€‚å¦‚æœreduce=None(ç¼ºçœå€¼)ï¼Œapplyçš„è¿”å›å€¼å°†é€šè¿‡åœ¨ç©ºåºåˆ—ä¸Šè°ƒç”¨funcæ¥çŒœæµ‹(æ³¨æ„:åœ¨çŒœæµ‹æ—¶ï¼Œfuncå¼•å‘çš„å¼‚å¸¸å°†è¢«å¿½ç•¥)ã€‚å¦‚æœreduce=Trueï¼Œåˆ™å§‹ç»ˆè¿”å›ä¸€ä¸ªSeriesï¼Œå¦‚æœreduce=Falseï¼Œåˆ™å§‹ç»ˆè¿”å›ä¸€ä¸ªDataFrameã€‚ ä»0.23.0ç‰ˆæœ¬å¼€å§‹å°±ä¸æ¨èä½¿ç”¨:è¿™ä¸ªå‚æ•°å°†åœ¨å°†æ¥çš„ç‰ˆæœ¬ä¸­è¢«åˆ é™¤ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯result_type='reduce'ã€‚ result_type : {â€˜expandâ€™, â€˜reduceâ€™, â€˜broadcastâ€™, None}, é»˜è®¤ None è¿™äº›åªåœ¨axis=1(åˆ—)æ—¶èµ·ä½œç”¨: â€˜expandâ€™ : ç±»ä¼¼åˆ—è¡¨çš„ç»“æœå°†è½¬æ¢ä¸ºåˆ—ã€‚ â€˜reduceâ€™ : å¦‚æœå¯èƒ½ï¼Œè¿”å›ä¸€ä¸ªSeriesï¼Œè€Œä¸æ˜¯å±•å¼€ç±»ä¼¼åˆ—è¡¨çš„ç»“æœã€‚è¿™æ˜¯â€˜expandâ€™çš„åä¹‰è¯ã€‚ â€˜broadcastâ€™ : ç»“æœå°†å¹¿æ’­åˆ°DataFrameçš„åŸå§‹å½¢çŠ¶ï¼Œä¿ç•™åŸå§‹ç´¢å¼•å’Œåˆ—ã€‚ é»˜è®¤è¡Œä¸º(None)å–å†³äºåº”ç”¨å‡½æ•°çš„è¿”å›å€¼:ç±»ä¼¼åˆ—è¡¨çš„ç»“æœå°†ä½œä¸ºè¿™äº›ç»“æœçš„Seriesè¿”å›ã€‚ä½†æ˜¯ï¼Œå¦‚æœapplyå‡½æ•°è¿”å›ä¸€ä¸ªSeriesï¼Œè¿™äº›åˆ—å°±ä¼šå±•å¼€ä¸ºåˆ—ã€‚ args : tuple é™¤äº†array/serieså¤–ï¼Œè¿˜è¦ä¼ é€’ç»™funcçš„ä½ç½®å‚æ•°ã€‚ \\kwds è¦ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ é€’ç»™funcçš„å…¶ä»–å…³é”®å­—å‚æ•°ã€‚ è¿™ä¸ªå‡½æ•°éœ€è¦è‡ªå·±å®ç°ï¼Œå‡½æ•°çš„ä¼ å…¥å‚æ•°æ ¹æ®axisæ¥å®šï¼Œæ¯”å¦‚ axis = 1ï¼Œå°±ä¼šæŠŠä¸€è¡Œæ•°æ®ä½œä¸ºSeriesçš„æ•°æ®ç»“æ„ä¼ å…¥ç»™è‡ªå·±å®ç°çš„å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åœ¨å‡½æ•°ä¸­å®ç°å¯¹Seriesä¸åŒå±æ€§ä¹‹é—´çš„è®¡ç®—ï¼Œè¿”å›ä¸€ä¸ªç»“æœï¼Œåˆ™apply å‡½æ•°ä¼šè‡ªåŠ¨éå†æ¯ä¸€è¡Œ DataFrame çš„æ•°æ®ï¼Œæœ€åå°†æ‰€æœ‰ç»“æœç»„åˆæˆä¸€ä¸ªSeriesæ•°æ®ç»“æ„å¹¶è¿”å›ã€‚ Series.apply() ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œç°åœ¨æœ‰è¿™æ ·ä¸€ç»„æ•°æ®ï¼Œå­¦ç”Ÿçš„è€ƒè¯•æˆç»©ï¼š Name Nationality Score å¼  æ±‰ 400 æ å› 450 ç‹ æ±‰ 460 å¦‚æœæ°‘æ—ä¸æ˜¯æ±‰æ—ï¼Œåˆ™æ€»åˆ†åœ¨è€ƒè¯•åˆ†æ•°ä¸Šå†åŠ  5 åˆ†ï¼Œç°åœ¨éœ€è¦ç”¨ pandas æ¥åšè¿™ç§è®¡ç®—ï¼Œæˆ‘ä»¬åœ¨ Dataframe ä¸­å¢åŠ ä¸€åˆ—ã€‚å½“ç„¶å¦‚æœåªæ˜¯ä¸ºäº†å¾—åˆ°ç»“æœï¼Œ numpy.where() å‡½æ•°æ›´ç®€å•ï¼Œè¿™é‡Œä¸»è¦ä¸ºäº†æ¼”ç¤º Series.apply() å‡½æ•°çš„ç”¨æ³•ã€‚ import pandas as pd df = pd.read_csv(\"studuent-score.csv\") df['ExtraScore'] = df['Nationality'].apply(lambda x : 5 if x != 'æ±‰' else 0) df['TotalScore'] = df['Score'] + df['ExtraScore'] apply() å‡½æ•°å½“ç„¶ä¹Ÿå¯æ‰§è¡Œ python å†…ç½®çš„å‡½æ•°ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³å¾—åˆ° Name è¿™ä¸€åˆ—å­—ç¬¦çš„ä¸ªæ•°ï¼Œå¦‚æœç”¨ apply() çš„è¯ï¼š df['NameLength'] = df['Name'].apply(len) DataFrame.apply() DataFrame.apply() å‡½æ•°åˆ™ä¼šéå†æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå¯¹å…ƒç´ è¿è¡ŒæŒ‡å®šçš„ functionã€‚æ¯”å¦‚ä¸‹é¢çš„ç¤ºä¾‹ï¼š import pandas as pd import numpy as np matrix = [ [1,2,3], [4,5,6], [7,8,9] ] df = pd.DataFrame(matrix, columns=list('xyz'), index=list('abc')) df.apply(np.square) å¯¹ df æ‰§è¡Œ square() å‡½æ•°åï¼Œæ‰€æœ‰çš„å…ƒç´ éƒ½æ‰§è¡Œå¹³æ–¹è¿ç®—ï¼š x y z a 1 4 9 b 16 25 36 c 49 64 81 å¦‚æœåªæƒ³ apply() ä½œç”¨äºæŒ‡å®šçš„è¡Œå’Œåˆ—ï¼Œå¯ä»¥ç”¨è¡Œæˆ–è€…åˆ—çš„ name å±æ€§è¿›è¡Œé™å®šã€‚æ¯”å¦‚ä¸‹é¢çš„ç¤ºä¾‹å°† x åˆ—è¿›è¡Œå¹³æ–¹è¿ç®—ï¼š df.apply(lambda x : np.square(x) if x.name=='x' else x) x y z a 1 2 3 b 16 5 6 c 49 8 9 ä¸‹é¢çš„ç¤ºä¾‹å¯¹ x å’Œ y åˆ—è¿›è¡Œå¹³æ–¹è¿ç®—ï¼š df.apply(lambda x : np.square(x) if x.name in ['x', 'y'] else x) x y z a 1 4 3 b 16 25 6 c 49 64 9 ä¸‹é¢çš„ç¤ºä¾‹å¯¹ç¬¬ä¸€è¡Œ ï¼ˆa æ ‡ç­¾æ‰€åœ¨è¡Œï¼‰è¿›è¡Œå¹³æ–¹è¿ç®—ï¼š df.apply(lambda x : np.square(x) if x.name == 'a' else x, axis=1) é»˜è®¤æƒ…å†µä¸‹ axis=0 è¡¨ç¤ºæŒ‰åˆ—ï¼Œaxis=1 è¡¨ç¤ºæŒ‰è¡Œã€‚ apply()è®¡ç®—æ—¥æœŸç›¸å‡ç¤ºä¾‹ å¹³æ—¶æˆ‘ä»¬ä¼šç»å¸¸ç”¨åˆ°æ—¥æœŸçš„è®¡ç®—ï¼Œæ¯”å¦‚è¦è®¡ç®—ä¸¤ä¸ªæ—¥æœŸçš„é—´éš”ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¸€ç»„å…³äº wbs èµ·æ­¢æ—¥æœŸçš„æ•°æ®ï¼š wbs date_from date_to job1 2019-04-01 2019-05-01 job2 2019-04-07 2019-05-17 job3 2019-05-16 2019-05-31 job4 2019-05-20 2019-06-11 å‡å®šè¦è®¡ç®—èµ·æ­¢æ—¥æœŸé—´éš”çš„å¤©æ•°ã€‚æ¯”è¾ƒç®€å•çš„æ–¹æ³•å°±æ˜¯ä¸¤åˆ—ç›¸å‡ï¼ˆdatetime ç±»å‹)ï¼š import pandas as pd import datetime as dt wbs = { \"wbs\": [\"job1\", \"job2\", \"job3\", \"job4\"], \"date_from\": [\"2019-04-01\", \"2019-04-07\", \"2019-05-16\",\"2019-05-20\"], \"date_to\": [\"2019-05-01\", \"2019-05-17\", \"2019-05-31\", \"2019-06-11\"] } df = pd.DataFrame(wbs) df['elpased'] = df['date_to'].apply(pd.to_datetime) - df['date_from'].apply(pd.to_datetime) apply() å‡½æ•°å°† date_from å’Œ date_to ä¸¤åˆ—è½¬æ¢æˆ datetime ç±»å‹ã€‚ print ä¸€ä¸‹ df: wbs date_from date_to elpased 0 job1 2019-04-01 2019-05-01 30 days 1 job2 2019-04-07 2019-05-17 40 days 2 job3 2019-05-16 2019-05-31 15 days 3 job4 2019-05-20 2019-06-11 22 days æ—¥æœŸé—´éš”å·²ç»è®¡ç®—å‡ºæ¥ï¼Œä½†åé¢å¸¦æœ‰ä¸€ä¸ªå•ä½ daysï¼Œè¿™æ˜¯å› ä¸ºä¸¤ä¸ª datetime ç±»å‹ç›¸å‡ï¼Œå¾—åˆ°çš„æ•°æ®ç±»å‹æ˜¯ timedelta64ï¼Œå¦‚æœåªè¦æ•°å­—ï¼Œè¿˜éœ€è¦ä½¿ç”¨ timedelta çš„ days å±æ€§è½¬æ¢ä¸€ä¸‹ã€‚ elapsed= df['date_to'].apply(pd.to_datetime) - df['date_from'].apply(pd.to_datetime) df['elpased'] = elapsed.apply(lambda x : x.days) ä½¿ç”¨ DataFrame.apply() å‡½æ•°ä¹Ÿèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•° get_interval_days() å‡½æ•°çš„ç¬¬ä¸€åˆ—æ˜¯ä¸€ä¸ª Series ç±»å‹çš„å˜é‡ï¼Œæ‰§è¡Œçš„æ—¶å€™ï¼Œä¾æ¬¡æ¥æ”¶ DataFrame çš„æ¯ä¸€è¡Œã€‚ import pandas as pd import datetime as dt def get_interval_days(arrLike, start, end): start_date = dt.datetime.strptime(arrLike[start], '%Y-%m-%d') end_date = dt.datetime.strptime(arrLike[end], '%Y-%m-%d') return (end_date - start_date).days wbs = { \"wbs\": [\"job1\", \"job2\", \"job3\", \"job4\"], \"date_from\": [\"2019-04-01\", \"2019-04-07\", \"2019-05-16\",\"2019-05-20\"], \"date_to\": [\"2019-05-01\", \"2019-05-17\", \"2019-05-31\", \"2019-06-11\"] } df = pd.DataFrame(wbs) df['elapsed'] = df.apply( get_interval_days, axis=1, args=('date_from', 'date_to')) å‚è€ƒï¼š pandas apply() å‡½æ•° pandas.DataFrame.applyå‡½æ•°æ–¹æ³•çš„ä½¿ç”¨ Update timeï¼š 2020-05-25 "},"Chapter2/Pandas map, applymap and applyçš„åŒºåˆ«.html":{"url":"Chapter2/Pandas map, applymap and applyçš„åŒºåˆ«.html","title":"Pandas map, applymap and applyçš„åŒºåˆ«","keywords":"","body":"Pandas map, applymap and applyçš„åŒºåˆ« apply() Pandas Applyå‡½æ•° pandas çš„ apply() å‡½æ•°å¯ä»¥ä½œç”¨äº Series æˆ–è€…æ•´ä¸ª DataFrameï¼ŒåŠŸèƒ½ä¹Ÿæ˜¯è‡ªåŠ¨éå†æ•´ä¸ª Series æˆ–è€… DataFrame, å¯¹æ¯ä¸€ä¸ªå…ƒç´ è¿è¡ŒæŒ‡å®šçš„å‡½æ•°ã€‚ In [116]: frame = DataFrame(np.random.randn(4, 3), columns=list('bde'), index=['Utah', 'Ohio', 'Texas', 'Oregon']) In [117]: frame Out[117]: b d e Utah -0.029638 1.081563 1.280300 Ohio 0.647747 0.831136 -1.549481 Texas 0.513416 -0.884417 0.195343 Oregon -0.485454 -0.477388 -0.309548 In [118]: f = lambda x: x.max() - x.min() In [119]: frame.apply(f) Out[119]: b 1.133201 d 1.965980 e 2.829781 dtype: float64 applymap() å¦‚æœæƒ³è®©æ–¹ç¨‹ä½œç”¨äºDataFrameä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨applymap() In [120]: format = lambda x: '%.2f' % x In [121]: frame.applymap(format) Out[121]: b d e Utah -0.03 1.08 1.28 Ohio 0.65 0.83 -1.55 Texas 0.51 -0.88 0.20 Oregon -0.49 -0.48 -0.31 map() map()åªè¦æ˜¯ä½œç”¨å°†å‡½æ•°ä½œç”¨äºä¸€ä¸ªSeriesçš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œç”¨æ³•å¦‚ä¸‹æ‰€ç¤º In [122]: frame['e'].map(format) Out[122]: Utah 1.28 Ohio -1.55 Texas 0.20 Oregon -0.31 Name: e, dtype: object æ€»çš„æ¥è¯´å°±æ˜¯apply()æ˜¯ä¸€ç§è®©å‡½æ•°ä½œç”¨äºåˆ—æˆ–è€…è¡Œæ“ä½œï¼Œapplymap()æ˜¯ä¸€ç§è®©å‡½æ•°ä½œç”¨äºDataFrameæ¯ä¸€ä¸ªå…ƒç´ çš„æ“ä½œï¼Œè€Œmapæ˜¯ä¸€ç§è®©å‡½æ•°ä½œç”¨äºSeriesæ¯ä¸€ä¸ªå…ƒç´ çš„æ“ä½œ map ä¹Ÿå¯ä»¥ç”¨å­—å…¸è¿›è¡Œæ˜ å°„ data = pd.read_csv(\"data.csv\") data['gender'].head() ç»“æœï¼š 0 1.0 1 0.0 2 2.0 3 1.0 4 2.0 Name: gender, dtype: float64 mp = { 0:'æœªçŸ¥', 1:'ç”·', 2:'å¥³' } data['gender'] = data['gender'].map(mp) data['gender'].head() ç»“æœï¼š 0 ç”· 1 æœªçŸ¥ 2 å¥³ 3 ç”· 4 å¥³ Name: gender, dtype: object key æˆ–è€… value å¿…é¡»æœ‰ä¸€ä¸ªæ˜¯ int å‹çš„å€¼ company_size_map = { \"2000äººä»¥ä¸Š\": 6, \"500-2000äºº\": 5, \"150-500äºº\": 4, \"50-150äºº\": 3, \"15-50äºº\": 2, \"å°‘äº15äºº\": 1 } workYear_map = { \"5-10å¹´\": 5, \"3-5å¹´\": 4, \"1-3å¹´\": 3, \"1å¹´ä»¥ä¸‹\": 2, \"åº”å±Šæ¯•ä¸šç”Ÿ\": 1 } df[\"company_size\"] = df[\"companySize\"].map(company_size_map) df[\"work_year\"] = df[\"workYear\"].map(workYear_map) å‚è€ƒ Pandas ä¸­map, applymap and applyçš„åŒºåˆ« Update timeï¼š 2020-05-25 "},"Chapter2/Pandas pivotå‡½æ•°.html":{"url":"Chapter2/Pandas pivotå‡½æ•°.html","title":"Pandas pivotå‡½æ•°","keywords":"","body":"Pandas pivotå‡½æ•° DataFrame.pivot(index=None, columns=None, values=None ) è¿”å›æŒ‰ç»™å®šç´¢å¼•/åˆ—å€¼ç»„ç»‡çš„é‡æ–°æ„é€ çš„DataFrameã€‚ æ ¹æ®åˆ—å€¼é‡å¡‘æ•°æ®(ç”Ÿæˆä¸€ä¸ª \"pivot\" è¡¨)ã€‚ä½¿ç”¨æ¥è‡ªæŒ‡å®šç´¢å¼•/åˆ—çš„æƒŸä¸€å€¼æ¥å½¢æˆç»“æœDataFrameçš„è½´ã€‚æ­¤å‡½æ•°ä¸æ”¯æŒæ•°æ®èšåˆï¼Œå¤šä¸ªå€¼å°†å¯¼è‡´åˆ—ä¸­çš„å¤šç´¢å¼•ã€‚ index ï¼šstræˆ– object, å¯é€‰ç”¨äºåˆ¶ä½œæ–°frameç´¢å¼•çš„åˆ—ã€‚å¦‚æœä¸ºNoneï¼Œåˆ™ä½¿ç”¨ç°æœ‰ç´¢å¼•ã€‚ columns ï¼šstræˆ–objectä½ç½®å‚æ•°ä¼ é€’ç»™funcã€‚ values ï¼šstr, object æˆ– ä¹‹å‰çš„åˆ—è¡¨, å¯é€‰äºå¡«å……æ–°frameå€¼çš„åˆ—ã€‚å¦‚æœæœªæŒ‡å®šï¼Œå°†ä½¿ç”¨æ‰€æœ‰å‰©ä½™çš„åˆ—ï¼Œå¹¶ä¸”ç»“æœå°†å…·æœ‰æŒ‰å±‚æ¬¡ç»“æ„ç´¢å¼•çš„åˆ—ã€‚ è¿”å› DataFrame è¿”å›è°ƒæ•´åçš„DataFrameã€‚ ä¾‹å­ import pandas as pd df = pd.DataFrame({'foo': ['one', 'one', 'one', 'two', 'two', 'two'], 'bar': ['A', 'B', 'C', 'A', 'B', 'C'], 'baz': [1, 2, 3, 4, 5, 6], 'zoo': ['x', 'y', 'z', 'q', 'w', 't']}) df foo bar baz zoo 0 one A 1 x 1 one B 2 y 2 one C 3 z 3 two A 4 q 4 two B 5 w 5 two C 6 t df.pivot(index='foo', columns='bar', values='baz') # æˆ– df.pivot(index='foo', columns='bar')['baz'] æŸ¥çœ‹å¤šåˆ—æ•°æ® df.pivot(index='foo', columns='bar', values=['baz', 'zoo']) å¦‚æœå­˜åœ¨é‡å¤é¡¹ï¼Œåˆ™ä¼šå¼•å‘ValueError å‚è€ƒ pandas.DataFrame.pivotå‡½æ•° Update timeï¼š 2020-05-25 "},"Chapter2/Pandas pivot_tableå‡½æ•°.html":{"url":"Chapter2/Pandas pivot_tableå‡½æ•°.html","title":"Pandas pivot_tableå‡½æ•°","keywords":"","body":"Pandas pivot_tableå‡½æ•° é€è§†è¡¨æ˜¯ä¸€ç§å¯ä»¥å¯¹æ•°æ®åŠ¨æ€æ’å¸ƒå¹¶ä¸”åˆ†ç±»æ±‡æ€»çš„è¡¨æ ¼æ ¼å¼ã€‚æˆ–è®¸å¤§å¤šæ•°äººéƒ½åœ¨Excelä½¿ç”¨è¿‡æ•°æ®é€è§†è¡¨ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œä¹Ÿä½“ä¼šåˆ°å®ƒçš„å¼ºå¤§åŠŸèƒ½ï¼Œè€Œåœ¨pandasä¸­å®ƒè¢«ç§°ä½œpivot_tableã€‚ DataFrame.pivot_table(values=None, index=None, columns=None, aggfunc='mean', fill_value=None, margins=False, dropna=True, margins_name='All', observed=False ) pivot_tableä¸­çš„çº§åˆ«å°†å­˜å‚¨åœ¨ç»“æœDataFrameçš„ç´¢å¼•å’Œåˆ—ä¸Šçš„MultiIndexå¯¹è±¡ï¼ˆåˆ†å±‚ç´¢å¼•ï¼‰ä¸­ã€‚ å‚æ•° values ï¼šè¦æ±‡æ€»çš„åˆ—ï¼Œå¯é€‰ index : columnï¼ŒGrouperï¼Œarrayæˆ–ä¸Šä¸€ä¸ªlist å¦‚æœä¼ é€’æ•°ç»„ï¼Œåˆ™å…¶é•¿åº¦å¿…é¡»ä¸æ•°æ®é•¿åº¦ç›¸åŒã€‚ è¯¥åˆ—è¡¨å¯ä»¥åŒ…å«ä»»ä½•å…¶ä»–ç±»å‹ï¼ˆåˆ—è¡¨é™¤å¤–ï¼‰ã€‚ åœ¨pivot tableç´¢å¼•ä¸Šè¿›è¡Œåˆ†ç»„çš„é”®ã€‚ å¦‚æœä¼ é€’äº†æ•°ç»„ï¼Œåˆ™å…¶ä½¿ç”¨æ–¹å¼ä¸åˆ—å€¼ç›¸åŒã€‚ columns : columnï¼ŒGrouperï¼Œarrayæˆ–ä¸Šä¸€ä¸ªlist å¦‚æœä¼ é€’æ•°ç»„ï¼Œåˆ™å…¶é•¿åº¦å¿…é¡»ä¸æ•°æ®é•¿åº¦ç›¸åŒã€‚ è¯¥åˆ—è¡¨å¯ä»¥åŒ…å«ä»»ä½•å…¶ä»–ç±»å‹ï¼ˆåˆ—è¡¨é™¤å¤–ï¼‰ã€‚ åœ¨pivot tableåˆ—ä¸Šè¿›è¡Œåˆ†ç»„çš„é”®ã€‚å¦‚æœä¼ é€’äº†æ•°ç»„ï¼Œ åˆ™å…¶ä½¿ç”¨æ–¹å¼ä¸åˆ—å€¼ç›¸åŒã€‚ aggfunc ï¼šå‡½æ•°ï¼Œå‡½æ•°åˆ—è¡¨ï¼Œå­—å…¸ï¼Œé»˜è®¤numpy.mean å¦‚æœä¼ é€’äº†å‡½æ•°åˆ—è¡¨ï¼Œ åˆ™ç”Ÿæˆçš„pivot tableå°†å…·æœ‰å±‚æ¬¡ç»“æ„åˆ—ï¼Œ å…¶é¡¶å±‚æ˜¯å‡½æ•°åç§°ï¼ˆä»å‡½æ•°å¯¹è±¡æœ¬èº«æ¨è®ºå¾—å‡ºï¼‰ã€‚ å¦‚æœä¼ é€’äº†dictï¼Œåˆ™é”®ä¸ºè¦æ±‡æ€»çš„åˆ—ï¼Œ å€¼æ˜¯å‡½æ•°æˆ–å‡½æ•°åˆ—è¡¨ã€‚ fill_value ï¼šscalar(æ ‡é‡)ï¼Œé»˜è®¤ä¸ºNone ç”¨äºæ›¿æ¢ç¼ºå¤±å€¼çš„å€¼ã€‚ margins ï¼šboolï¼Œé»˜è®¤ä¸ºFalse æ·»åŠ æ‰€æœ‰è¡Œ/åˆ—ï¼ˆä¾‹å¦‚ï¼Œå°è®¡/æ€»è®¡ï¼‰ã€‚ dropna ï¼šboolï¼Œé»˜è®¤ä¸ºTrue ä¸è¦åŒ…æ‹¬æ‰€æœ‰æ¡ç›®å‡ä¸ºNaNçš„åˆ—ã€‚ margins_name ï¼šstrï¼Œé»˜è®¤ä¸º\"All\" å½“marginsä¸ºTrueæ—¶å°†åŒ…å«æ€»è®¡çš„è¡Œ/åˆ—çš„åç§°ã€‚ observed ï¼šboolï¼Œé»˜è®¤ä¸ºFalse ä»…å½“ä»»ä½• groupersæ˜¯åˆ†ç±»è€…æ—¶æ‰é€‚ç”¨ã€‚ å¦‚æœä¸ºTrueï¼šä»…æ˜¾ç¤ºåˆ†ç±» groupers çš„è§‚æµ‹å€¼ã€‚ å¦‚æœä¸ºFalseï¼šæ˜¾ç¤ºåˆ†ç±» groupers çš„æ‰€æœ‰å€¼ã€‚ è¿”å›å€¼ DataFrame Excelæ ·å¼çš„pivot table. df = pd.DataFrame({\"A\": [\"foo\", \"foo\", \"foo\", \"foo\", \"foo\", \"bar\", \"bar\", \"bar\", \"bar\"], \"B\": [\"one\", \"one\", \"one\", \"two\", \"two\", \"one\", \"one\", \"two\", \"two\"], \"C\": [\"small\", \"large\", \"large\", \"small\", \"small\", \"large\", \"small\", \"small\", \"large\"], \"D\": [1, 2, 2, 3, 3, 4, 5, 6, 7], \"E\": [2, 4, 5, 5, 6, 6, 8, 9, 9]}) A B C D E 0 foo one small 1 2 1 foo one large 2 4 2 foo one large 2 5 3 foo two small 3 5 4 foo two small 3 6 5 bar one large 4 6 6 bar one small 5 8 7 bar two small 6 9 8 bar two large 7 9 é€šè¿‡è®¡ç®—å’Œæ¥èšåˆå€¼ table = pd.pivot_table(df, values='D', index=['A', 'B'], columns=['C'], aggfunc=np.sum) ä½¿ç”¨fill_valueå‚æ•°æ¥å¡«å……ç¼ºå¤±çš„å€¼ table = pd.pivot_table(df, values='D', index=['A', 'B'], columns=['C'], aggfunc=np.sum, fill_value=0) é€šè¿‡è·¨å¤šä¸ªåˆ—å–å¹³å‡å€¼æ¥æ±‡æ€» table = pd.pivot_table(df, values=['D', 'E'], index=['A', 'C'], aggfunc={'D': np.mean, 'E': np.mean}) å¯ä»¥ä¸ºä»»ä½•ç»™å®šå€¼åˆ—è®¡ç®—å¤šç§ç±»å‹çš„èšåˆ table = pd.pivot_table(df, values=['D', 'E'], index=['A', 'C'], aggfunc={'D': np.mean, 'E': [min, max, np.mean]}) æ¡ˆä¾‹ pivot_table æœ‰å››ä¸ªæœ€é‡è¦çš„å‚æ•°indexã€valuesã€columnsã€aggfuncï¼Œ ä»¥ç«ç®­é˜ŸJames_Hardenæœ¬èµ›å­£æ¯”èµ›æ•°æ®ä½œä¸ºæ•°æ®é›†è¿›è¡Œè®²è§£ã€‚ è¯»å–æ•°æ® import pandas as pd import numpy as np df = pd.read_csv('James_Harden.csv',encoding='utf8') df.head() å‚æ•° Index æ¯ä¸ª pivot_table å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªindexï¼Œå¦‚æœæƒ³æŸ¥çœ‹å“ˆç™»å¯¹é˜µæ¯ä¸ªé˜Ÿä¼çš„å¾—åˆ†ï¼Œé¦–å…ˆæˆ‘ä»¬å°†å¯¹æ‰‹è®¾ç½®ä¸ºindex pd.pivot_table(df,index=['å¯¹æ‰‹']).head() å¯¹æ‰‹æˆä¸ºäº†ç¬¬ä¸€å±‚ç´¢å¼•ï¼Œè¿˜æƒ³çœ‹çœ‹å¯¹é˜µåŒä¸€å¯¹æ‰‹åœ¨ä¸åŒä¸»å®¢åœºä¸‹çš„æ•°æ®ï¼Œè¯•ç€å°†å¯¹æ‰‹ä¸èƒœè´Ÿä¸ä¸»å®¢åœºéƒ½è®¾ç½®ä¸ºindex pd.pivot_table(df,index=[u'å¯¹æ‰‹',u'ä¸»å®¢åœº']) è¯•ç€äº¤æ¢ä¸‹å®ƒä»¬çš„é¡ºåºï¼Œæ•°æ®ç»“æœä¸€æ ·ï¼š pd.pivot_table(df,index=[u'ä¸»å®¢åœº',u'å¯¹æ‰‹']) Indexå°±æ˜¯å±‚æ¬¡å­—æ®µï¼Œè¦é€šè¿‡é€è§†è¡¨è·å–ä»€ä¹ˆä¿¡æ¯å°±æŒ‰ç…§ç›¸åº”çš„é¡ºåºè®¾ç½®å­—æ®µï¼Œæ‰€ä»¥åœ¨è¿›è¡Œpivotä¹‹å‰ä½ ä¹Ÿéœ€è¦è¶³å¤Ÿäº†è§£ä½ çš„æ•°æ®ã€‚ å‚æ•° Values é€šè¿‡ä¸Šé¢çš„æ“ä½œï¼Œæˆ‘ä»¬è·å–äº†james hardenåœ¨å¯¹é˜µå¯¹æ‰‹æ—¶çš„æ‰€æœ‰æ•°æ®ï¼Œè€ŒValueså¯ä»¥å¯¹éœ€è¦çš„è®¡ç®—æ•°æ®è¿›è¡Œç­›é€‰ï¼Œå¦‚æœæˆ‘ä»¬åªéœ€è¦james hardenåœ¨ä¸»å®¢åœºå’Œä¸åŒèƒœè´Ÿæƒ…å†µä¸‹çš„å¾—åˆ†ã€ç¯®æ¿ä¸åŠ©æ”»ä¸‰é¡¹æ•°æ®ï¼š pd.pivot_table(df,index=[u'ä¸»å®¢åœº',u'èƒœè´Ÿ'],values=[u'å¾—åˆ†',u'åŠ©æ”»',u'ç¯®æ¿']) â€‹ å‚æ•° Columns Columnsç±»ä¼¼Indexå¯ä»¥è®¾ç½®åˆ—å±‚æ¬¡å­—æ®µï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªå¿…è¦å‚æ•°ï¼Œä½œä¸ºä¸€ç§åˆ†å‰²æ•°æ®çš„å¯é€‰æ–¹å¼ã€‚ #fill_valueå¡«å……ç©ºå€¼,margins=Trueè¿›è¡Œæ±‡æ€» pd.pivot_table(df,index=[u'ä¸»å®¢åœº'],columns=[u'å¯¹æ‰‹'],values=[u'å¾—åˆ†'],aggfunc=[np.sum]) table=pd.pivot_table(df,index=[u'å¯¹æ‰‹',u'èƒœè´Ÿ'],columns=[u'ä¸»å®¢åœº'],values=[u'å¾—åˆ†',u'åŠ©æ”»',u'ç¯®æ¿'],aggfunc=[np.mean],fill_value=0) query å½“è¡¨æ ¼ç”Ÿæˆåå¦‚ä½•æŸ¥è¯¢æŸä¸€é¡¹æ•°æ®å‘¢ï¼Ÿ ex.æ ¹æ®ä¸Šè¡¨æŸ¥è¯¢å“ˆç™»å¯¹é˜µç°ç†Šæ—¶çš„æ•°æ® table.query('å¯¹æ‰‹ == [\"ç°ç†Š\"]') Cheat Sheet Pandas | ä¸€æ–‡çœ‹æ‡‚é€è§†è¡¨pivot_table æ•°æ® Update timeï¼š 2020-05-25 "},"Chapter2/Pandas crosstabäº¤å‰è¡¨.html":{"url":"Chapter2/Pandas crosstabäº¤å‰è¡¨.html","title":"Pandas crosstabäº¤å‰è¡¨","keywords":"","body":"Pandas crosstabäº¤å‰è¡¨ äº¤å‰è¡¨ï¼šcrosstab ä»€ä¹ˆæ˜¯äº¤å‰è¡¨ äº¤å‰è¡¨æ˜¯ä¸€ç§å¸¸ç”¨çš„åˆ†ç±»æ±‡æ€»è¡¨æ ¼ï¼Œç”¨äºé¢‘æ•°åˆ†å¸ƒç»Ÿè®¡ï¼Œä¸»è¦ä»·å€¼åœ¨äºæè¿°äº†å˜é‡é—´å…³ç³»çš„æ·±åˆ»å«ä¹‰ã€‚è™½ç„¶ä¸¤ä¸ªï¼ˆæˆ–ä»¥ä¸Šï¼‰å˜é‡å¯ä»¥æ˜¯åˆ†ç±»çš„æˆ–æ•°é‡çš„ï¼Œä½†æ˜¯ä»¥éƒ½æ˜¯åˆ†ç±»çš„æƒ…å½¢æœ€ä¸ºå¸¸è§ã€‚ äº¤å‰è¡¨(cross-tabulation, ç®€ç§°crosstab)æ˜¯ä¸€ç§ç”¨äºè®¡ç®—åˆ†ç»„é¢‘ç‡çš„ç‰¹æ®Šé€è§†è¡¨ã€‚ pandas.crosstab(index, columns, values=None, rownames=None, colnames=None, aggfunc=None, margins=False, margins_name: str = 'All', dropna: bool = True, normalize=False) â†’ 'DataFrame' pandas.crosstab ä¾‹å­ä¸­ç”¨åˆ°çš„æ•°æ® å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå˜é‡ï¼Œæ€§åˆ«ï¼ˆç”·æ€§æˆ–å¥³æ€§ï¼‰å’Œæ‰‹æ€§ï¼ˆå³æˆ–å·¦æ‰‹ï¼‰ã€‚ è¿›ä¸€æ­¥å‡è®¾ï¼Œä»éå¸¸å¤§çš„äººç¾¤ä¸­éšæœºæŠ½å–100ä¸ªäººï¼Œä½œä¸ºå¯¹æ‰‹æ€§çš„æ€§åˆ«å·®å¼‚ç ”ç©¶çš„ä¸€éƒ¨åˆ†ã€‚ å¯ä»¥åˆ›å»ºä¸€ä¸ªäº¤å‰è¡¨æ¥æ˜¾ç¤ºç”·æ€§å’Œå³æ’‡å­ï¼Œç”·æ€§å’Œå·¦æ’‡å­ï¼Œå¥³æ€§å’Œå³æ’‡å­ä»¥åŠå¥³æ€§å’Œå·¦æ’‡å­çš„ä¸ªäººæ•°é‡ã€‚ è¿™æ ·çš„äº¤å‰è¡¨å¦‚ä¸‹æ‰€ç¤ºã€‚ ç”·æ€§ï¼Œå¥³æ€§ä»¥åŠå³æ’‡å­å’Œå·¦æ’‡å­ä¸ªä½“çš„æ•°é‡ç§°ä¸ºè¾¹é™…æ€»æ•°ã€‚æ€»è®¡ï¼ˆå³äº¤å‰è¡¨ä¸­æ‰€ä»£è¡¨çš„ä¸ªäººæ€»æ•°ï¼‰æ˜¯å³ä¸‹è§’çš„æ•°å­—ã€‚ æ•°æ®æ¥è‡ªhttp://Kaggle.comï¼Œæ˜¯ä¸€ä¸ªå…³äºfacebookçš„çœŸå®å’Œè™šå‡è´¦å·çš„æ•°æ®é›†ï¼ŒåŒ…å«äº†889ä¸ªè´¦æˆ·çœŸå®ä¸å¦ä¿¡æ¯ã€å¥½å‹æ•°ã€æ•™è‚²æƒ…å†µã€æ€§åˆ«ã€ç­‰ä¿¡æ¯ã€‚æ•°æ®é›†é‡Œæœ‰ä¸€ä¸ªç¼ºå¤±å€¼ï¼Œè¿›ä¸€æ­¥å¤„ç†ä¹‹å‰ï¼Œå…ˆæŠŠç¼ºå¤±å€¼å»æ‰ã€‚ æ•°æ® import pandas as pd df = pd.read_csv('facebookac.csv') dr = df.dropna() df = df.replace(' ', 'not available') ç”¨Pandasæ„å»ºäº¤å‰è¡¨ åŸºæœ¬çš„pandasæ–¹æ³• Pandasçš„crosstab()æ–¹æ³•ï¼ˆå®˜æ–¹æ–‡æ¡£åœ¨æ­¤ï¼‰èƒ½å¤Ÿå¿«é€Ÿæ„å»ºäº¤å‰è¡¨ï¼Œå¹¶å¯ä»¥é€šè¿‡å‚æ•°åŠ ä»¥ä¸ªæ€§åŒ–çš„è®¾ç½®ã€‚å…¶ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°†æ„æˆäº¤å‰è¡¨çš„è¡Œï¼Œç¬¬äºŒä¸ªå‚æ•°å°†æ„æˆäº¤å‰è¡¨çš„åˆ—ã€‚é€šè¿‡è¿™ä¸ªå¿«æ·çš„æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°çœŸå®å’Œè™šå‡è´¦æˆ·ä¸­ä¸åŒæƒ…æ„Ÿå…³ç³»çŠ¶æ€çš„é¢‘æ•°ï¼Œéå¸¸æ¸…æ™°æ˜äº†ã€‚ pd.crosstab(df['relationship'], df['Status']) pandasçš„DataFrameä¸­çš„å¦å¤–ä¸¤ä¸ªç”¨äºæ•°æ®æ±‡æ€»è½¬æ¢çš„æ–¹æ³•â€”â€”groupby()ã€pivot_table()â€”â€”ä¹Ÿåˆ†åˆ«éƒ½å¯ä»¥å®ç°è¿™ä¸ªæ•ˆæœï¼Œä¸è¿‡ä¼šéº»çƒ¦ä¸€äº›ã€‚DataFrame.grouby()å®˜æ–¹æ–‡æ¡£åœ¨æ­¤ï¼ŒDataFrame.pivot_table()å®˜æ–¹æ–‡æ¡£åœ¨æ­¤ã€‚ df.groupby(['relationship', 'Status'])['relationship'].count().unstack() df.pivot_table(values='education', index='relationship', columns='Status', aggfunc=len) crosstab()é‡è¦å‚æ•° åœ¨äº¤å‰è¡¨ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦ç»Ÿè®¡è¾¹é™…æ€»æ•°ï¼ˆå„è¡Œå’Œå„åˆ—çš„æ€»å’Œï¼‰ã€‚å½“ç„¶æˆ‘ä»¬å¯ä»¥ç”¨sum()å…ˆç®—å‡ºå„è¡Œã€å„åˆ—çš„å’Œå†ç”¨cancat()åˆå¹¶åˆ°äº¤å‰è¡¨ä¸­ï¼Œä¸è¿‡è¿™æ ·å®åœ¨å¤ªéº»çƒ¦äº†ã€‚Crosstab()çš„å‚æ•°marginså¯ä»¥å¸®æˆ‘ä»¬â€œä¸€é”®è§£å†³â€ï¼Œè¿˜å¯ä»¥é€šè¿‡margins_nameè®¾ç½®æ€»è®¡è¡Œï¼ˆåˆ—ï¼‰çš„åç§°ï¼ˆé»˜è®¤åç§°æ˜¯â€œAllâ€ï¼‰ã€‚ pd.crosstab(df['relationship'], df['Status'], margins=True, margins_name='Total') åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦ç»Ÿè®¡äº¤å‰è¡¨ä¸­å„é¡¹çš„ç›¸å¯¹é¢‘ç‡ï¼ˆå³æ‰€å ç™¾åˆ†æ¯”ï¼‰ã€‚ä¸€å¼€å§‹ï¼Œæ€»æ˜¯ç¹çåœ°å…ˆç”¨sum()ç®—å‡ºæ€»å’Œï¼Œç„¶åç”¨div()æ¥æ±‚å‡ºç›¸å¯¹ç›¸å¯¹é¢‘ç‡ã€‚åæ¥å‘ç°å¯ä»¥åœ¨crosstab()ä¸­ï¼Œç›´æ¥é€šè¿‡å‚æ•° normalizeè®¾ç½®ï¼Œæ–¹ä¾¿å¤šäº†ã€‚ pd.crosstab(df['relationship'], df['Status'], normalize=True) å¦‚æœéœ€è¦è®¡ç®—çš„æ˜¯å„é¡¹åœ¨æ‰€åœ¨è¡Œï¼ˆåˆ—ï¼‰çš„ç›¸å¯¹é¢‘æ•°ï¼Œnormalizeä¸€æ ·å¯ä»¥è§£å†³ã€‚normalizeå¯ä»¥æ¥å—ä¸‰ç§ä¸åŒç±»å‹çš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯{True, False}ã€{â€˜allâ€™, â€˜indexâ€™, â€˜columnsâ€™}å’Œ {0,1}ã€‚å…¶ä¸­â€œindexâ€æˆ–0è¡¨ç¤ºæŒ‰è¡Œç»Ÿè®¡ï¼ˆæ¯è¡Œæ€»å’Œéƒ½ä¸º1ï¼‰ï¼Œâ€œcolumnsâ€æˆ–â€œ1â€è¡¨ç¤ºæŒ‰åˆ—ç»Ÿè®¡ï¼ˆæ¯åˆ—æ€»å’Œéƒ½ä¸º1ï¼‰ã€‚ pd.crosstab(df['relationship'], df['Status'], normalize=0) pd.crosstab(df['relationship'], df['Status'], normalize=1) åˆ†å±‚äº¤å‰è¡¨ crosstab()çš„å‚æ•°indexå’Œcolumnså¯ä»¥æ¥å—åˆ—è¡¨ä¼ å…¥ï¼Œæ„å»ºåˆ†å±‚äº¤å‰è¡¨ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨äº¤å‰è¡¨ä¸­å†åŠ å…¥æ€§åˆ«ï¼ˆè¡¨æ ¼ä¸­çš„â€œgenderâ€åˆ—ï¼‰ä¿¡æ¯ï¼Œå¹¶æŒ‰åˆ—è®¡ç®—ç›¸å¯¹é¢‘ç‡ï¼Œçœ‹çœ‹åœ¨çœŸå®å’Œè™šå‡è´¦æˆ·ä¸­ï¼Œä¸åŒçš„æ€§åˆ«å’Œæƒ…æ„Ÿå…³ç³»çŠ¶æ€å’Œæ˜¯æ€ä¹ˆåˆ†å¸ƒçš„ã€‚è¿™ä¸ªäº¤å‰è¡¨ä¸­ï¼Œæ¯ä¸€åˆ—çš„æ€»å’Œä¸º1ã€‚ dfv = pd.crosstab([df['gender'], df['relationship']], df['Status'], normalize=1) dfv å¯ä»¥æŒ‰æŒ‡å®šçš„åˆ—æ’åº dfv[['real','fake']] äº¤å‰è¡¨å¯è§†åŒ– çœ‹åˆ°ä¸Šé¢çš„è¿™ä¸ªäº¤å‰è¡¨ï¼Œå¤§å®¶å¿ƒé‡Œå¯èƒ½ä¼šé»˜é»˜ç®—ä¸€ä¸‹å“ªäº›ç±»å‹å æ¯”é«˜ï¼Œå“ªäº›ç±»å‹å æ¯”ä½ã€‚å¦‚æœæ•°æ®å¤šäº†ï¼Œå°±ä¼šå¾ˆéš¾æœ‰ç›´è§‚æ„Ÿå—ã€‚å¥½åœ¨ï¼Œæˆ‘ä»¬æœ‰çƒ­å›¾ã€‚Seabornåº“ä¸­çš„heatmap()èƒ½å¿«é€Ÿç”Ÿæˆçƒ­å›¾ï¼Œå®˜æ–¹æ–‡æ¡£åœ¨æ­¤ã€‚ import seaborn as sns sns.heatmap(dfv, cmap='YlOrRd', annot=True) cmap='YlOrRd'æ˜¯æŠŠé¢œè‰²è®¾ç½®ä¸ºï¼šæ•°å€¼ä»ä½åˆ°é«˜ï¼Œé¢œè‰²ä¾æ¬¡æ˜¯é»„è‰²ã€æ©™è‰²ã€çº¢è‰²ã€‚annot=Trueæ˜¯æŒ‡åœ¨çƒ­å›¾ä¸­ä¿ç•™æ•°å€¼ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿”å›çš„çƒ­å›¾ä¸­ï¼Œæ¯ä¸€åˆ—çš„æŠŠä¸¤å±‚åˆ†ç»„çš„ç´¢å¼•å€¼æ ‡æ³¨äº†å‡ºæ¥ï¼Œéå¸¸æ¸…æ™°ã€‚åœ¨è™šå‡è´¦æˆ·ä¸­ï¼Œæœ€å¤šçš„æ˜¯â€œå•èº«å¥³æ€§â€ï¼Œå…¶æ¬¡æ˜¯â€œå•èº«ç”·æ€§â€ï¼Œå…¶ä»–çš„ç»„åˆæå°‘ç”šè‡³æ²¡æœ‰ã€‚è€ŒçœŸå®è´¦æˆ·ä¸­ï¼Œæœ€å¤šçš„æ˜¯â€œå•èº«ç”·æ€§â€ï¼Œå¹¶ä¸”åœ¨å„ç§ç»„åˆä¸­éƒ½æœ‰åˆ†å¸ƒã€‚ äº¤å‰è¡¨æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œå³ä½¿çƒ­å›¾ä¹Ÿä¼šè®©äººçœ‹ä¸è¿‡æ¥ã€‚è¿™æ—¶å¯ä»¥é€šè¿‡å‚æ•°maskæ¥ç­›é€‰çƒ­å›¾ä¸­æ˜¾ç¤ºçš„æ•°æ®ï¼Œä¸ç¬¦åˆæ¡ä»¶çš„å°±ä¸ä¼šæ˜¾ç¤ºäº†ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ›´é›†ä¸­åœ°å…³æ³¨ç‰¹å®šçš„æ•°æ®ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åªå…³æ³¨å æ¯”è¶…è¿‡10%çš„ç±»å‹ï¼Œdfv sns.heatmap(dfv, cmap='YlOrRd', annot=True, mask=dfv others import pandas as pd df = pd.read_excel('survey.xls') df pd.crosstab(df.Nationality, df.Handedness) è¾“å‡º: crosstab ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åˆ—ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¡Œã€‚è¿˜å¯ä»¥æ·»åŠ ç¬¬ä¸‰ä¸ªå‚æ•°: pd.crosstab(df.Sex, df.Handedness, margins = True) pd.crosstab([df.Nationality, df.Sex], df.Handedness, margins = True) æ±‚ç™¾åˆ†æ¯”: pd.crosstab(df.Sex, df.Handedness, normalize='index') æ±‚æŒ‡å®šåˆ—çš„å¹³å‡å€¼: import numpy as np pd.crosstab(df.Sex, df.Handedness, values=df.Age, aggfunc=np.average) å‚è€ƒ Pandas åŸºç¡€ (13) - Crosstab äº¤å‰åˆ—è¡¨å–å€¼ ç”¨Pythonç»Ÿè®¡æ¨æ–­â€”â€”äº¤å‰è¡¨ç¯‡ï¼ˆä¸Šï¼šcrosstabä¸çƒ­å›¾) https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.crosstab.html Update timeï¼š 2020-05-25 "},"Chapter2/rollingæ»šåŠ¨è®¡ç®—å‡½æ•°.html":{"url":"Chapter2/rollingæ»šåŠ¨è®¡ç®—å‡½æ•°.html","title":"rollingæ»šåŠ¨è®¡ç®—å‡½æ•°","keywords":"","body":"rollingæ»šåŠ¨è®¡ç®—å‡½æ•° Rolling.count() çª—å£å†…ä»»ä½•éNaNè§‚æµ‹å€¼çš„æ»šåŠ¨è®¡æ•° >>> s = pd.Series([2, 3, np.nan, 10]) >>> s.rolling(2).count() 0 1.0 1 2.0 2 1.0 3 1.0 dtype: float64 >>> s.rolling(3).count() 0 1.0 1 2.0 2 2.0 3 2.0 dtype: float64 >>> s.rolling(4).count() 0 1.0 1 2.0 2 2.0 3 3.0 dtype: float64 Rolling.sum è®¡ç®—ç»™å®šDataFrameæˆ–Seriesçš„æ»šåŠ¨æ€»å’Œ >>> s = pd.Series([1, 2, 3, 4, 5]) >>> s 0 1 1 2 2 3 3 4 4 5 dtype: int64 >>> s.rolling(3).sum() 0 NaN 1 NaN 2 6.0 3 9.0 4 12.0 dtype: float64 >>> s.expanding(3).sum() 0 NaN 1 NaN 2 6.0 3 10.0 4 15.0 dtype: float64 >>> s.rolling(3, center=True).sum() 0 NaN 1 6.0 2 9.0 3 12.0 4 NaN dtype: float64 Rolling.median è®¡ç®—æ»šåŠ¨ä¸­ä½æ•°ã€‚ Rolling.median(self, **kwargs) >>> s = pd.Series([0, 1, 2, 3, 4]) >>> s.rolling(3).median() 0 NaN 1 NaN 2 1.0 3 2.0 4 3.0 dtype: float64 Rolling.var è®¡ç®—æ— åæ»šåŠ¨æ–¹å·®ã€‚ Rolling.var(self, ddof=1, *args, **kwargs) ddof : int, default 1 Delta Degrees of Freedom. The divisor used in calculations is N - ddof, where N represents the number of elements. *args, **kwargs For NumPy compatibility. No additional arguments are used. >>> s = pd.Series([5, 5, 6, 7, 5, 5, 5]) >>> s.rolling(3).var() 0 NaN 1 NaN 2 0.333333 3 1.000000 4 1.000000 5 1.333333 6 0.000000 dtype: float64 >>> s.expanding(3).var() 0 NaN 1 NaN 2 0.333333 3 0.916667 4 0.800000 5 0.700000 6 0.619048 dtype: float64 Rolling.std è®¡ç®—æ»šåŠ¨æ ‡å‡†åå·®ã€‚ Rolling.min è®¡ç®—æ»šåŠ¨æœ€å°å€¼ã€‚ Rolling.max è®¡ç®—æ»šåŠ¨æœ€å¤§å€¼ã€‚ Rolling.corr è®¡ç®—æ»šåŠ¨ç›¸å…³ç³»æ•° Rolling.corr(self, other=None, pairwise=None, **kwargs) other : Series, DataFrame, or ndarray, optional If not supplied then will default to self. pairwise : bool, default None Calculate pairwise combinations of columns within a DataFrame. If other is not specified, defaults to True, otherwise defaults to False. Not relevant for Series. **kwargs Unused. >>> v1 = [3, 3, 3, 5, 8] >>> v2 = [3, 4, 4, 4, 8] >>> s1 = pd.Series(v1) >>> s2 = pd.Series(v2) >>> s1.rolling(4).corr(s2) 0 NaN 1 NaN 2 NaN 3 0.333333 4 0.916949 dtype: float64 ä½¿ç”¨pairwiseé€‰é¡¹å¯¹DataFrameè¿›è¡Œç±»ä¼¼çš„æ»šåŠ¨è®¡ç®— >>> matrix = np.array([[51., 35.], [49., 30.], [47., 32.], [46., 31.], [50., 36.]]) >>> df = pd.DataFrame(matrix, columns=['X','Y']) >>> df X Y 0 51.0 35.0 1 49.0 30.0 2 47.0 32.0 3 46.0 31.0 4 50.0 36.0 >>> df.rolling(4).corr(pairwise=True) X Y 0 X NaN NaN Y NaN NaN 1 X NaN NaN Y NaN NaN 2 X NaN NaN Y NaN NaN 3 X 1.000000 0.626300 Y 0.626300 1.000000 4 X 1.000000 0.555368 Y 0.555368 1.000000 # ç´¢å¼•ä¸º 3 å’Œ 4 çš„ä¸¤ä¸ªçŸ©é˜µ, å³ä¸‹å¯¹è§’çº¿ä¸ºè‡ªèº«çš„ç›¸å…³ç³»æ•°ï¼Œå³ä¸Šå¯¹è§’çº¿ä¸ºä¸¤è€…çš„ç›¸å…³ç³»æ•° Rolling.cov è®¡ç®—æ»šåŠ¨æ ·æœ¬åæ–¹å·® Rolling.cov(self, other=None, pairwise=None, ddof=1, **kwargs) Update timeï¼š 2020-05-25 "},"Chapter2/cumç´¯ç§¯è®¡ç®—å‡½æ•°.html":{"url":"Chapter2/cumç´¯ç§¯è®¡ç®—å‡½æ•°.html","title":"cumç´¯ç§¯è®¡ç®—å‡½æ•°","keywords":"","body":"cumç´¯ç§¯è®¡ç®—å‡½æ•° cumç³»åˆ—å‡½æ•°æ˜¯ä½œä¸ºDataFrameæˆ–Serieså¯¹è±¡çš„æ–¹æ³•å‡ºç°çš„ï¼Œå› æ­¤å‘½ä»¤æ ¼å¼ä¸ºD.cumsum() æ–¹æ³•å å‡½æ•°åŠŸèƒ½ cumsum() ä¾æ¬¡ç»™å‡ºå‰1ã€2ã€â€¦ ã€nä¸ªæ•°çš„å’Œ cumprod() ä¾æ¬¡ç»™å‡ºå‰1ã€2ã€â€¦ ã€nä¸ªæ•°çš„ç§¯ cummax() ä¾æ¬¡ç»™å‡ºå‰1ã€2ã€â€¦ ã€nä¸ªæ•°çš„æœ€å¤§å€¼ cummin() ä¾æ¬¡ç»™å‡ºå‰1ã€2ã€â€¦ ã€nä¸ªæ•°çš„æœ€å°å€¼ D=pd.Series(range(0,20)) D.cumsum() 0 0 1 1 2 3 3 6 .... 19 190 dtype: int64 Update timeï¼š 2020-05-25 "},"Chapter3/":{"url":"Chapter3/","title":"Scipy","keywords":"","body":"Scipy Update timeï¼š 2020-05-25 "},"Chapter3/ç»Ÿè®¡å‡½æ•°åº“scipy.stats.html":{"url":"Chapter3/ç»Ÿè®¡å‡½æ•°åº“scipy.stats.html","title":"ç»Ÿè®¡å‡½æ•°åº“scipy.stats","keywords":"","body":"ç»Ÿè®¡å‡½æ•°åº“scipy.stats å¸¸è§åˆ†å¸ƒ å¯èƒ½ç”¨åˆ°çš„åˆ†å¸ƒå¯¹ç…§è¡¨ åç§° å«ä¹‰ f Fåˆ†å¸ƒ gamma gamåˆ†å¸ƒ poisson æ³Šæ¾åˆ†å¸ƒ binom äºŒé¡¹åˆ†å¸ƒ uniform å‡åŒ€åˆ†å¸ƒ chi2 å¡æ–¹åˆ†å¸ƒ t å­¦ç”ŸTåˆ†å¸ƒ norm æ­£æ€åˆ†å¸ƒ expon æŒ‡æ•°åˆ†å¸ƒ é€šç”¨å‡½æ•° åç§° å¤‡æ³¨ rvs äº§ç”Ÿæœä»æŒ‡å®šåˆ†å¸ƒçš„éšæœºæ•° pdf æ¦‚ç‡å¯†åº¦å‡½æ•° cdf ç´¯è®¡åˆ†å¸ƒå‡½æ•° sf æ®‹å­˜å‡½æ•°ï¼ˆ1-CDFï¼‰ ppf åˆ†ä½ç‚¹å‡½æ•°ï¼ˆCDFçš„é€†ï¼‰ isf é€†æ®‹å­˜å‡½æ•°ï¼ˆsfçš„é€†ï¼‰ fit å¯¹ä¸€ç»„éšæœºå–æ ·è¿›è¡Œæ‹Ÿåˆï¼Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡æ–¹æ³•æ‰¾å‡ºæœ€é€‚åˆå–æ ·æ•°æ®çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ç³»æ•°ã€‚ ç¦»æ•£åˆ†å¸ƒçš„ç®€å•æ–¹æ³•å¤§å¤šæ•°ä¸è¿ç»­åˆ†å¸ƒå¾ˆç±»ä¼¼ï¼Œä½†æ˜¯ pdf è¢«æ›´æ¢ä¸ºå¯†åº¦å‡½æ•°pmfã€‚ CDF : ç´¯ç§¯åˆ†å¸ƒå‡½æ•° (cumulative distribution function)ï¼Œæ˜¯æ¦‚ç‡å¯†åº¦å‡½æ•°çš„ç§¯åˆ†ï¼Œèƒ½å®Œæ•´æè¿°ä¸€ä¸ªå®éšæœºå˜é‡Xçš„æ¦‚ç‡åˆ†å¸ƒã€‚ CDFæ˜¯PDFçš„ï¼ˆä»è´Ÿæ— ç©·-ooåˆ°å½“å‰å€¼çš„ï¼‰ç§¯åˆ†ï¼ŒPDFæ˜¯CDFçš„å¯¼æ•°ï¼ CDFç›¸å½“äºå…¶å·¦ä¾§çš„é¢ç§¯ï¼Œä¹Ÿç›¸å½“äºå°äºè¯¥å€¼çš„æ¦‚ç‡ï¼Œè´Ÿæ— ç©·çš„CDFå€¼ä¸ºï¼ï¼Œæ­£æ— ç©·çš„CDFå€¼æ€»ä¸ºï¼‘ Update timeï¼š 2020-06-10 "},"Chapter3/norm å‡½æ•°.html":{"url":"Chapter3/norm å‡½æ•°.html","title":"norm å‡½æ•°","keywords":"","body":"norm å‡½æ•° scipy.stats.norm å‡½æ•° æ­£æ€åˆ†å¸ƒ scipy.stats.normå‡½æ•°å¯ä»¥å®ç°æ­£æ€åˆ†å¸ƒï¼ˆä¹Ÿå°±æ˜¯é«˜æ–¯åˆ†å¸ƒï¼‰ norm(loc=,scale=) # loc: mean å‡å€¼ï¼Œ scale: standard deviation æ ‡å‡†å·® ç”Ÿæˆæœä»æŒ‡å®šåˆ†å¸ƒçš„éšæœºæ•° norm.rvs() é€šè¿‡ locå’Œscale å‚æ•°å¯ä»¥æŒ‡å®šéšæœºå˜é‡çš„åç§»å’Œç¼©æ”¾å‚æ•°ï¼Œè¿™é‡Œå¯¹åº”çš„æ˜¯æ­£æ€åˆ†å¸ƒçš„æœŸæœ›å’Œæ ‡å‡†å·®ã€‚size å¾—åˆ°éšæœºæ•°æ•°ç»„çš„å½¢çŠ¶å‚æ•°ã€‚(ä¹Ÿå¯ä»¥ä½¿ç”¨np.random.normal(loc=0.0, scale=1.0, size=None)) æ±‚æ¦‚ç‡å¯†åº¦å‡½æ•°æŒ‡å®šç‚¹çš„å‡½æ•°å€¼ stats.norm.pdf æ­£æ€åˆ†å¸ƒæ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚ æ ‡å‡†å½¢å¼æ˜¯ï¼š f(x)=exp(âˆ’x2/2)2Ï€ f(x)=\\frac{\\exp \\left(-x^{2} / 2\\right)}{\\sqrt{2 \\pi}} f(x)=â€‹âˆšâ€‹2Ï€â€‹â€‹â€‹â€‹â€‹exp(âˆ’xâ€‹2â€‹â€‹/2)â€‹â€‹ import matplotlib.pyplot as plt import seaborn as sns from scipy.stats import norm import numpy as np sns.set_style('whitegrid') np.random.seed(1) X = np.linspace(-5,5,20) # ç¬¬ä¸€ç§è°ƒç”¨æ–¹å¼ gauss = norm(loc=1,scale=2) # loc: mean å‡å€¼ï¼Œ scale: standard deviation æ ‡å‡†å·® r_1 = gauss.pdf(X) # ç¬¬äºŒç§è°ƒç”¨æ–¹å¼ r_2 = norm.pdf(X, loc=0, scale=2) for i in range(len(X)): plt.scatter(X[i], 0, s=50) for g, c ,l in zip([r_1, r_2], ['r', 'g'],['r_1: $\\mu:1,\\sigma:2$','r_2: $\\mu:0,\\sigma:2$']): # 'r': red, 'g':green plt.plot(X, g, c=c,label=l) plt.legend() plt.show() æ ‡å‡†æ­£æ€åˆ†å¸ƒè¡¨ä¸å¸¸ç”¨å€¼ Z-score æ˜¯éæ ‡å‡†æ­£æ€åˆ†å¸ƒæ ‡å‡†åŒ–åçš„ xå³ ï¼šz=xâˆ’Î¼Ïƒz=\\frac{x-\\mu}{\\sigma}z=â€‹Ïƒâ€‹â€‹xâˆ’Î¼â€‹â€‹ è¡¨å¤´çš„æ¨ªå‘è¡¨ç¤ºå°æ•°ç‚¹åç¬¬äºŒä½ï¼Œè¡¨å¤´çš„çºµå‘åˆ™ä¸ºæ•´æ•°éƒ¨åˆ†ä»¥åŠå°æ•°ç‚¹åç¬¬ä¸€ä½ï¼›ä¸¤è€…è”åˆä½œä¸ºå®Œæ•´çš„ xï¼Œåæ ‡è½´çš„æ¨ªè½´ è¡¨ä¸­çš„å€¼ä¸ºå›¾ä¸­çº¢è‰²åŒºåŸŸçš„é¢ç§¯ï¼Œä¹Ÿå³ cdfï¼Œè¿ç»­åˆ†å¸ƒçš„ç´¯ç§¯æ¦‚ç‡å‡½æ•°ï¼Œè®°ä¸º Î¦(x)\\Phi(x)Î¦(x) cdf çš„é€†ï¼Œè®°ä¸ºÎ¦âˆ’1(x)\\Phi^{-1}(x)Î¦â€‹âˆ’1â€‹â€‹(x) ï¼Œå¦‚Î¦âˆ’1(3/4)\\Phi^{-1}(3/4)Î¦â€‹âˆ’1â€‹â€‹(3/4) ï¼Œè¡¨ç¤º x å–ä½•å€¼æ—¶ï¼Œé˜´å½±éƒ¨åˆ†çš„é¢ç§¯ä¸º 0.75ï¼ŒæŸ¥è¡¨å¯çŸ¥ï¼Œx ä»‹äº 0.67 å’Œ 0.68 ä¹‹é—´ï¼› from scipy.stats import norm norm.ppf(3/4) # 0.6744897501960817 cdf ä¸ ppfï¼ˆåˆ†ä½å‡½æ•°ï¼‰ from scipy.stats import norm è¦†ç›–çš„æ¦‚ç‡èŒƒå›´ï¼š norm.cdf(1) - norm.cdf(-1) # 0.6826894921370859 norm.cdf(2) - norm.cdf(-2) # 0.9544997361036416 norm.cdf(3) - norm.cdf(-3) # 0.9973002039367398 æ±‚ç´¯è®¡åˆ†å¸ƒå‡½æ•°æŒ‡å®šç‚¹çš„å‡½æ•°å€¼ stats.norm.cdfæ­£æ€åˆ†å¸ƒç´¯è®¡æ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚ Î¦(x)\\Phi(x)Î¦(x) ä¸º ç´¯ç§¯æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œä¹Ÿå³ cdfï¼š norm.cdf(0) # 0.5 ç´¯è®¡åˆ†å¸ƒå‡½æ•°çš„é€†å‡½æ•° stats.norm.ppfæ­£æ€åˆ†å¸ƒçš„ç´¯è®¡åˆ†å¸ƒå‡½æ•°çš„é€†å‡½æ•°ï¼Œå³ä¸‹åˆ†ä½ç‚¹ã€‚ Î¦âˆ’1(x)\\Phi^{-1}(x)Î¦â€‹âˆ’1â€‹â€‹(x) é€šè¿‡ ppf(x)è¿›è¡Œè®¡ç®—ï¼š >> from scipy.stats import norm # Q3 åˆ†ä½ç‚¹ï¼› >> norm.ppf(3/4) # 0.6744897501960817 # å³ Q3 åˆ†ä½ç‚¹å¤„çš„æ¨ªåæ ‡å–å€¼ä¸º 0.6744897501960817 # Q1 åˆ†ä½ç‚¹ >> norm.ppf(1/4) -0.6744897501960817 ä¾‹å¦‚ åœ¨æŸä¸€å‡è®¾æ£€éªŒä¸­ï¼Œè®¡ç®—å¾—åˆ°çš„ z=3.125z=3.125z=3.125 # å½“ Î±=0.01 æ—¶ ,é€šè¿‡æŸ¥è¡¨çš„ z_{0.01}=2.33 ,æ­¤æ—¶çš„ z_{0.01} å¯ä»¥é€šè¿‡ `norm.ppf` è®¡ç®—çš„åˆ° from scipy.stats import norm norm.ppf(1-0.01) # 2.3263478740408408 å‚è€ƒ æ ‡å‡†æ­£æ€åˆ†å¸ƒè¡¨ï¼ˆscipy.statsï¼‰ scipy.stats.normå‡½æ•° pythonç»Ÿè®¡å‡½æ•°åº“scipy.statsçš„ç”¨æ³•è§£æ Update timeï¼š 2020-06-10 "},"Chapter3/æ’å€¼.html":{"url":"Chapter3/æ’å€¼.html","title":"æ’å€¼","keywords":"","body":"æ’å€¼ Update timeï¼š 2020-05-25 "},"Chapter3/scipy-interpolate.html":{"url":"Chapter3/scipy-interpolate.html","title":"scipy-interpolate","keywords":"","body":"scipy-interpolate ä¸€ç»´æ’å€¼ interp1dç±»è¿›è¡Œä¸€ç»´æ’å€¼ ä¸€ç»´æ•°æ®çš„æ’å€¼è¿ç®—å¯ä»¥é€šè¿‡å‡½æ•°interp1d()å®Œæˆã€‚ interp1d(x, y, kind='linear', ...) å…¶ä¸­ï¼Œxå’Œyå‚æ•°æ˜¯ä¸€ç³»åˆ—å·²çŸ¥çš„æ•°æ®ç‚¹ï¼Œkindå‚æ•°æ˜¯æ’å€¼ç±»å‹ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ•´æ•°ï¼Œå®ƒç»™å‡ºæ’å€¼çš„Bæ ·æ¡æ›²çº¿çš„é˜¶æ•°ï¼Œå€™é€‰å€¼åŠä½œç”¨ä¸‹è¡¨æ‰€ç¤ºï¼š å€™é€‰å€¼ ä½œç”¨ â€˜zeroâ€™ ã€'nearest' é˜¶æ¢¯æ’å€¼ï¼Œç›¸å½“äº0é˜¶Bæ ·æ¡æ›²çº¿ â€˜slinearâ€™ ã€'linear' çº¿æ€§æ’å€¼ï¼Œç”¨ä¸€æ¡ç›´çº¿è¿æ¥æ‰€æœ‰çš„å–æ ·ç‚¹ï¼Œç›¸å½“äºä¸€é˜¶Bæ ·æ¡æ›²çº¿ â€˜quadraticâ€™ ã€'cubic' äºŒé˜¶å’Œä¸‰é˜¶Bæ ·æ¡æ›²çº¿ï¼Œæ›´é«˜é˜¶çš„æ›²çº¿å¯ä»¥ç›´æ¥ä½¿ç”¨æ•´æ•°å€¼æŒ‡å®š interp1dæ¯”Matlabçš„interpæœ‰äº›ä¼˜åŠ¿ï¼Œå› ä¸ºè¿”å›çš„æ˜¯å‡½æ•°ï¼Œä¸éœ€è¦åœ¨äº‹å…ˆè®¾å®šéœ€è¦æ±‚è§£çš„ç‚¹ï¼Œè€Œæ˜¯åœ¨éœ€è¦ä½¿ç”¨æ—¶è°ƒç”¨å‡½æ•°ã€‚ import numpy as np import pylab as pl from scipy import interpolate import matplotlib as mpl mpl.rcParams['font.sans-serif'] = ['SimHei'] x = np.linspace(0,10,11) y = np.sin(x) xnew = np.linspace(0,10,101) pl.plot(x,y,'ro') for kind in ['nearest', 'zero', 'slinear', 'quadratic']: f = interpolate.interp1d(x,y,kind=kind) ynew = f(xnew) pl.plot(xnew, ynew,label=str(kind)) pl.legend() UnivariateSpline interp1dä¸èƒ½å¤–æ¨è¿ç®—ï¼ˆå¤–æ’å€¼ï¼‰UnivariateSplineå¯ä»¥å¤–æ’å€¼ class scipy.interpolate.UnivariateSpline(x, y, w=None, bbox=[None, None], k=3, s=None ) x,yæ˜¯X-Yåæ ‡æ•°ç»„ wæ˜¯æ¯ä¸ªæ•°æ®ç‚¹çš„æƒé‡å€¼ kä¸ºæ ·æ¡æ›²çº¿çš„é˜¶æ•° sä¸ºå¹³æ»‘å‚æ•°ã€‚ s=0ï¼Œæ ·æ¡æ›²çº¿å¼ºåˆ¶é€šè¿‡æ‰€æœ‰æ•°æ®ç‚¹ s>0,æ»¡è¶³ âˆ‘(w(yâˆ’spline(x)))2â‰¤s \\sum(w(y-spline(x)))^2 \\leq sâˆ‘(w(yâˆ’spline(x)))â€‹2â€‹â€‹â‰¤s s=0å¼ºåˆ¶é€šè¿‡æ‰€æœ‰æ•°æ®ç‚¹çš„å¤–æ’å€¼ from scipy import interpolate import numpy as np x1=np.linspace(0,10,20) y1=np.sin(x1) sx1=np.linspace(0,12,100) func1=interpolate.UnivariateSpline(x1,y1,s=0)#å¼ºåˆ¶é€šè¿‡æ‰€æœ‰ç‚¹ sy1=func1(sx1) import matplotlib.pyplot as plt plt.plot(x1,y1,'o') plt.plot(sx1,sy1) plt.show() ä¹Ÿå°±æ’å€¼åˆ°(0,12)ï¼ŒèŒƒå›´å†å¤§å°±ä¸è¡Œäº†ï¼Œæ¯•ç«Ÿæ’å€¼çš„ä¸“é•¿ä¸åœ¨äºé¢„æµ‹ s>0ï¼šä¸å¼ºåˆ¶é€šè¿‡æ‰€æœ‰ç‚¹ import numpy as np from scipy import interpolate x2=np.linspace(0,20,200) y2=np.sin(x2)+np.random.normal(loc=0,scale=1,size=len(x2))*0.2 sx2=np.linspace(0,22,2000) func2=interpolate.UnivariateSpline(x2,y2,s=8) sy2=func2(sx2) import matplotlib.pyplot as plt plt.plot(x2,y2,'.') plt.plot(sx2,sy2) plt.show() __call__(x[, nu]) Evaluate spline (or its nu-th derivative) at positions x. antiderivative([n]) Construct a new spline representing the antiderivative of this spline. derivative([n]) Construct a new spline representing the derivative of this spline. derivatives(x) è¿”å›ç‚¹ x å¤„æ ·æ¡æ›²çº¿çš„å¯¼æ•°ã€‚ get_coeffs() è¿”å›æ ·æ¡ç³»æ•°ã€‚ get_knots() Return positions of (boundary and interior) knots of the spline. get_residual() Return weighted sum of squared residuals of the spline approximation: sum((w[i] * (y[i]-s(x[i])))**2, axis=0). integral(a, b) è¿”å›ä¸¤ä¸ªç»™å®šç‚¹ä¹‹é—´æ ·æ¡æ›²çº¿çš„å®šç§¯åˆ†ã€‚. roots() è¿”å›æ ·æ¡æ›²çº¿çš„é›¶ç‚¹. set_smoothing_factor(s) Continue spline computation with the given smoothing factor s and with the knots found at the last call. print(np.array_str(func2.roots(), precision=3)) # [ 0.046 3.152 6.299 9.349 12.67 15.793 18.813] å‚æ•°æ’å€¼ ä½¿ç”¨å‚æ•°æ’å€¼è¿æ¥äºŒç»´å¹³é¢ä¸Šçš„ç‚¹ x = [ 4.913, 4.913, 4.918, 4.938, 4.955, 4.949, 4.911, 4.848, 4.864, 4.893, 4.935, 4.981, 5.01, 5.021 ] y = [ 5.2785, 5.2875, 5.291, 5.289, 5.28, 5.26, 5.245, 5.245, 5.2615, 5.278, 5.2775, 5.261, 5.245, 5.241 ] pl.plot(x, y, \"o\") for s in (0, 1e-4): tck, t = interpolate.splprep([x, y], s=s) #â¶ xi, yi = interpolate.splev(np.linspace(t[0], t[-1], 200), tck) #â· pl.plot(xi, yi, lw=2, label=u\"s=%g\" % s) pl.legend() scipy.interpolateåŒ…é‡Œæä¾›äº†ä¸¤ä¸ªå‡½æ•°splevå’Œsplrepå…±åŒå®Œæˆ(B-æ ·æ¡:è´å…¹æ›²çº¿(åˆç§°è´å¡å°”æ›²çº¿))æ’å€¼ï¼Œå’Œä¹‹å‰ä¸€å…ƒæ’å€¼ä¸€æ­¥å°±èƒ½å®Œæˆä¸åŒï¼Œæ ·æ¡æ’å€¼éœ€è¦ä¸¤æ­¥å®Œæˆï¼Œç¬¬ä¸€æ­¥å…ˆç”¨splrepè®¡ç®—å‡ºbæ ·æ¡æ›²çº¿çš„å‚æ•°tckï¼Œç¬¬äºŒæ­¥åœ¨ç¬¬ä¸€æ­¥çš„åŸºç¡€ä¸Šç”¨splevè®¡ç®—å‡ºå„å–æ ·ç‚¹çš„æ’å€¼ç»“æœã€‚ ä¸€å…ƒå‡½æ•°çš„ Rbf æ’å€¼ lass scipy.interpolate.Rbf(*args) å‚æ•°ï¼š *argsï¼šarrays x, y, z, â€¦, d, where x, y, z, â€¦ are the coordinates of the nodes and d is the array of values at the nodes functionï¼šstr or callable, optional åŸºäºåŠå¾„rçš„å¾„å‘åŸºå‡½æ•°ï¼Œé»˜è®¤å€¼ä¸ºæ¬§å‡ é‡Œå¾—è·ç¦»ï¼› é»˜è®¤å€¼ä¸ºâ€œ multiquadricâ€ 'multiquadric': sqrt((r/self.epsilon)**2 + 1) 'inverse': 1.0/sqrt((r/self.epsilon)**2 + 1) 'gaussian': exp(-(r/self.epsilon)**2) 'linear': r 'cubic': r**3 'quintic': r**5 'thin_plate': r**2 * log(r) ä¸€ç»´RBFæ’å€¼ from scipy.interpolate import Rbf x1 = np.array([-1, 0, 2.0, 1.0]) y1 = np.array([1.0, 0.3, -0.5, 0.8]) funcs = ['multiquadric', 'gaussian', 'linear'] nx = np.linspace(-3, 4, 100) rbfs = [Rbf(x1, y1, function=fname) for fname in funcs] #â¶ rbf_ys = [rbf(nx) for rbf in rbfs] #â· pl.plot(x1, y1, \"o\") for fname, ny in zip(funcs, rbf_ys): pl.plot(nx, ny, label=fname, lw=2) pl.ylim(-1.0, 1.5) pl.legend() for fname, rbf in zip(funcs, rbfs): print (fname, rbf.nodes) # multiquadric [-0.88822885 2.17654513 1.42877511 -2.67919021] # gaussian [ 1.00321945 -0.02345964 -0.65441716 0.91375159] # linear [-0.26666667 0.6 0.73333333 -0.9 ] å¤šç»´æ’å€¼ interp2d` class scipy.interpolate.interp2d(x, y, z, kind='linear', copy=True, bounds_error=False, fill_value=None ) å‚æ•°ï¼š x, y, z : array_like If the points lie on a regular grid, x can specify the column coordinates and y the row coordinates, for example: >>> x = [0,1,2]; y = [0,3]; z = [[1,2,3], [4,5,6]] If x and y are multi-dimensional, they are flattened before use. kindï¼š {â€˜linearâ€™, â€˜cubicâ€™, â€˜quinticâ€™}, optional # ç”Ÿæˆæ•°æ® import numpy as np def func(x,y): return (x+y)*np.exp(-5*(x**2+y**2)) x,y=np.mgrid[-1:1:8j,-1:1:8j] z=func(x,y) # æ’å€¼ from scipy import interpolate func=interpolate.interp2d(x,y,z,kind='cubic') xnew=np.linspace(-1,1,100) ynew=np.linspace(-1,1,100) znew=func(xnew,ynew)#xnew, ynewæ˜¯ä¸€ç»´çš„ï¼Œè¾“å‡ºznewæ˜¯äºŒç»´çš„ xnew,ynew=np.mgrid[-1:1:100j,-1:1:100j]#ç»Ÿä¸€å˜æˆäºŒç»´ï¼Œä¾¿äºä¸‹ä¸€æ­¥ç”»å›¾ # ç”»å›¾ import mpl_toolkits.mplot3d import matplotlib.pyplot as plt ax=plt.subplot(111,projection='3d') ax.plot_surface(xnew,ynew,znew) ax.scatter(x,y,z,c='r',marker='^') plt.show() äºŒç»´æ’å€¼ Rbf äºŒç»´å¾„å‘åŸºå‡½æ•°æ’å€¼ # éšæœºç”Ÿæˆç‚¹ï¼Œå¹¶è®¡ç®—å‡½æ•°å€¼ import numpy as np def func(x,y): return (x+y)*np.exp(-5*(x**2+y**2)) x=np.random.uniform(low=-1,high=1,size=100) y=np.random.uniform(low=-1,high=1,size=100) z=func(x,y) # æ’å€¼ from scipy import interpolate func=interpolate.Rbf(x,y,z,function='multiquadric') xnew,ynew=np.mgrid[-1:1:100j,-1:1:100j] znew=func(xnew,ynew)#è¾“å…¥è¾“å‡ºéƒ½æ˜¯äºŒç»´ # ç”»å›¾ import mpl_toolkits.mplot3d import matplotlib.pyplot as plt ax=plt.subplot(111,projection='3d') ax.plot_surface(xnew,ynew,znew) ax.scatter(x,y,z,c='r',marker='^') plt.show() å‚è€ƒ scipy.interpolate Scipy Tutorial-ä¸€å…ƒæ ·æ¡æ’å€¼ scipy.interpolate.Rbf Update timeï¼š 2020-05-25 "},"Chapter3/ç‰›é¡¿æ’å€¼.html":{"url":"Chapter3/ç‰›é¡¿æ’å€¼.html","title":"ç‰›é¡¿æ’å€¼","keywords":"","body":"ç‰›é¡¿æ’å€¼ import matplotlib.pyplot as plt import numpy as np import pylab as mpl mpl.rcParams['font.sans-serif'] = ['SimHei'] mpl.rcParams['axes.unicode_minus'] = False x = [0.4, 0.55, 0.65, 0.80, 0.90, 1.05] y = [0.41075, 0.57815, 0.69675, 0.88811, 1.02652, 1.25382] '''è®¡ç®—äº”æ¬¡å·®å•†çš„å€¼''' def five_order_difference_quotient(x, y): # i è®°å½•è®¡ç®—å·®å•†çš„æ¬¡æ•°ï¼Œè¿™é‡Œè®¡ç®—äº”æ¬¡å·®å•† i = 0 quotient = np.zeros(6) while i i: if i == 0: quotient[j] = (y[j] - y[j - 1]) / (x[j] - x[j - 1]) else: quotient[j] = (quotient[j] - quotient[j - 1]) / (x[j] - x[j - 1 - i]) j -= 1 i += 1 # è¿”å›å·®å•†å€¼ return quotient def function(data): return x[0] + parameters[1] * (data - 0.4) + parameters[2] * (data - 0.4) * (data - 0.55) + \\ parameters[3] * (data - 0.4) * (data - 0.55) * (data - 0.65) \\ + parameters[4] * (data - 0.4) * (data - 0.55) * (data - 0.80) \"\"\"è®¡ç®—æ’å€¼å¤šé¡¹å¼çš„å€¼å’Œç›¸åº”çš„è¯¯å·®\"\"\" def calculate_data(x, parameters): return_data = [] for data in x: return_data.append(function(data)) return return_data def draw(newData): plt.scatter(x, y, label=\"ç¦»æ•£æ•°æ®\", color=\"red\") plt.plot(x, newData, label=\"ç‰›é¡¿æ’å€¼æ‹Ÿåˆæ›²çº¿\", color=\"black\") plt.scatter(0.596, function(0.596), label=\"é¢„æµ‹å‡½æ•°ç‚¹\", color=\"blue\") plt.title(\"ç‰›é¡¿æ’å€¼æ³•\") plt.legend(loc=\"upper left\") plt.show() parameters = five_order_difference_quotient(x, y) yuanzu = calculate_data(x, parameters) draw(yuanzu) Update timeï¼š 2020-05-25 "}}